<div class="alain-default__content-title">
  <h1>
    Lodop打印
    <small>
      更多體驗請至
      <a href="https://ng-alain.com/components/lodop" target="_blank">NG-ALAIN.com</a>
    </small>
  </h1>
</div>
<nz-card>
  @if (error) {
    <nz-alert [nzType]="'warning'" [nzMessage]="message">
      <ng-template #message>
        請先下載
        <a href="http://c-lodop.com/download.html" target="_blank">Lodop插件</a>。
      </ng-template>
    </nz-alert>
  }
  @if (!error) {
    <form nz-form>
      <nz-form-item nz-row>
        <nz-form-label nz-col [nzSm]="6">打印服務器</nz-form-label>
        <nz-form-control nz-col [nzSm]="18">
          <nz-input-group>
            <div nz-col [nzSpan]="16">
              <input nz-input nzPlaceHolder="https://localhost:8443/CLodopfuncs.js" [(ngModel)]="cog.url" name="url" />
            </div>
            <div nz-col [nzSpan]="8">
              <button nz-button (click)="reload(null)">重新加載打印機</button>
            </div>
          </nz-input-group>
        </nz-form-control>
      </nz-form-item>
      <nz-form-item nz-row>
        <nz-form-label nz-col [nzSm]="6">打印機</nz-form-label>
        <nz-form-control nz-col [nzSm]="18">
          <nz-select
            style="width: 90%"
            nzPlaceHolder="請選擇打印機"
            nzShowSearch
            nzAllowClear
            [(ngModel)]="cog.printer"
            name="printer"
            (ngModelChange)="changePinter($event)"
          >
            @for (name of pinters; track $index) {
              <nz-option [nzLabel]="name" [nzValue]="name" />
            }
          </nz-select>
        </nz-form-control>
      </nz-form-item>
      <nz-form-item nz-row>
        <nz-form-label nz-col [nzSm]="6">紙張類型</nz-form-label>
        <nz-form-control nz-col [nzSm]="18">
          <nz-select style="width: 90%" nzPlaceHolder="請選擇紙張類型" nzShowSearch nzAllowClear [(ngModel)]="cog.paper" name="paper">
            @for (name of papers; track $index) {
              <nz-option [nzLabel]="name" [nzValue]="name" />
            }
          </nz-select>
        </nz-form-control>
      </nz-form-item>
      <nz-form-item nz-row>
        <nz-form-label nz-col [nzSm]="6">打印內容</nz-form-label>
        <nz-form-control nz-col [nzSm]="18">
          <textarea nz-input [(ngModel)]="cog.html" name="html" nzAutosize></textarea>
          <div nz-form-extra>僅限HTML，更多類型支持請參考官網</div>
        </nz-form-control>
      </nz-form-item>
      <nz-form-item nz-row>
        <nz-form-control nz-col [nzSm]="18" [nzOffset]="6">
          <button nz-button (click)="print(true)" [nzLoading]="printing">打印預覽</button>
          <button nz-button (click)="print()" [nzLoading]="printing">直接打印</button>
        </nz-form-control>
      </nz-form-item>
    </form>
  }
</nz-card>
