---
description: Angular Standalone Component 模板
globs: ["src/app/**/*.component.ts"]
alwaysApply: false
---

# Angular Standalone Component 模板

## 組件結構

```typescript
import { Component, signal, computed, inject, input, output, viewChild, resource, ChangeDetectionStrategy } from '@angular/core';
import { SHARED_IMPORTS } from '@shared/shared-imports';

@Component({
  selector: 'app-example',
  standalone: true,
  imports: [SHARED_IMPORTS],
  templateUrl: './example.component.html',
  styleUrls: ['./example.component.scss'],
  changeDetection: ChangeDetectionStrategy.OnPush
})
export class ExampleComponent {
  // 使用 inject() 進行依賴注入
  private readonly service = inject(ExampleService);
  
  // 使用 input() 替代 @Input()
  readonly title = input<string>('Default Title');
  readonly count = input.required<number>();
  
  // 使用 output() 替代 @Output()
  readonly itemClick = output<Item>();
  
  // 使用 viewChild() 替代 @ViewChild()
  readonly headerElement = viewChild<ElementRef>('header');
  
  // 使用 signal() 創建響應式狀態
  private readonly state = signal<StateType>(initialValue);
  
  // 使用 computed() 創建派生狀態
  readonly derivedState = computed(() => {
    return this.state().someProperty;
  });

  // 使用 resource() 取得 async 資料（會自動追蹤 userId Signal）
  readonly userId = signal('current-user-id');
  readonly userResource = resource({
    params: () => ({ id: this.userId() }),
    loader: ({ params }) => this.service.fetchProfile(params.id)
  });

  readonly profile = computed(() => this.userResource.value());

  refreshProfile(): void {
    this.userResource.reload();
  }
}
```

## 模板結構

```html
@if (condition()) {
  <div>Content</div>
}

@for (item of items(); track item.id) {
  <div>{{ item.name }}</div>
} @empty {
  <div>No items found</div>
}

@switch (status()) {
  @case ('active') {
    <span>Active</span>
  }
  @default {
    <span>Inactive</span>
  }
}

<!-- 在模板中調用 Signal 時必須使用括號 -->
<div>{{ mySignal() }}</div>

@defer (on viewport) {
  <article-comments [userId]="userId()" />
} @placeholder (minimum 1s) {
  <p aria-live="polite">Loading comments soon…</p>
} @loading (minimum 1s; after 500ms) {
  <p aria-busy="true">Fetching comments…</p>
} @error {
  <p role="alert">Unable to load comments</p>
}
```

## 注意事項

- 必須使用 `SHARED_IMPORTS`
- 必須使用 `OnPush` 變更檢測策略
- 優先使用 Signal Inputs (`input()`) 而非 `@Input()` 裝飾器
- 優先使用 Signal Outputs (`output()`) 而非 `@Output()` 裝飾器
- 優先使用 Signal Queries (`viewChild()`, `contentChild()`) 而非裝飾器
- 使用現代控制流程語法（@if、@for、@switch、@empty）
- 在模板中調用 Signal 時必須使用括號：`{{ mySignal() }}`
- 使用 `@defer` + `@placeholder/@loading/@error` 組合延後非關鍵內容並維持 UX，善用 `minimum`、`after`
- 若 Router 啟用 View Transitions，CSS 動畫需支援 `prefers-reduced-motion` 並視情況使用 `skipTransition()`
- 使用 `readonly` 修飾符保護不可變屬性
