---
description: 錯誤處理與狀態管理規範
globs: ["src/app/**/*.ts"]
alwaysApply: false
---

# 錯誤處理規範

> **相關規則**：參考 [Core 模組規範](./core-specific.mdc)、[API 設計](./api-design.mdc)、[安全規範](./security.mdc)

## 錯誤處理原則

- 使用 `ErrorStateService` 統一管理錯誤狀態
- HTTP 錯誤透過 `defaultInterceptor` 自動處理（參考 [Core 模組規範](./core-specific.mdc)）
- 業務錯誤需明確分類（HTTP、網路、驗證、業務、權限）
- 提供可重試機制與錯誤歷史記錄

## 錯誤分類

- **HTTP 錯誤**：網路請求失敗、伺服器錯誤
- **網路錯誤**：連線超時、網路中斷
- **驗證錯誤**：表單驗證失敗、輸入格式錯誤
- **業務錯誤**：業務邏輯驗證失敗
- **權限錯誤**：無權限訪問資源（參考 [安全規範](./security.mdc)）

## 錯誤處理流程

1. **捕獲錯誤**：在服務層或組件中捕獲錯誤
2. **分類錯誤**：根據錯誤類型進行分類
3. **統一處理**：通過 `ErrorStateService` 統一處理
4. **用戶提示**：提供友好的錯誤提示信息
5. **錯誤記錄**：記錄錯誤歷史以便調試

## 參考文檔

- [錯誤處理指南](../../docs/37-錯誤處理指南.md)
- [Core 模組規範](./core-specific.mdc)
