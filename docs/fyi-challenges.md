# 問題與挑戰記錄 (FYI - Challenges)

> 參考：[@fyi.md](./fyi.md)

記錄專案在開發過程中遇到的問題、挑戰及其解決方案。

---

## 📋 記錄格式

每個問題/挑戰應包含：
- **日期**：問題發現或解決的日期
- **問題描述**：問題的詳細描述
- **影響範圍**：問題影響的模組或功能
- **解決方案**：採用的解決方法
- **經驗教訓**：從中學到的經驗或最佳實踐

---

## 🐛 問題與挑戰

> 2025-11-14 前的案例已移至 `docs/Archive/fyi-challenges.md`，以下區塊專門留給最新問題。

### 2025-01-15: 組織管理頁面無限加載問題

**日期**：2025-01-15

**問題描述**：
- 訪問組織詳情頁面時，頁面一直顯示加載狀態（spinner），無法顯示內容
- 頁面標題顯示「账户详情」，但內容區域一直轉圈
- 控制台無明顯錯誤信息

**影響範圍**：
- 組織詳情頁面完全無法使用
- 用戶無法查看組織信息和成員管理
- 阻塞組織管理核心功能

**根本原因**：
- `OrganizationRoleManageComponent.ngOnInit()` 中調用了 `await this.accountService.loadAccounts()`
- 這會設置 `AccountService.loading` 為 `true`
- 由於 `AccountService` 是單例服務，`loading` 狀態是全局共享的
- `account-detail.component.ts` 的模板條件判斷 `@if (accountService.loading())` 一直為 `true`
- 導致頁面一直顯示加載狀態，即使 `loadAccountById` 已經完成

**解決方案**：
1. **優先級調整**：先加載組織成員（主要功能），再考慮加載賬戶列表（輔助功能）
2. **條件加載**：只在賬戶列表為空時才加載，避免重複加載
3. **非阻塞加載**：使用 `.catch()` 而不是 `await`，不阻塞頁面渲染
4. **錯誤處理**：保留錯誤處理，但不影響主流程

**經驗教訓**：
- **單例服務的狀態是全局的**：多個組件共享同一個服務實例時，狀態會互相影響
- **避免在子組件中修改父組件依賴的狀態**：子組件不應該影響父組件的顯示邏輯
- **優先加載主要功能**：先加載用戶最需要的內容，輔助功能可以異步加載
- **代碼審查要點**：檢查單例服務的使用，確保多個組件使用同一個服務時不會互相干擾

**相關文檔**：
- [工作總結-組織管理頁面無限加載問題修復-2025-01-15.md](./工作總結-組織管理頁面無限加載問題修復-2025-01-15.md) ⭐ 詳細記錄

---

### 2025-01-15: 模型結構命名不一致問題

**日期**：2025-01-15

**問題描述**：
- `src/app/shared/models` 目錄中存在文件命名不一致問題
- 模組化目錄使用 `types.ts` 命名，但存在兩個遺留文件使用 `.model.ts` 後綴
- 遺留文件內容已遷移到模組目錄，但文件未刪除

**影響範圍**：
- 代碼可維護性
- 新開發者可能不知道應該使用哪個文件
- 潛在的類型衝突風險

**解決方案**：
1. 確認遺留文件未被使用（通過 grep 搜索確認）
2. 刪除遺留文件：`activity-log.model.ts` 和 `quality-check.model.ts`
3. 更新 `index.ts` 註釋，說明遷移已完成
4. 創建詳細分析報告文檔

**經驗教訓**：
- 文件遷移後應及時清理遺留文件
- 統一命名規範有助於代碼可維護性
- 定期檢查和清理代碼庫可以避免技術債務累積

**相關文檔**：
- [模型結構分析報告](./模型结构分析报告.md)
- [模型結構清理總結](./模型结构清理总结-2025-01-15.md)

---

**最後更新**：2025-01-15  
**維護者**：開發團隊

