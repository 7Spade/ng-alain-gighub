# 專案路線圖 (Project Roadmap)

> **最後更新**：2025-01-15  
> **版本**：v2.0  
> **狀態**：正式版

---

## 📋 路線圖概述

本文檔記錄專案的完整開發路線圖，包含從項目開始到完成的詳細開發計劃。路線圖基於 **51 張資料表** 和 **11 個業務模組**，提供清晰的開發順序、任務分解、時間估算和依賴關係。

**核心架構**：
- **51 張資料表**：分為 11 個業務模組（參考 [資料表清單總覽](./30-資料表清單總覽.md)）
- **Git-like 分支模型**：主分支、組織分支、PR 機制（參考 [完整架構流程圖](./27-完整架構流程圖.mermaid.md)）
- **分層架構**：`routes` → `shared` → `core` 依賴方向

**相關文檔**：
- [PRD 文檔](./PRD.md) - 產品需求文檔
- [架構審查報告](./28-架構審查報告.md) - 架構設計說明
- [歷史紀錄](./fyi-history.md) - 開發歷史與里程碑
- [開發脈絡](./fyi-development.md) - 開發決策記錄
- [資料表清單總覽](./30-資料表清單總覽.md) - 51 張資料表分類

---

## 🎯 當前狀態（2025-01-15）

### ✅ 已完成

#### 核心架構
- ✅ Git-like 分支模型架構設計
- ✅ 51 張資料表結構定義
- ✅ 文檔體系建立

#### 基礎設施
- ✅ 基礎設施模組（core/infra/）
  - TypeScript 類型定義生成（51 張表）
  - 統一錯誤處理機制
  - 數據轉換工具（snake_case ↔ camelCase）
  - 基礎 Repository 類（BaseRepository）
  - BlueprintRepository 示例

#### 權限系統
- ✅ RBAC 權限控制系統
- ✅ @delon/acl 和 Supabase 整合
- ✅ Git-like 分支權限控制
- ✅ 基礎 RLS 策略實施（51 張表）

#### 認證系統
- ✅ Supabase Auth 與 @delon/auth 整合
- ✅ 零破壞性適配器模式
- ✅ Session 同步機制

### ⏳ 進行中

- ⏳ 賬戶系統開發規劃（10 個任務，預計 2-3 周）

---

## 🗺️ 模組開發順序與依賴關係

基於 51 張資料表和 11 個業務模組，開發順序遵循依賴關係：

```
開發順序（依賴關係）：
1. 🔐 帳戶與身份系統（4 張表）← 基礎層
   ↓
2. 🔒 權限系統（5 張表）← 已完成 ✅
   ↓
3. 🤝 組織協作系統（3 張表）← 依賴帳戶系統
   ↓
4. 🎯 藍圖/專案系統（5 張表）← 核心業務，依賴帳戶和權限
   ↓
5. 📋 任務執行系統（9 張表）← 核心業務，依賴藍圖
   ↓
6. ✅ 品質驗收系統（4 張表）← 依賴任務系統
7. ⚠️ 問題追蹤系統（4 張表）← 依賴任務系統
   ↓
8. 💬 協作溝通系統（6 張表）← 依賴多個系統
9. 📊 資料分析系統（6 張表）← 依賴多個系統
   ↓
10. 🤖 機器人系統（3 張表）← 依賴多個系統
11. ⚙️ 系統管理（2 張表）← 基礎功能
```

---

## 🚀 Phase 1：MVP（3個月）

> **目標**：完成核心功能，交付可運行的 Beta 版本  
> **範圍**：帳戶系統、組織協作、藍圖系統、任務執行、品質驗收、問題追蹤、基礎協作溝通

### Month 1：核心基礎建設（2025-01 ~ 2025-02）

#### ✅ 已完成
- ✅ 帳戶系統與身份認證（Supabase Auth 整合）
- ✅ 權限系統（RBAC + @delon/acl）
- ✅ 基礎設施模組（Repository 模式、類型定義、錯誤處理）

#### ✅ 已完成

##### 🎯 模組 3：藍圖/專案系統（5 張表）
**狀態**：✅ 已完成（2025-11-14）  
**完成度**：100%（核心功能完成，測試待實施）  
**詳細記錄**：→ [工作總結-藍圖系統完整實施-2025-11-14.md](./工作總結-藍圖系統完整實施-2025-11-14.md)

#### 🔄 進行中

##### 🔐 模組 1：帳戶與身份系統（4 張表）
**狀態**：進行中（12 個任務，預計 2-3 周）  
**依賴**：無（基礎層）  
**評估日期**：2025-01-15（使用 Sequential Thinking + Software Planning Tool）

**當前進度**：約 85% 完成（核心功能已實現）

**任務清單**：
- [x] **評估當前實現狀態**（2025-01-15 完成）
  - [x] 檢查 Repository、Service、組件完整性
  - [x] 驗證架構合規性
  - [x] 識別缺失功能
- [x] **數據模型層**（shared/models/account/types.ts）
  - [x] Account 類型定義（User/Bot/Organization）
  - [x] Team 類型定義
  - [x] TeamMember 類型定義
  - [x] OrganizationSchedule 類型定義
  - [x] 狀態枚舉定義（在 core 層）
- [x] **Repository 層**（core/infra/repositories/）
  - [x] AccountRepository（繼承 BaseRepository，118行）
  - [x] TeamRepository（73行）
  - [x] TeamMemberRepository（107行）
  - [x] OrganizationScheduleRepository（146行）
- [x] **服務層**（shared/services/account/）
  - [x] AccountService（CRUD、查詢、狀態管理，254行）
  - [x] TeamService（團隊管理、成員管理，294行）
  - [x] OrganizationScheduleService（排班管理，已完成）✅
- [x] **路由層**（routes/accounts/）
  - [x] 賬戶列表頁面（AccountListComponent，134行）
  - [x] 賬戶詳情頁面（AccountDetailComponent，已完成）✅
  - [x] 賬戶創建/編輯頁面（AccountFormComponent，已完成）✅
  - [x] 團隊管理頁面（TeamListComponent, TeamDetailComponent，已完成）✅
  - [x] 排班管理頁面（ScheduleListComponent，已完成）✅
  - [x] 路由配置完善（所有路由已配置）✅
- [ ] **RLS 權限驗證**
  - [ ] accounts 表 RLS 策略驗證和完善
  - [ ] teams 表 RLS 策略驗證和完善
  - [ ] team_members 表 RLS 策略驗證和完善
  - [ ] organization_schedules 表 RLS 策略驗證和完善
- [ ] **測試與文檔**
  - [ ] 單元測試（目標 80% 覆蓋率）**← 待創建**
  - [ ] 集成測試
  - [ ] API 文檔更新
  - [ ] 用戶指南更新

**完成度摘要**：
- ✅ Repository 層：100% 完成
- ✅ 類型定義：100% 完成，架構合規
- ✅ Service 層：100% 完成（3/3）
- ✅ 路由和組件：100% 完成（6/6 核心組件）
- ⚠️ 測試：0% 完成（待後續實施）
- ✅ 架構合規性：100% 合規
- ✅ 構建驗證：通過（`yarn build` 成功）

**實施日期**：2025-01-15  
**實施方法**：Sequential Thinking + Software Planning Tool  
**詳細記錄**：→ [账户系统MVP实施完成总结.md](./账户系统MVP实施完成总结.md) ⭐ 新增

**預計時間**：2-3 周  
**里程碑**：里程碑 5 - 賬戶系統 MVP（2025-02-15）

#### 📋 待開始

##### 🤝 模組 2：組織協作系統（3 張表）
**狀態**：進行中（約 90% 完成）  
**依賴**：帳戶系統（模組 1）

**任務清單**：
- [x] **數據模型層**（shared/models/collaboration/）
  - [x] OrganizationCollaboration 類型定義
  - [x] CollaborationInvitation 類型定義
  - [x] CollaborationMember 類型定義
- [x] **Repository 層**（core/infra/repositories/）
  - [x] OrganizationCollaborationRepository
  - [x] CollaborationInvitationRepository
  - [x] CollaborationMemberRepository
- [x] **服務層**（shared/services/collaboration/）
  - [x] CollaborationService（協作關係管理）
  - [x] InvitationService（邀請管理）
- [x] **路由層**（routes/collaboration/）
  - [x] 協作關係列表頁面
  - [x] 協作邀請頁面
  - [x] 協作成員管理頁面
- [x] **RLS 權限驗證**（2025-01-15 完成）✅
  - [x] organization_collaborations 表 RLS 策略（4 個策略）
  - [x] collaboration_invitations 表 RLS 策略（4 個策略）
  - [x] collaboration_members 表 RLS 策略（4 個策略）
- [ ] **測試與文檔**

**預計時間**：1-2 周  
**里程碑**：里程碑 5.5 - 組織協作系統 MVP（2025-02-28）

##### 🎯 模組 3：藍圖/專案系統（5 張表）
**狀態**：✅ 已完成（2025-11-14）  
**依賴**：帳戶系統（模組 1）、權限系統、組織協作系統（模組 2）

**任務清單**：
- [x] **數據模型層**（shared/models/blueprint/）✅ 2025-11-14
  - [x] Blueprint 類型定義
  - [x] BlueprintConfig 類型定義
  - [x] BlueprintBranch 類型定義
  - [x] BranchFork 類型定義
  - [x] PullRequest 類型定義
  - [x] 4 個枚舉定義（BlueprintStatus、BranchType、BranchStatus、PRStatus）
- [x] **Repository 層**（core/infra/repositories/）✅ 2025-11-14
  - [x] BlueprintRepository（已更新，使用枚舉）
  - [x] BlueprintConfigRepository
  - [x] BlueprintBranchRepository
  - [x] BranchForkRepository
  - [x] PullRequestRepository
  - [x] 共 20+ 個查詢方法
- [x] **服務層**（shared/services/blueprint/）✅ 2025-11-14
  - [x] BlueprintService（藍圖 CRUD、主分支管理、配置管理）
  - [x] BranchService（分支管理、Fork 機制、同步主分支）
  - [x] PullRequestService（PR 創建、審核、合併）
  - [x] 使用 Signals 管理狀態
- [x] **路由層**（routes/blueprints/）✅ 2025-11-14
  - [x] 藍圖列表頁面（BlueprintListComponent）
  - [x] 藍圖詳情頁面（BlueprintDetailComponent）
  - [x] 藍圖編輯頁面（BlueprintFormComponent）
  - [x] 分支管理頁面（BranchManagementComponent）
  - [x] Pull Request 列表頁面（PullRequestListComponent）
  - [x] 路由配置完成
- [x] **Git-like 分支邏輯**✅ 2025-11-14
  - [x] Fork 機制實現（BranchService.forkBranch）
  - [x] PR 審核流程（PullRequestService.reviewPullRequest）
  - [x] 合併邏輯（PullRequestService.mergePullRequest）
  - [x] 分支權限控制（RLS 策略）
- [x] **RLS 權限驗證**✅ 2025-11-14
  - [x] 5 張表 × 4 個操作 = 20 個 RLS 策略
  - [x] 符合 Git-like 分支模型權限要求
- [ ] **測試與文檔**
  - [ ] 單元測試（目標 80% 覆蓋率）
  - [ ] 集成測試
  - [ ] API 文檔更新

**完成度摘要**：
- ✅ 數據模型層：100% 完成
- ✅ Repository 層：100% 完成
- ✅ Service 層：100% 完成
- ✅ UI 層：100% 完成（基礎功能）
- ✅ RLS 權限驗證：100% 完成
- ⚠️ 測試：0% 完成（待後續實施）

**實施日期**：2025-11-14  
**實施方法**：Sequential Thinking + Software Planning Tool + Supabase MCP  
**詳細記錄**：→ [工作總結-藍圖系統完整實施-2025-11-14.md](./工作總結-藍圖系統完整實施-2025-11-14.md) ⭐ 新增

**實際時間**：1 天（提前完成）  
**里程碑**：✅ 里程碑 6 - 藍圖系統 MVP（2025-11-14 完成）

### Month 2：任務執行與協作（2025-02 ~ 2025-03）

##### 📋 模組 4：任務執行系統（9 張表）
**狀態**：待開始  
**依賴**：藍圖系統（模組 3）

**任務清單**：
- [ ] **數據模型層**（shared/models/task/）
  - [ ] Task 類型定義（樹狀結構）
  - [ ] TaskAssignment 類型定義
  - [ ] TaskList 類型定義
  - [ ] TaskStaging 類型定義（48h 暫存）
  - [ ] DailyReport 類型定義
  - [ ] ReportPhoto 類型定義
  - [ ] WeatherCache 類型定義
  - [ ] TaskDependency 類型定義
  - [ ] TaskTemplate 類型定義
- [ ] **Repository 層**（core/infra/repositories/）
  - [ ] TaskRepository（樹狀結構查詢）
  - [ ] TaskAssignmentRepository
  - [ ] TaskListRepository
  - [ ] TaskStagingRepository
  - [ ] DailyReportRepository
  - [ ] ReportPhotoRepository
  - [ ] WeatherCacheRepository
  - [ ] TaskDependencyRepository
  - [ ] TaskTemplateRepository
- [ ] **服務層**（shared/services/task/）
  - [ ] TaskService（任務 CRUD、樹狀結構管理）
  - [ ] TaskAssignmentService（任務指派：個人/團隊/組織/承攬）
  - [ ] TaskListService（待辦列表管理）
  - [ ] TaskStagingService（暫存區管理、48h 撤回機制）
  - [ ] DailyReportService（施工日誌、自動同步主分支）
- [ ] **路由層**（routes/task/）
  - [ ] 任務樹視圖（僅擁有者可建立/修改）
  - [ ] 任務詳情頁面
  - [ ] 任務指派頁面
  - [ ] 待辦列表頁面
  - [ ] 暫存區頁面（48h 可撤回）
  - [ ] 施工日誌頁面
- [ ] **核心功能實現**
  - [ ] 任務樹狀結構（無限層級）
  - [ ] 暫存區機制（48h 可撤回）
  - [ ] 自動同步主分支（施工日誌）
  - [ ] 任務指派邏輯（個人/團隊/組織/承攬）
- [ ] **RLS 權限驗證**
- [ ] **測試與文檔**

**預計時間**：4-5 周  
**里程碑**：里程碑 7 - 任務系統 MVP（2025-03-31）

### Month 3：品質驗收與問題追蹤（2025-03 ~ 2025-04）

##### ✅ 模組 5：品質驗收系統（4 張表）
**狀態**：待開始  
**依賴**：任務執行系統（模組 4）

**任務清單**：
- [ ] **數據模型層**（shared/models/quality/）
  - [ ] QualityCheck 類型定義
  - [ ] QcPhoto 類型定義
  - [ ] Inspection 類型定義
  - [ ] InspectionPhoto 類型定義
- [ ] **Repository 層**（core/infra/repositories/）
  - [ ] QualityCheckRepository
  - [ ] QcPhotoRepository
  - [ ] InspectionRepository
  - [ ] InspectionPhotoRepository
- [ ] **服務層**（shared/services/quality/）
  - [ ] QualityCheckService（品管檢查、照片管理）
  - [ ] InspectionService（驗收管理、責任切割）
- [ ] **路由層**（routes/quality/）
  - [ ] 品管檢查頁面
  - [ ] 驗收頁面
  - [ ] 照片管理頁面
- [ ] **核心功能實現**
  - [ ] 品管流程（檢查 → 記錄 → 改善追蹤）
  - [ ] 驗收流程（驗收 → 責任切割）
  - [ ] 自動同步主分支（品管記錄）
- [ ] **RLS 權限驗證**
- [ ] **測試與文檔**

**預計時間**：2-3 周

##### ⚠️ 模組 6：問題追蹤系統（4 張表）
**狀態**：待開始  
**依賴**：任務執行系統（模組 4）

**任務清單**：
- [ ] **數據模型層**（shared/models/issue/）
  - [ ] Issue 類型定義
  - [ ] IssueAssignment 類型定義
  - [ ] IssuePhoto 類型定義
  - [ ] IssueSyncLog 類型定義
- [ ] **Repository 層**（core/infra/repositories/）
  - [ ] IssueRepository
  - [ ] IssueAssignmentRepository
  - [ ] IssuePhotoRepository
  - [ ] IssueSyncLogRepository
- [ ] **服務層**（shared/services/issue/）
  - [ ] IssueService（問題管理、狀態追蹤）
  - [ ] IssueSyncService（即時同步主分支）
- [ ] **路由層**（routes/issue/）
  - [ ] 問題列表頁面
  - [ ] 問題詳情頁面
  - [ ] 問題指派頁面
- [ ] **核心功能實現**
  - [ ] 問題開立（任何分支）
  - [ ] 即時同步主分支（issue_sync_logs）
  - [ ] 問題狀態追蹤
- [ ] **RLS 權限驗證**
- [ ] **測試與文檔**

**預計時間**：2 周

##### 💬 模組 7：協作溝通系統（基礎功能，6 張表）
**狀態**：待開始  
**依賴**：任務執行系統（模組 4）、品質驗收系統（模組 5）、問題追蹤系統（模組 6）

**任務清單**：
- [ ] **數據模型層**（shared/models/communication/）
  - [ ] Comment 類型定義
  - [ ] Notification 類型定義
  - [ ] NotificationRule 類型定義
  - [ ] NotificationSubscription 類型定義
  - [ ] PersonalTodo 類型定義（五種狀態）
  - [ ] TodoStatusTracking 類型定義
- [ ] **Repository 層**（core/infra/repositories/）
  - [ ] CommentRepository
  - [ ] NotificationRepository
  - [ ] NotificationRuleRepository
  - [ ] NotificationSubscriptionRepository
  - [ ] PersonalTodoRepository
  - [ ] TodoStatusTrackingRepository
- [ ] **服務層**（shared/services/communication/）
  - [ ] CommentService（留言管理）
  - [ ] NotificationService（通知管理、規則引擎）
  - [ ] TodoService（待辦中心、五種狀態分類）
- [ ] **路由層**（routes/communication/）
  - [ ] 留言頁面（任務、問題的討論）
  - [ ] 通知中心頁面
  - [ ] 待辦中心頁面（五種狀態：待執行/暫存中/品管中/驗收中/問題追蹤）
- [ ] **核心功能實現**
  - [ ] 待辦中心（五種狀態分類顯示）
  - [ ] 通知系統（站內通知、Email、推播）
  - [ ] 通知規則引擎
- [ ] **RLS 權限驗證**
- [ ] **測試與文檔**

**預計時間**：3-4 周  
**里程碑**：里程碑 8 - 品質驗收系統 MVP（2025-04-15）

**Phase 1 MVP 交付物**：
- ✅ 可運行的 Beta 版本
- ✅ 核心功能完整（帳戶、組織協作、藍圖、任務、品質、問題、基礎協作溝通）
- ✅ 10 家試用客戶
- ✅ 基礎文檔和用戶指南

**里程碑**：里程碑 9 - Phase 1 MVP 交付（2025-04-30）

---

## 🎨 Phase 2：功能增強（3個月）

> **目標**：增強功能，提升用戶體驗和系統性能  
> **範圍**：資料分析系統、文件管理系統、機器人系統、系統管理、性能優化

### Month 4：資料分析與活動記錄（2025-04 ~ 2025-05）

##### 📊 模組 8：資料分析系統（6 張表）
**狀態**：待開始  
**依賴**：任務執行系統（模組 4）、品質驗收系統（模組 5）、問題追蹤系統（模組 6）

**任務清單**：
- [ ] **數據模型層**（shared/models/analytics/）
  - [ ] ProgressTracking 類型定義
  - [ ] ActivityLog 類型定義
  - [ ] AnalyticsCache 類型定義
- [ ] **Repository 層**（core/infra/repositories/）
  - [ ] ProgressTrackingRepository
  - [ ] ActivityLogRepository
  - [ ] AnalyticsCacheRepository
- [ ] **服務層**（shared/services/analytics/）
  - [ ] ProgressTrackingService（進度追蹤、儀表板數據）
  - [ ] ActivityLogService（活動記錄、審計追蹤）
  - [ ] AnalyticsService（數據分析、報表生成、快取管理）
- [ ] **路由層**（routes/analytics/）
  - [ ] 進度追蹤儀表板（主分支/分支/總覽）
  - [ ] 活動記錄頁面（審計追蹤）
  - [ ] 數據分析報表頁面
- [ ] **核心功能實現**
  - [ ] 進度追蹤儀表板（視覺化數據）
  - [ ] 活動記錄集中記錄（所有分支同步到主分支）
  - [ ] 數據分析快取（預計算報表）
  - [ ] 報表生成（主分支/分支/總覽三層報表）
- [ ] **RLS 權限驗證**
- [ ] **測試與文檔**

**預計時間**：3-4 周  
**里程碑**：里程碑 10 - 資料分析系統 MVP（2025-05-15）

### Month 5：文件管理與機器人系統（2025-05 ~ 2025-06）

##### 📁 模組 9：文件管理系統（3 張表，屬於資料分析系統）
**狀態**：待開始  
**依賴**：資料分析系統（模組 8）

**任務清單**：
- [ ] **數據模型層**（shared/models/document/）
  - [ ] Document 類型定義
  - [ ] DocumentVersion 類型定義
  - [ ] DocumentThumbnail 類型定義
- [ ] **Repository 層**（core/infra/repositories/）
  - [ ] DocumentRepository
  - [ ] DocumentVersionRepository
  - [ ] DocumentThumbnailRepository
- [ ] **服務層**（shared/services/document/）
  - [ ] DocumentService（文件管理、版本控制）
  - [ ] DocumentVersionService（版本管理）
  - [ ] ThumbnailService（縮圖生成）
- [ ] **路由層**（routes/document/）
  - [ ] 文件列表頁面
  - [ ] 文件上傳頁面
  - [ ] 文件版本管理頁面
- [ ] **核心功能實現**
  - [ ] 文件上傳（Supabase Storage）
  - [ ] 版本控制（document_versions）
  - [ ] 縮圖生成（圖片自動生成縮圖）
  - [ ] 軟刪除（30 天後永久刪除）
- [ ] **RLS 權限驗證**
- [ ] **測試與文檔**

**預計時間**：2-3 周

##### 🤖 模組 10：機器人系統（3 張表）
**狀態**：待開始  
**依賴**：資料分析系統（模組 8）、文件管理系統（模組 9）

**任務清單**：
- [ ] **數據模型層**（shared/models/bot/）
  - [ ] Bot 類型定義
  - [ ] BotTask 類型定義
  - [ ] BotExecutionLog 類型定義
- [ ] **Repository 層**（core/infra/repositories/）
  - [ ] BotRepository
  - [ ] BotTaskRepository
  - [ ] BotExecutionLogRepository
- [ ] **服務層**（shared/services/bot/）
  - [ ] BotService（機器人管理）
  - [ ] BotTaskService（任務佇列管理）
  - [ ] BotExecutionService（執行引擎）
- [ ] **路由層**（routes/bot/）
  - [ ] 機器人列表頁面
  - [ ] 機器人配置頁面
  - [ ] 執行日誌頁面
- [ ] **核心功能實現**
  - [ ] 定期報表機器人（自動生成報表）
  - [ ] 通知機器人（自動發送通知）
  - [ ] 備份機器人（定期備份數據）
- [ ] **RLS 權限驗證**
- [ ] **測試與文檔**

**預計時間**：2-3 周  
**里程碑**：里程碑 11 - 文件管理與機器人系統 MVP（2025-06-15）

### Month 6：系統管理與優化（2025-06 ~ 2025-07）

##### ⚙️ 模組 11：系統管理（2 張表）
**狀態**：待開始  
**依賴**：無（基礎功能）

**任務清單**：
- [ ] **數據模型層**（shared/models/system/）
  - [ ] Setting 類型定義
  - [ ] FeatureFlag 類型定義
- [ ] **Repository 層**（core/infra/repositories/）
  - [ ] SettingRepository
  - [ ] FeatureFlagRepository
- [ ] **服務層**（shared/services/system/）
  - [ ] SettingService（系統設定管理）
  - [ ] FeatureFlagService（功能開關、灰度發布、A/B 測試）
- [ ] **路由層**（routes/system/）
  - [ ] 系統設定頁面
  - [ ] 功能開關頁面
- [ ] **核心功能實現**
  - [ ] 系統設定管理
  - [ ] 功能開關（灰度發布、A/B 測試）
- [ ] **RLS 權限驗證**
- [ ] **測試與文檔**

**預計時間**：1-2 周

##### 🚀 性能優化與完善
**狀態**：待開始

**任務清單**：
- [ ] **性能優化**
  - [ ] 數據庫查詢優化（索引、查詢優化）
  - [ ] 前端性能優化（懶加載、虛擬滾動、圖片優化）
  - [ ] API 響應時間優化
  - [ ] 緩存策略優化
- [ ] **RLS 策略完善**
  - [ ] 根據業務需求逐步細化 RLS 策略
  - [ ] 整合角色系統（user_roles 表）
  - [ ] 實現 Git-like 分支權限控制
  - [ ] 參考 `docs/21-安全與-RLS-權限矩陣.md` 建立詳細策略
- [ ] **權限管理 UI**
  - [ ] 角色管理頁面
  - [ ] 權限分配頁面
  - [ ] 分支權限管理頁面
- [ ] **活動記錄整合**
  - [ ] 整合 activity_logs 到所有操作
  - [ ] 活動記錄查詢和篩選
  - [ ] 審計追蹤功能

**預計時間**：2-3 周  
**里程碑**：里程碑 12 - Phase 2 功能增強完成（2025-07-15）

**Phase 2 交付物**：
- ✅ 完整的資料分析系統
- ✅ 文件管理系統（版本控制、縮圖、軟刪除）
- ✅ 機器人系統（定期報表、通知、備份）
- ✅ 系統管理（設定、功能開關）
- ✅ 性能優化完成
- ✅ RLS 策略完善

---

## 🔮 Phase 3：進階功能（6個月）

> **目標**：擴展系統能力，支持更複雜的業務場景  
> **範圍**：高級數據分析、自定義工作流、第三方集成、移動端支持、多語言支持

### Month 7-8：高級數據分析與自定義工作流（2025-07 ~ 2025-09）

##### 📈 高級數據分析
**任務清單**：
- [ ] 高級報表生成（自定義報表、圖表）
- [ ] 數據導出功能（Excel、PDF）
- [ ] 數據可視化增強（更多圖表類型）
- [ ] 預測性分析（基於歷史數據）

**預計時間**：4-6 周

##### 🔄 自定義工作流
**任務清單**：
- [ ] 工作流引擎設計
- [ ] 工作流配置 UI
- [ ] 工作流執行引擎
- [ ] 工作流監控和調試

**預計時間**：6-8 周  
**里程碑**：里程碑 13 - 高級數據分析與工作流 MVP（2025-09-15）

### Month 9-10：第三方集成（2025-09 ~ 2025-11）

##### 🔌 第三方集成
**任務清單**：
- [ ] API 文檔完善（OpenAPI/Swagger）
- [ ] Webhook 支持（事件通知）
- [ ] 第三方服務集成（如：天氣 API、地圖 API）
- [ ] OAuth 集成（第三方登入）
- [ ] 數據導入/導出（Excel、CSV）

**預計時間**：6-8 周  
**里程碑**：里程碑 14 - 第三方集成完成（2025-11-15）

### Month 11-12：移動端與多語言支持（2025-11 ~ 2026-01）

##### 📱 移動端支持
**任務清單**：
- [ ] 響應式設計優化（移動端適配）
- [ ] PWA 支持（離線功能、推送通知）
- [ ] 移動端專用功能（拍照上傳、GPS 定位）
- [ ] 移動端性能優化

**預計時間**：6-8 周

##### 🌐 多語言支持（i18n）
**任務清單**：
- [ ] i18n 框架整合（Angular i18n）
- [ ] 語言文件管理
- [ ] 語言切換功能
- [ ] 日期、數字格式化（本地化）

**預計時間**：4-6 周  
**里程碑**：里程碑 15 - Phase 3 進階功能完成（2026-01-15）

**Phase 3 交付物**：
- ✅ 高級數據分析功能
- ✅ 自定義工作流系統
- ✅ 第三方集成（API、Webhook）
- ✅ 移動端支持（響應式、PWA）
- ✅ 多語言支持（i18n）

---

## 📊 開發優先級

### 🔴 高優先級（P0）
1. **賬戶系統開發** - 基礎層，其他模組依賴
2. **藍圖主分支管理** - 核心業務功能
3. **基礎任務 CRUD** - 核心業務功能

### 🟡 中優先級（P1）
1. **組織協作系統** - 支持多組織協作
2. **分支管理與 Fork** - Git-like 分支模型核心
3. **任務指派與執行** - 核心業務流程

### 🟢 低優先級（P2）
1. **數據分析功能** - 增強功能
2. **文件管理系統** - 增強功能
3. **Bot 系統** - 擴展功能

---

## 🎯 完整里程碑列表

### Phase 0：基礎建設（已完成 ✅）

#### 里程碑 1：核心架構建立 ✅
- **完成時間**：2025-01-15
- **狀態**：已完成
- **內容**：Git-like 分支模型、51 張資料表、文檔體系

#### 里程碑 2：權限系統實施 ✅
- **完成時間**：2025-01-15
- **狀態**：已完成
- **內容**：RBAC 權限控制、@delon/acl 整合、分支權限控制

#### 里程碑 3：認證系統整合 ✅
- **完成時間**：2025-11-14
- **狀態**：已完成
- **內容**：Supabase Auth 整合、適配器模式、Session 同步

#### 里程碑 4：基礎設施模組建立 ✅
- **完成時間**：2025-01-15
- **狀態**：已完成
- **內容**：Repository 模式、類型定義、錯誤處理、數據轉換

### Phase 1：MVP（2025-01 ~ 2025-04）

#### 里程碑 5：賬戶系統 MVP
- **計劃時間**：2025-02-15
- **狀態**：進行中
- **內容**：完整的賬戶管理功能（CRUD、團隊管理）
- **模組**：帳戶與身份系統（4 張表）

#### 里程碑 5.5：組織協作系統 MVP
- **計劃時間**：2025-02-28
- **狀態**：待開始
- **內容**：組織協作關係管理、邀請機制
- **模組**：組織協作系統（3 張表）

#### 里程碑 6：藍圖系統 MVP ✅
- **計劃時間**：2025-03-15
- **實際完成時間**：2025-11-14
- **狀態**：✅ 已完成
- **內容**：藍圖主分支管理、Fork 機制、PR 流程
- **模組**：藍圖/專案系統（5 張表）

#### 里程碑 7：任務系統 MVP
- **計劃時間**：2025-03-31
- **狀態**：待開始
- **內容**：任務指派、執行、暫存區機制（48h 可撤回）
- **模組**：任務執行系統（9 張表）

#### 里程碑 8：品質驗收系統 MVP
- **計劃時間**：2025-04-15
- **狀態**：待開始
- **內容**：品管驗收流程、問題追蹤、待辦中心（五種狀態）
- **模組**：品質驗收系統（4 張表）、問題追蹤系統（4 張表）、協作溝通系統（6 張表）

#### 里程碑 9：Phase 1 MVP 交付
- **計劃時間**：2025-04-30
- **狀態**：待開始
- **內容**：Beta 版本發布、10 家試用客戶、核心功能完整

### Phase 2：功能增強（2025-04 ~ 2025-07）

#### 里程碑 10：資料分析系統 MVP
- **計劃時間**：2025-05-15
- **狀態**：待開始
- **內容**：進度追蹤儀表板、活動記錄、數據分析快取
- **模組**：資料分析系統（6 張表）

#### 里程碑 11：文件管理與機器人系統 MVP
- **計劃時間**：2025-06-15
- **狀態**：待開始
- **內容**：文件管理（版本控制、縮圖、軟刪除）、機器人系統（定期報表、通知、備份）
- **模組**：文件管理系統（3 張表）、機器人系統（3 張表）

#### 里程碑 12：Phase 2 功能增強完成
- **計劃時間**：2025-07-15
- **狀態**：待開始
- **內容**：系統管理、性能優化、RLS 策略完善

### Phase 3：進階功能（2025-07 ~ 2026-01）

#### 里程碑 13：高級數據分析與工作流 MVP
- **計劃時間**：2025-09-15
- **狀態**：待開始
- **內容**：高級報表生成、自定義工作流系統

#### 里程碑 14：第三方集成完成
- **計劃時間**：2025-11-15
- **狀態**：待開始
- **內容**：API 文檔、Webhook、第三方服務集成

#### 里程碑 15：Phase 3 進階功能完成
- **計劃時間**：2026-01-15
- **狀態**：待開始
- **內容**：移動端支持、多語言支持（i18n）

### 最終交付

#### 里程碑 16：正式版發布
- **計劃時間**：2026-02-01
- **狀態**：待開始
- **內容**：正式版發布、完整文檔、用戶培訓

---

## ⚠️ 風險管理

### 技術風險

#### 高風險項目
1. **Git-like 分支模型實現複雜度**
   - **風險**：分支合併邏輯複雜，可能出現數據不一致
   - **緩解措施**：
     - 詳細設計 PR 合併邏輯
     - 完整的單元測試和集成測試
     - 分階段實施，先實現基礎功能
   - **負責人**：架構師

2. **任務樹狀結構性能問題**
   - **風險**：無限層級可能導致查詢性能下降
   - **緩解措施**：
     - 使用遞歸 CTE 優化查詢
     - 實現緩存機制
     - 限制單次查詢深度
   - **負責人**：後端開發

3. **RLS 策略複雜度**
   - **風險**：51 張表的 RLS 策略可能過於複雜
   - **緩解措施**：
     - 分階段實施，先建立基礎策略
     - 逐步細化，根據業務需求調整
     - 定期審查和優化
   - **負責人**：安全工程師

#### 中風險項目
1. **數據同步機制**
   - **風險**：多分支數據同步可能出現延遲或不一致
   - **緩解措施**：使用事務確保一致性，實現重試機制

2. **性能優化**
   - **風險**：系統規模擴大後性能可能下降
   - **緩解措施**：定期性能測試，優化查詢和緩存策略

### 進度風險

#### 可能延遲的模組
1. **任務執行系統**（模組 4）
   - **原因**：功能複雜，涉及多個子系統
   - **緩解措施**：提前開始設計，分階段實施

2. **藍圖系統**（模組 3）
   - **原因**：Git-like 分支模型實現複雜
   - **緩解措施**：參考 Git 實現，使用成熟模式

### 資源風險

#### 人力資源
- **風險**：開發人員不足或技能不匹配
- **緩解措施**：
  - 提前培訓團隊成員
  - 使用 AI 輔助開發（Sequential Thinking + Software Planning Tool）
  - 合理分配任務，避免瓶頸

#### 技術資源
- **風險**：Supabase 服務限制或成本超支
- **緩解措施**：
  - 定期監控使用量
  - 優化查詢和存儲
  - 考慮升級計劃

---

## 📝 開發原則

### 技術原則
1. **分層架構**：嚴格遵守 `routes` → `shared` → `core` 依賴方向
2. **Repository 模式**：數據訪問統一通過 Repository
3. **類型安全**：完整的 TypeScript 類型定義
4. **測試覆蓋**：目標 80% 單元測試覆蓋率
5. **代碼質量**：遵循 ESLint、Prettier、Stylelint 規範

### 開發流程
1. **規劃階段**：使用 Sequential Thinking + Software Planning Tool
2. **設計階段**：詳細設計數據模型、API、UI
3. **實施階段**：遵循開發規範和最佳實踐
4. **驗證階段**：單元測試、集成測試、文檔更新
5. **審查階段**：代碼審查、性能測試、安全審查

### 文檔要求
1. **同步更新**：代碼變更需同步更新相關文檔
2. **決策記錄**：重大決策記錄在 fyi-development.md
3. **歷史追蹤**：里程碑和重大改動記錄在 fyi-history.md
4. **API 文檔**：所有 API 接口需有完整文檔
5. **用戶指南**：每個功能模組需有用戶指南

### 質量保證
1. **代碼審查**：所有代碼需經過審查
2. **測試覆蓋**：目標 80% 單元測試覆蓋率
3. **性能測試**：定期進行性能測試
4. **安全審查**：定期進行安全審查
5. **用戶測試**：重要功能需經過用戶測試

---

## 🔄 更新機制

### 更新頻率
- **每週更新**：更新當前進度和任務狀態
- **每月更新**：更新里程碑進度和風險評估
- **每階段更新**：Phase 完成後更新整體進度

### 更新內容
1. **進度更新**：更新任務完成狀態、里程碑進度
2. **時間調整**：根據實際進度調整時間估算
3. **風險更新**：更新風險評估和緩解措施
4. **優先級調整**：根據業務需求調整開發優先級

### 更新責任人
- **項目經理**：負責整體進度更新
- **技術負責人**：負責技術風險更新
- **開發團隊**：負責任務狀態更新

---

## 🔄 更新記錄

### 2025-01-15（v2.0）
- ✅ 建立路線圖草稿（v1.0）
- ✅ 記錄當前狀態和已完成工作
- ✅ 規劃 Phase 1 MVP 開發計劃
- ✅ 定義開發優先級和里程碑
- ✅ **v2.0 重大更新**：
  - ✅ 添加完整的模組開發順序和依賴關係
  - ✅ 詳細的任務分解（11 個模組，51 張表）
  - ✅ 時間估算和里程碑定義
  - ✅ 風險管理和資源規劃
  - ✅ Phase 2 和 Phase 3 詳細規劃
  - ✅ 更新機制說明

---

## 📚 相關文檔

### 核心文檔
- [PRD 文檔](./PRD.md) - 產品需求文檔
- [架構審查報告](./28-架構審查報告.md) - 架構設計說明
- [完整架構流程圖](./27-完整架構流程圖.mermaid.md) - 系統架構圖

### 開發文檔
- [開發作業指引](./00-開發作業指引.md) - 開發規範與流程
- [開發工作流程](./35-開發工作流程.md) - 工作流程規範
- [快速開始指南](./32-快速開始指南.md) - 環境設定與啟動

### 脈絡文檔
- [歷史紀錄](./fyi-history.md) - 開發歷史與里程碑
- [開發脈絡](./fyi-development.md) - 開發決策記錄
- [架構說明](./fyi-architecture.md) - 系統架構設計理念

---

**最後更新**：2025-01-15  
**維護者**：開發團隊  
**下次審查**：2025-02-15

