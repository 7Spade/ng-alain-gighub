# èœå•é“¾æ¥ä¿®å¤æŠ¥å‘Š

> **ä¿®å¤æ—¥æœŸ**ï¼š2025-01-20  
> **é—®é¢˜**ï¼šèœå•é¡¹ "My Profile"ã€"My Teams"ã€"My Schedules" æ— æ³•æ­£å¸¸æ‰“å¼€

---

## ğŸ” é—®é¢˜åˆ†æ

### é—®é¢˜æè¿°

1. **"My Profile"** é“¾æ¥æŒ‡å‘ `/accounts/users`ï¼Œä½†è¯¥è·¯ç”±å·²è¢«åˆ é™¤
   - å¯èƒ½è¢« `/accounts/:id` é€šé…ç¬¦è·¯ç”±åŒ¹é…ï¼Œå¯¼è‡´æ˜¾ç¤ºé”™è¯¯é¡µé¢

2. **"My Teams"** å’Œ **"My Schedules"** éƒ½æŒ‡å‘ `/accounts/org`
   - ä¸ "My Organizations" ä½¿ç”¨ç›¸åŒé“¾æ¥
   - èœå•ç³»ç»Ÿå¯èƒ½æ— æ³•åŒºåˆ†æˆ–å¤„ç†é‡å¤é“¾æ¥
   - åŠŸèƒ½å·²æ•´åˆåˆ°ç»„ç»‡ç®¡ç†é¡µé¢ä¸­

3. **"My Organizations"** å¯ä»¥æ­£å¸¸æ‰“å¼€
   - é“¾æ¥æ­£ç¡®æŒ‡å‘ `/accounts/org`

---

## âœ… ä¿®å¤æ–¹æ¡ˆ

### 1. ä¿®å¤ "My Profile" é“¾æ¥

**é—®é¢˜**ï¼šé“¾æ¥æŒ‡å‘ä¸å­˜åœ¨çš„è·¯ç”± `/accounts/users`

**è§£å†³æ–¹æ¡ˆ**ï¼š
- ä½¿ç”¨åŠ¨æ€å ä½ç¬¦ `:userId`ï¼Œåœ¨èœå•åˆ‡æ¢æ—¶è‡ªåŠ¨æ›¿æ¢ä¸ºå½“å‰ç”¨æˆ· ID
- é“¾æ¥æ”¹ä¸º `/accounts/:userId`ï¼ŒæŒ‡å‘ç”¨æˆ·è‡ªå·±çš„è´¦æˆ·è¯¦æƒ…é¡µé¢

**ä»£ç å˜æ›´**ï¼š
- `src/assets/tmp/user-data.json`ï¼šå°† "My Profile" é“¾æ¥ä» `/accounts/users` æ”¹ä¸º `/accounts/:userId`
- `src/app/core/services/workspace-menu.service.ts`ï¼š
  - æ›´æ–° `switchToUser()` æ–¹æ³•ï¼Œæ”¯æŒä¼ é€’ `userId` å‚æ•°
  - æ›´æ–° `processMenuLinks()` æ–¹æ³•ï¼Œæ”¯æŒ `:userId` å ä½ç¬¦æ›¿æ¢
- `src/app/core/facades/workspace-context.facade.ts`ï¼š
  - åœ¨åˆ‡æ¢åˆ°ç”¨æˆ·èœå•æ—¶ï¼Œä¼ é€’å½“å‰ç”¨æˆ·è´¦æˆ· ID

### 2. ç§»é™¤å†—ä½™èœå•é¡¹

**é—®é¢˜**ï¼š"My Teams" å’Œ "My Schedules" åŠŸèƒ½å·²æ•´åˆåˆ°ç»„ç»‡ç®¡ç†ä¸­

**è§£å†³æ–¹æ¡ˆ**ï¼š
- ç§»é™¤ "My Teams" èœå•é¡¹ï¼ˆå›¢é˜ŸåŠŸèƒ½å¯é€šè¿‡ç»„ç»‡åˆ—è¡¨è®¿é—®ï¼‰
- ç§»é™¤ "My Schedules" èœå•é¡¹ï¼ˆæ’ç­åŠŸèƒ½å¯é€šè¿‡ç»„ç»‡åˆ—è¡¨è®¿é—®ï¼‰

**ä»£ç å˜æ›´**ï¼š
- `src/assets/tmp/user-data.json`ï¼šç§»é™¤ "My Teams" å’Œ "My Schedules" èœå•é¡¹

---

## ğŸ“ ä»£ç å˜æ›´è¯¦æƒ…

### 1. `src/assets/tmp/user-data.json`

```json
{
  "text": "My Profile",
  "link": "/accounts/:userId",  // ä½¿ç”¨ :userId å ä½ç¬¦
  "i18n": "menu.personal.account.profile"
}
// ç§»é™¤äº† "My Teams" å’Œ "My Schedules" èœå•é¡¹
```

### 2. `src/app/core/services/workspace-menu.service.ts`

```typescript
/**
 * åˆ‡æ¢åˆ°ä¸ªäººç”¨æˆ·èœå•
 *
 * @param userId å½“å‰ç”¨æˆ·è´¦æˆ· IDï¼ˆå¯é€‰ï¼Œç”¨äºæ›¿æ¢èœå•é“¾æ¥ä¸­çš„ :userId å ä½ç¬¦ï¼‰
 */
switchToUser(userId?: string): void {
  // ...
  const processedMenu = userId 
    ? this.processMenuLinks(this.userMenuData, userId, 'userId') 
    : this.userMenuData;
  // ...
}

/**
 * å¤„ç†èœå•é“¾æ¥ï¼Œæ›¿æ¢åŠ¨æ€ ID å ä½ç¬¦
 *
 * @param placeholder å ä½ç¬¦åç§°ï¼ˆé»˜è®¤ä¸º 'id'ï¼Œå¯ä»¥æ˜¯ 'id' æˆ– 'userId'ï¼‰
 */
private processMenuLinks(menu: NzSafeAny[], id: string, placeholder: string = 'id'): NzSafeAny[] {
  const placeholderPattern = new RegExp(`:${placeholder}`, 'g');
  // æ›¿æ¢ :userId æˆ– :id å ä½ç¬¦
  // ...
}
```

### 3. `src/app/core/facades/workspace-context.facade.ts`

```typescript
case 'user':
  // ä¼ é€’å½“å‰ç”¨æˆ·è´¦æˆ· IDï¼Œç”¨äºæ›¿æ¢èœå•é“¾æ¥ä¸­çš„ :userId å ä½ç¬¦
  const userId = this.currentUserAccountId();
  this.menuService.switchToUser(userId || undefined);
  break;
```

---

## âœ… éªŒè¯æ£€æŸ¥æ¸…å•

- [x] "My Profile" é“¾æ¥æ­£ç¡®æŒ‡å‘å½“å‰ç”¨æˆ·çš„è´¦æˆ·è¯¦æƒ…é¡µé¢
- [x] "My Organizations" é“¾æ¥æ­£å¸¸å·¥ä½œ
- [x] ç§»é™¤äº†å†—ä½™çš„ "My Teams" å’Œ "My Schedules" èœå•é¡¹
- [x] èœå•ç³»ç»Ÿæ­£ç¡®å¤„ç† `:userId` å ä½ç¬¦
- [x] ä»£ç é€šè¿‡ lint æ£€æŸ¥

---

## ğŸ¯ åŠŸèƒ½è¯´æ˜

### èœå•ç»“æ„ï¼ˆä¿®å¤åï¼‰

```
Account System
â”œâ”€â”€ My Profile          â†’ /accounts/:userIdï¼ˆå½“å‰ç”¨æˆ·è¯¦æƒ…ï¼‰
â””â”€â”€ My Organizations    â†’ /accounts/orgï¼ˆç»„ç»‡ç®¡ç†ï¼‰
```

### åŠŸèƒ½è®¿é—®è·¯å¾„

1. **æŸ¥çœ‹ä¸ªäººèµ„æ–™**ï¼š
   - ç‚¹å‡» "My Profile" â†’ è‡ªåŠ¨è·³è½¬åˆ°å½“å‰ç”¨æˆ·çš„è´¦æˆ·è¯¦æƒ…é¡µé¢

2. **ç®¡ç†ç»„ç»‡**ï¼š
   - ç‚¹å‡» "My Organizations" â†’ è¿›å…¥ç»„ç»‡ç®¡ç†é¡µé¢
   - åœ¨ç»„ç»‡åˆ—è¡¨ä¸­å¯ä»¥çœ‹åˆ°æ‰€æœ‰ç»„ç»‡
   - ç‚¹å‡»ç»„ç»‡å¯ä»¥æŸ¥çœ‹è¯¦æƒ…ã€ç®¡ç†æˆå‘˜ã€è§’è‰²ã€å›¢é˜Ÿç­‰

3. **æŸ¥çœ‹å›¢é˜Ÿ**ï¼š
   - é€šè¿‡ç»„ç»‡ç®¡ç†é¡µé¢ â†’ é€‰æ‹©ç»„ç»‡ â†’ å›¢é˜Ÿç®¡ç†

4. **æŸ¥çœ‹æ’ç­**ï¼š
   - é€šè¿‡ç»„ç»‡ç®¡ç†é¡µé¢ â†’ é€‰æ‹©ç»„ç»‡ â†’ æ’ç­ç®¡ç†

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [accounts æ¨¡å—è¯„ä¼°æŠ¥å‘Š](./accountsæ¨¡å—è¯„ä¼°æŠ¥å‘Š-2025-01-20.md)
- [accounts æ¨¡å—å®æ–½æ€»ç»“](./accountsæ¨¡å—å®æ–½æ€»ç»“-2025-01-20.md)
- [org æ¨¡å—ä¸‰è§†è§’è®¾è®¡æ–¹æ¡ˆ](./orgæ¨¡å—ä¸‰è§†è§’è®¾è®¡æ–¹æ¡ˆ-2025-01-20.md)

---

**æœ€å¾Œæ›´æ–°**ï¼š2025-01-20  
**ç¶­è­·è€…**ï¼šé–‹ç™¼åœ˜éšŠ

