# ng-alain 重構後專案結構樹（最終完成版）

> 本結構樹基於 Angular 20 Standalone Components 架構與最佳實踐設計，體現清晰的分層架構（routes → shared → core）與模組化組織。

## 結構樹總覽

```
ng-alain/
│
├─ 📄 專案配置與文檔
│  ├─ AGENTS.md                          # AI Agent 工作指引
│  ├─ README.md                          # 專案說明
│  ├─ README-zh_CN.md                    # 中文說明
│  ├─ CONTRIBUTING.md                    # 貢獻指南
│  ├─ LICENSE                            # 授權文件
│  ├─ package.json                       # 依賴管理
│  ├─ yarn.lock                          # 鎖定版本
│  ├─ angular.json                       # Angular 配置
│  ├─ tsconfig.json                      # TypeScript 配置
│  ├─ tsconfig.app.json                  # 應用 TypeScript 配置
│  ├─ tsconfig.spec.json                 # 測試 TypeScript 配置
│  ├─ eslint.config.mjs                  # ESLint 配置
│  ├─ stylelint.config.mjs               # Stylelint 配置
│  ├─ ng-alain.json                      # ng-alain 配置
│  ├─ proxy.conf.js                      # 開發代理配置
│  ├─ repomix.config.json                # Repomix 配置
│  ├─ tasks.md                           # 任務清單
│  └─ work-items.json                    # 工作項目
│
├─ 📁 src/                               # 前端應用原始碼
│  │
│  ├─ 📄 應用入口
│  │  ├─ index.html                      # HTML 入口
│  │  ├─ main.ts                         # 應用啟動入口
│  │  ├─ styles.less                     # 全域樣式入口
│  │  ├─ style-icons.ts                  # 圖標定義
│  │  ├─ style-icons-auto.ts             # 自動生成圖標
│  │  └─ typings.d.ts                    # 類型定義
│  │
│  ├─ 📁 app/                            # 應用核心
│  │  │
│  │  ├─ 📄 應用配置
│  │  │  ├─ AGENTS.md                    # 應用層 AI 指引
│  │  │  ├─ app.component.ts             # 根組件（Standalone）
│  │  │  └─ app.config.ts                # 應用配置（Providers、DI）
│  │  │
│  │  ├─ 📁 core/                        # 🧠 核心服務層（Core Layer）
│  │  │  │
│  │  │  ├─ 📄 核心配置
│  │  │  │  ├─ AGENTS.md                 # 核心層 AI 指引
│  │  │  │  ├─ README.md                 # 核心層說明
│  │  │  │  ├─ index.ts                  # 核心層導出
│  │  │  │  └─ start-page.guard.ts       # 起始頁守衛
│  │  │  │
│  │  │  ├─ 📁 account/                  # 帳戶服務
│  │  │  │  ├─ 📁 organization/          # 組織服務
│  │  │  │  │  ├─ index.ts
│  │  │  │  │  ├─ organization.service.ts
│  │  │  │  │  └─ organization-context.service.ts
│  │  │  │  ├─ 📁 team/                  # 團隊服務
│  │  │  │  │  ├─ index.ts
│  │  │  │  │  └─ team.service.ts
│  │  │  │  └─ 📁 user/                  # 用戶服務
│  │  │  │      ├─ index.ts
│  │  │  │      └─ user.service.ts
│  │  │  │
│  │  │  ├─ 📁 blueprint/                # 藍圖/專案服務
│  │  │  │  ├─ index.ts
│  │  │  │  ├─ blueprint.service.ts      # 藍圖主服務
│  │  │  │  ├─ 📁 activity/              # 活動記錄服務
│  │  │  │  │  └─ blueprint-activity.service.ts
│  │  │  │  ├─ 📁 aggregation/           # 聚合刷新服務
│  │  │  │  │  ├─ blueprint-aggregation.service.ts
│  │  │  │  │  └─ blueprint-aggregation.service.spec.ts
│  │  │  │  ├─ 📁 discussion/            # 討論服務
│  │  │  │  │  └─ blueprint-discussion.service.ts
│  │  │  │  ├─ 📁 document/              # 文件服務
│  │  │  │  │  ├─ blueprint-document-upload.service.ts
│  │  │  │  │  └─ document-version.service.ts
│  │  │  │  ├─ 📁 issue/                 # 問題服務
│  │  │  │  │  └─ blueprint-issue.service.ts
│  │  │  │  ├─ 📁 quality/               # 品質服務
│  │  │  │  │  └─ blueprint-quality-check.service.ts
│  │  │  │  └─ 📁 weather/               # 天氣服務
│  │  │  │      ├─ index.ts
│  │  │  │      └─ weather.service.ts
│  │  │  │
│  │  │  ├─ 📁 i18n/                     # 國際化服務
│  │  │  │  ├─ i18n.service.ts
│  │  │  │  └─ i18n.service.spec.ts
│  │  │  │
│  │  │  ├─ 📁 net/                      # 網路層
│  │  │  │  ├─ index.ts
│  │  │  │  ├─ default.interceptor.ts    # 預設攔截器
│  │  │  │  ├─ helper.ts                 # 網路輔助工具
│  │  │  │  ├─ refresh-token.ts          # Token 刷新
│  │  │  │  └─ 📁 error/                 # 錯誤處理
│  │  │  │      ├─ index.ts
│  │  │  │      ├─ error-helper.ts
│  │  │  │      ├─ error-state.service.ts
│  │  │  │      └─ ERROR_HANDLING_GUIDE.md
│  │  │  │
│  │  │  ├─ 📁 startup/                  # 啟動服務
│  │  │  │  └─ startup.service.ts
│  │  │  │
│  │  │  └─ 📁 supabase/                 # Supabase 客戶端封裝
│  │  │      ├─ index.ts
│  │  │      ├─ README.md
│  │  │      └─ supabase.service.ts      # Supabase 服務封裝
│  │  │
│  │  ├─ 📁 layout/                      # 🏗️ 布局層（Layout Layer）
│  │  │  │
│  │  │  ├─ 📄 布局配置
│  │  │  │  ├─ AGENTS.md                 # 布局層 AI 指引
│  │  │  │  └─ index.ts                  # 布局層導出
│  │  │  │
│  │  │  ├─ 📁 basic/                    # 基本布局
│  │  │  │  ├─ basic.component.ts        # 基本布局組件（Standalone）
│  │  │  │  ├─ README.md
│  │  │  │  └─ 📁 widgets/               # 布局小工具
│  │  │  │      ├─ clear-storage.component.ts
│  │  │  │      ├─ fullscreen.component.ts
│  │  │  │      ├─ i18n.component.ts
│  │  │  │      ├─ icon.component.ts
│  │  │  │      ├─ notify.component.ts
│  │  │  │      ├─ rtl.component.ts
│  │  │  │      ├─ search.component.ts
│  │  │  │      ├─ task.component.ts
│  │  │  │      └─ user.component.ts
│  │  │  │
│  │  │  ├─ 📁 blank/                    # 空白布局
│  │  │  │  ├─ blank.component.ts        # 空白布局組件（Standalone）
│  │  │  │  └─ README.md
│  │  │  │
│  │  │  └─ 📁 passport/                 # 認證布局
│  │  │      ├─ passport.component.ts    # 認證布局組件（Standalone）
│  │  │      └─ passport.component.less
│  │  │
│  │  ├─ 📁 routes/                      # 🛣️ 路由/頁面層（UI Layer）
│  │  │  │
│  │  │  ├─ 📄 路由配置
│  │  │  │  ├─ AGENTS.md                 # 路由層 AI 指引
│  │  │  │  └─ routes.ts                 # 主路由配置
│  │  │  │
│  │  │  ├─ 📁 account/                  # 帳戶管理路由
│  │  │  │  ├─ AGENTS.md
│  │  │  │  ├─ routes.ts
│  │  │  │  ├─ 📁 center/                # 個人中心
│  │  │  │  │  ├─ center.component.ts    # 個人中心組件（Standalone）
│  │  │  │  │  ├─ center.component.html
│  │  │  │  │  ├─ center.component.less
│  │  │  │  │  ├─ 📁 applications/       # 應用管理
│  │  │  │  │  │  ├─ applications.component.ts
│  │  │  │  │  │  ├─ applications.component.html
│  │  │  │  │  │  └─ applications.component.less
│  │  │  │  │  ├─ 📁 articles/           # 文章管理
│  │  │  │  │  │  ├─ articles.component.ts
│  │  │  │  │  │  └─ articles.component.html
│  │  │  │  │  └─ 📁 projects/           # 專案管理
│  │  │  │  │      ├─ projects.component.ts
│  │  │  │  │      ├─ projects.component.html
│  │  │  │  │      └─ projects.component.less
│  │  │  │  └─ 📁 settings/              # 帳戶設定
│  │  │  │      ├─ settings.component.ts
│  │  │  │      ├─ settings.component.html
│  │  │  │      ├─ settings.component.less
│  │  │  │      ├─ 📁 base/              # 基本設定
│  │  │  │      ├─ 📁 binding/           # 帳戶綁定
│  │  │  │      ├─ 📁 notification/      # 通知設定
│  │  │  │      └─ 📁 security/          # 安全設定
│  │  │  │
│  │  │  ├─ 📁 blueprint/                # 🎯 藍圖/專案路由（核心業務）
│  │  │  │  ├─ AGENTS.md
│  │  │  │  ├─ routes.ts
│  │  │  │  ├─ 📁 create/                # 建立藍圖
│  │  │  │  │  ├─ create.component.ts    # 建立藍圖組件（Standalone）
│  │  │  │  │  └─ create.component.html
│  │  │  │  ├─ 📁 list/                  # 藍圖列表
│  │  │  │  │  ├─ list.component.ts      # 藍圖列表組件（Standalone）
│  │  │  │  │  └─ list.component.html
│  │  │  │  ├─ 📁 detail/                # 藍圖詳情
│  │  │  │  │  ├─ detail.component.ts    # 藍圖詳情組件（Standalone）
│  │  │  │  │  ├─ detail.component.html
│  │  │  │  │  └─ detail.routes.ts       # 詳情頁子路由
│  │  │  │  └─ 📁 tabs/                  # 藍圖詳情標籤頁
│  │  │  │      ├─ 📁 overview/          # 概覽標籤
│  │  │  │      │  ├─ overview.component.ts
│  │  │  │      │  ├─ overview.component.html
│  │  │  │      │  ├─ index.ts
│  │  │  │      │  ├─ 📁 data-access/    # 資料存取層
│  │  │  │      │  │  └─ overview.repository.ts
│  │  │  │      │  ├─ 📁 models/         # 模型定義
│  │  │  │      │  │  └─ overview-view.model.ts
│  │  │  │      │  ├─ 📁 state/          # 狀態管理
│  │  │  │      │  │  └─ overview.facade.ts
│  │  │  │      │  ├─ 📁 ui/             # UI 組件
│  │  │  │      │  │  └─ 📁 containers/
│  │  │  │      │  │      └─ overview-page/
│  │  │  │      │  │          ├─ overview-page.component.ts
│  │  │  │      │  │          ├─ overview-page.component.html
│  │  │  │      │  │          └─ overview-page.component.less
│  │  │  │      │  └─ 📁 utils/          # 工具函數
│  │  │  │      │      ├─ overview-health.utils.ts
│  │  │  │      │      ├─ overview-status.utils.ts
│  │  │  │      │      └─ overview-task.utils.ts
│  │  │  │      ├─ 📁 activity/          # 活動記錄標籤
│  │  │  │      │  ├─ activity.component.ts
│  │  │  │      │  ├─ activity.component.html
│  │  │  │      │  └─ 📁 state/
│  │  │  │      │      └─ activity.facade.ts
│  │  │  │      ├─ 📁 charts/            # 圖表標籤
│  │  │  │      │  ├─ charts.component.ts
│  │  │  │      │  ├─ charts.component.html
│  │  │  │      │  ├─ chart-types.ts
│  │  │  │      │  └─ 📁 state/
│  │  │  │      │      └─ blueprint-charts.facade.ts
│  │  │  │      ├─ 📁 discussions/       # 討論標籤
│  │  │  │      │  ├─ discussions.component.ts
│  │  │  │      │  └─ discussions.component.html
│  │  │  │      ├─ 📁 documents/         # 文件標籤
│  │  │  │      │  ├─ documents.component.ts
│  │  │  │      │  ├─ documents.component.html
│  │  │  │      │  ├─ documents.component.less
│  │  │  │      │  ├─ document-tree-node.model.ts
│  │  │  │      │  ├─ 📁 components/     # 文件組件
│  │  │  │      │  │  ├─ document-detail-panel.component.ts
│  │  │  │      │  │  └─ document-tree-panel.component.ts
│  │  │  │      │  └─ 📁 shared/         # 文件共享層
│  │  │  │      │      ├─ 📁 data-access/
│  │  │  │      │      │  └─ blueprint-documents.repository.ts
│  │  │  │      │      └─ 📁 state/
│  │  │  │      │          ├─ blueprint-documents.facade.ts
│  │  │  │      │          └─ blueprint-documents.facade.spec.ts
│  │  │  │      ├─ 📁 issues/            # 問題標籤
│  │  │  │      │  ├─ issues.component.ts
│  │  │  │      │  └─ issues.component.html
│  │  │  │      ├─ 📁 progress/          # 進度標籤
│  │  │  │      │  ├─ progress.component.ts
│  │  │  │      │  └─ progress.component.html
│  │  │  │      ├─ 📁 quality/           # 品質標籤
│  │  │  │      │  ├─ quality.component.ts
│  │  │  │      │  └─ quality.component.html
│  │  │  │      ├─ 📁 report/            # 報表標籤
│  │  │  │      │  ├─ report.component.ts
│  │  │  │      │  └─ report.component.html
│  │  │  │      ├─ 📁 settings/          # 設定標籤
│  │  │  │      │  ├─ settings.component.ts
│  │  │  │      │  └─ settings.component.html
│  │  │  │      ├─ 📁 tasks/             # 📋 任務管理標籤（13 維度）
│  │  │  │      │  ├─ README.md          # 任務模組說明
│  │  │  │      │  ├─ tasks-routing.module.ts
│  │  │  │      │  ├─ tasks.module.ts
│  │  │  │      │  ├─ 📁 features/       # 任務功能模組
│  │  │  │      │  │  ├─ 📁 task-activity/       # 活動記錄
│  │  │  │      │  │  │  ├─ README.md
│  │  │  │      │  │  │  ├─ 📁 assets/
│  │  │  │      │  │  │  ├─ 📁 components/
│  │  │  │      │  │  │  ├─ 📁 services/
│  │  │  │      │  │  │  └─ 📁 state/
│  │  │  │      │  │  ├─ 📁 task-change/         # 變更管理
│  │  │  │      │  │  │  ├─ README.md
│  │  │  │      │  │  │  ├─ task-change-routing.module.ts
│  │  │  │      │  │  │  ├─ task-change.module.ts
│  │  │  │      │  │  │  ├─ 📁 assets/
│  │  │  │      │  │  │  ├─ 📁 components/
│  │  │  │      │  │  │  ├─ 📁 services/
│  │  │  │      │  │  │  │  └─ 📁 domain/
│  │  │  │      │  │  │  │      └─ task-change.service.ts
│  │  │  │      │  │  │  └─ 📁 state/
│  │  │  │      │  │  ├─ 📁 task-charts/         # 圖表分析
│  │  │  │      │  │  ├─ 📁 task-checkpoint/     # 檢查點
│  │  │  │      │  │  ├─ 📁 task-communication/  # 溝通協作
│  │  │  │      │  │  ├─ 📁 task-cost/           # 成本管理
│  │  │  │      │  │  │  ├─ README.md
│  │  │  │      │  │  │  ├─ 📁 services/
│  │  │  │      │  │  │  │  ├─ 📁 computation/
│  │  │  │      │  │  │  │  │  └─ task-cost-calculator.service.ts
│  │  │  │      │  │  │  │  └─ 📁 domain/
│  │  │  │      │  │  │  │      └─ task-cost.service.ts
│  │  │  │      │  │  ├─ 📁 task-dependency/     # 依賴關係
│  │  │  │      │  │  ├─ 📁 task-detail/         # 任務詳情
│  │  │  │      │  │  │  ├─ README.md
│  │  │  │      │  │  │  ├─ task-detail-routing.module.ts
│  │  │  │      │  │  │  ├─ task-detail.module.ts
│  │  │  │      │  │  │  ├─ 📁 components/
│  │  │  │      │  │  │  │  ├─ task-detail.component.ts
│  │  │  │      │  │  │  │  ├─ task-detail.component.html
│  │  │  │      │  │  │  │  └─ 📁 task-detail-tabs/
│  │  │  │      │  │  │  │      ├─ task-detail-basic.component.ts
│  │  │  │      │  │  │  │      ├─ task-detail-change.component.ts
│  │  │  │      │  │  │  │      ├─ task-detail-cost.component.ts
│  │  │  │      │  │  │  │      ├─ task-detail-dependency.component.ts
│  │  │  │      │  │  │  │      ├─ task-detail-progress.component.ts
│  │  │  │      │  │  │  │      ├─ task-detail-quality.component.ts
│  │  │  │      │  │  │  │      ├─ task-detail-resource.component.ts
│  │  │  │      │  │  │  │      ├─ task-detail-risk.component.ts
│  │  │  │      │  │  │  │      ├─ task-detail-safety.component.ts
│  │  │  │      │  │  │  │      └─ task-detail-time.component.ts
│  │  │  │      │  │  │  ├─ 📁 services/
│  │  │  │      │  │  │  │  └─ 📁 repository/
│  │  │  │      │  │  │  │      └─ task.repository.ts
│  │  │  │      │  │  │  └─ 📁 state/
│  │  │  │      │  │  ├─ 📁 task-discussion/     # 討論
│  │  │  │      │  │  ├─ 📁 task-document/       # 文件
│  │  │  │      │  │  ├─ 📁 task-form/           # 表單
│  │  │  │      │  │  ├─ 📁 task-gantt/          # 甘特圖
│  │  │  │      │  │  ├─ 📁 task-identity/       # 身份識別
│  │  │  │      │  │  ├─ 📁 task-issues/         # 問題
│  │  │  │      │  │  ├─ 📁 task-location/       # 位置/空間
│  │  │  │      │  │  ├─ 📁 task-overview/       # 概覽
│  │  │  │      │  │  ├─ 📁 task-progress/       # 進度
│  │  │  │      │  │  ├─ 📁 task-quality/        # 品質
│  │  │  │      │  │  ├─ 📁 task-report/         # 報表
│  │  │  │      │  │  ├─ 📁 task-resource/       # 資源
│  │  │  │      │  │  ├─ 📁 task-risk/           # 風險
│  │  │  │      │  │  ├─ 📁 task-role/           # 角色
│  │  │  │      │  │  ├─ 📁 task-safety/         # 安全
│  │  │  │      │  │  ├─ 📁 task-settings/       # 設定
│  │  │  │      │  │  ├─ 📁 task-time/           # 時間
│  │  │  │      │  │  └─ 📁 task-tree/           # 樹狀結構
│  │  │  │      │  └─ 📁 shared/                 # 任務共享層
│  │  │  │      │      ├─ 📁 assets/
│  │  │  │      │      ├─ 📁 components/
│  │  │  │      │      ├─ 📁 constants/
│  │  │  │      │      ├─ 📁 directives/
│  │  │  │      │      ├─ 📁 domain/             # 領域模型
│  │  │  │      │      │  ├─ change.domain.ts
│  │  │  │      │      │  ├─ issues.domain.ts
│  │  │  │      │      │  ├─ location.domain.ts
│  │  │  │      │      │  ├─ progress.domain.ts
│  │  │  │      │      │  ├─ safety.domain.ts
│  │  │  │      │      │  ├─ task-data-capture.service.ts
│  │  │  │      │      │  └─ 📁 __tests__/
│  │  │  │      │      ├─ 📁 forms/
│  │  │  │      │      ├─ 📁 mappers/
│  │  │  │      │      ├─ 📁 models/             # 任務模型
│  │  │  │      │      │  ├─ index.ts
│  │  │  │      │      │  ├─ README.md
│  │  │  │      │      │  ├─ 📁 change/
│  │  │  │      │      │  ├─ 📁 communication/
│  │  │  │      │      │  ├─ 📁 cost/
│  │  │  │      │      │  ├─ 📁 dependency/
│  │  │  │      │      │  ├─ 📁 document/
│  │  │  │      │      │  ├─ 📁 identity/
│  │  │  │      │      │  ├─ 📁 location/
│  │  │  │      │      │  ├─ 📁 progress/
│  │  │  │      │      │  ├─ 📁 quality/
│  │  │  │      │      │  ├─ 📁 resource/
│  │  │  │      │      │  ├─ 📁 risk/
│  │  │  │      │      │  ├─ 📁 safety/
│  │  │  │      │      │  ├─ 📁 time/
│  │  │  │      │      │  └─ 📁 tree/
│  │  │  │      │      ├─ 📁 pipes/
│  │  │  │      │      ├─ 📁 queries/
│  │  │  │      │      ├─ 📁 repository/         # Repository 層
│  │  │  │      │      │  ├─ README.md
│  │  │  │      │      │  ├─ task-change.repository.ts
│  │  │  │      │      │  ├─ task-communication.repository.ts
│  │  │  │      │      │  ├─ task-cost.repository.ts
│  │  │  │      │      │  ├─ task-document.repository.ts
│  │  │  │      │      │  ├─ task-event.repository.ts
│  │  │  │      │      │  ├─ task-facet.repository.ts
│  │  │  │      │      │  ├─ task-identity.repository.ts
│  │  │  │      │      │  ├─ task-location.repository.ts
│  │  │  │      │      │  ├─ task-progress.repository.ts
│  │  │  │      │      │  ├─ task-quality.repository.ts
│  │  │  │      │      │  ├─ task-risk.repository.ts
│  │  │  │      │      │  ├─ task-safety.repository.ts
│  │  │  │      │      │  └─ task-time.repository.ts
│  │  │  │      │      ├─ 📁 state/              # Facade 層
│  │  │  │      │      │  ├─ index.ts
│  │  │  │      │      │  ├─ README.md
│  │  │  │      │      │  ├─ task-change.facade.ts
│  │  │  │      │      │  ├─ task-command.facade.ts
│  │  │  │      │      │  ├─ task-detail.facade.ts
│  │  │  │      │      │  ├─ task-documents.facade.ts
│  │  │  │      │      │  ├─ task-documents.facade.spec.ts
│  │  │  │      │      │  ├─ task-issues.facade.ts
│  │  │  │      │      │  ├─ task-location.facade.ts
│  │  │  │      │      │  ├─ task-progress-board.facade.ts
│  │  │  │      │      │  ├─ task-progress.facade.ts
│  │  │  │      │      │  ├─ task-quality.facade.ts
│  │  │  │      │      │  ├─ task-report.facade.ts
│  │  │  │      │      │  └─ task-safety.facade.ts
│  │  │  │      │      └─ 📁 views/
│  │  │  │      └─ 📁 weather/           # 天氣標籤
│  │  │  │          ├─ weather.component.ts
│  │  │  │          ├─ weather.component.html
│  │  │  │          └─ weather.component.less
│  │  │  │
│  │  │  ├─ 📁 dashboard/                # 儀表板路由
│  │  │  │  ├─ routes.ts
│  │  │  │  ├─ 📁 analysis/              # 分析頁
│  │  │  │  ├─ 📁 monitor/               # 監控頁
│  │  │  │  ├─ 📁 v1/                    # 儀表板 v1
│  │  │  │  └─ 📁 workplace/             # 工作台
│  │  │  │
│  │  │  ├─ 📁 org/                      # 組織管理路由
│  │  │  │  ├─ AGENTS.md
│  │  │  │  ├─ routes.ts
│  │  │  │  ├─ organization.routes.ts
│  │  │  │  ├─ 📁 components/            # 組織組件
│  │  │  │  │  ├─ index.ts
│  │  │  │  │  ├─ create-organization-modal.component.ts
│  │  │  │  │  ├─ create-team-modal.component.ts
│  │  │  │  │  └─ organization-switcher.component.ts
│  │  │  │  ├─ 📁 members/               # 成員管理
│  │  │  │  ├─ 📁 overview/              # 組織概覽
│  │  │  │  ├─ 📁 settings/              # 組織設定
│  │  │  │  │  ├─ general.routes.ts
│  │  │  │  │  ├─ members.routes.ts
│  │  │  │  │  ├─ teams.routes.ts
│  │  │  │  │  ├─ settings.component.ts
│  │  │  │  │  ├─ settings.component.html
│  │  │  │  │  ├─ settings.component.less
│  │  │  │  │  ├─ 📁 general/
│  │  │  │  │  ├─ 📁 members/
│  │  │  │  │  └─ 📁 teams/
│  │  │  │  └─ 📁 teams/                 # 團隊管理
│  │  │  │
│  │  │  ├─ 📁 passport/                 # 認證路由
│  │  │  │  ├─ routes.ts
│  │  │  │  ├─ callback.component.ts     # OAuth 回調
│  │  │  │  ├─ 📁 login/                 # 登入頁
│  │  │  │  ├─ 📁 register/              # 註冊頁
│  │  │  │  ├─ 📁 register-result/       # 註冊結果
│  │  │  │  └─ 📁 lock/                  # 鎖定頁
│  │  │  │
│  │  │  └─ 📁 [其他路由模組]/           # 其他功能路由
│  │  │      ├─ data-v/                  # 數據視覺化
│  │  │      ├─ delon/                   # ng-alain 範例
│  │  │      ├─ exception/               # 異常頁
│  │  │      ├─ extras/                  # 擴展功能
│  │  │      ├─ pro/                     # Pro 功能
│  │  │      ├─ style/                   # 樣式展示
│  │  │      └─ widgets/                 # 小工具
│  │  │
│  │  └─ 📁 shared/                      # 🧰 共享層（Shared Layer）
│  │      │
│  │      ├─ 📄 共享配置
│  │      │  ├─ AGENTS.md                # 共享層 AI 指引
│  │      │  ├─ README.md                # 共享層說明
│  │      │  ├─ index.ts                 # 共享層導出
│  │      │  ├─ shared-imports.ts        # ⭐ SHARED_IMPORTS（核心）
│  │      │  ├─ shared-delon.module.ts   # ng-alain 模組（過渡）
│  │      │  └─ shared-zorro.module.ts   # ng-zorro-antd 模組（過渡）
│  │      │
│  │      ├─ 📁 components/              # 共享組件
│  │      │  └─ 📁 error-display/        # 錯誤顯示組件
│  │      │      ├─ index.ts
│  │      │      └─ error-banner.component.ts
│  │      │
│  │      ├─ 📁 cell-widget/             # 單元格小工具
│  │      │  └─ index.ts
│  │      │
│  │      ├─ 📁 st-widget/               # ST 表格小工具
│  │      │  ├─ index.ts
│  │      │  └─ README.md
│  │      │
│  │      ├─ 📁 json-schema/             # JSON Schema 表單
│  │      │  ├─ index.ts
│  │      │  ├─ README.md
│  │      │  └─ 📁 test/
│  │      │      └─ test.widget.ts
│  │      │
│  │      ├─ 📁 models/                  # 共享模型
│  │      │  ├─ index.ts
│  │      │  ├─ blueprint.model.ts
│  │      │  ├─ blueprint-aggregation.model.ts
│  │      │  ├─ error.model.ts
│  │      │  ├─ organization.model.ts
│  │      │  ├─ organization-invitation.model.ts
│  │      │  ├─ team.model.ts
│  │      │  └─ user.model.ts
│  │      │
│  │      └─ 📁 utils/                   # 共享工具
│  │          ├─ location.ts
│  │          └─ yuan.ts
│  │
│  ├─ 📁 assets/                         # 靜態資源
│  │  ├─ .gitkeep
│  │  ├─ color.less                      # 顏色定義
│  │  ├─ logo-color.svg                  # Logo（彩色）
│  │  ├─ logo-full.svg                   # Logo（完整）
│  │  ├─ logo.svg                        # Logo（簡版）
│  │  ├─ zorro.svg                       # Zorro Logo
│  │  ├─ style.compact.css               # 緊湊樣式
│  │  ├─ style.dark.css                  # 深色主題
│  │  ├─ 📁 tmp/                         # 臨時/測試資源
│  │  │  ├─ app-data.json
│  │  │  ├─ demo.docx
│  │  │  ├─ demo.pdf
│  │  │  ├─ demo.pptx
│  │  │  ├─ demo.xlsx
│  │  │  ├─ demo.zip
│  │  │  ├─ menu-org.json
│  │  │  ├─ menu-team.json
│  │  │  ├─ menu-user.json
│  │  │  ├─ on-boarding.json
│  │  │  ├─ 📁 i18n/                     # 多語字串
│  │  │  │  ├─ en-US.json
│  │  │  │  ├─ zh-CN.json
│  │  │  │  └─ zh-TW.json
│  │  │  └─ 📁 img/                      # 測試圖片
│  │
│  ├─ 📁 environments/                   # 環境配置
│  │  ├─ environment.ts                  # 開發環境
│  │  └─ environment.prod.ts             # 生產環境
│  │
│  ├─ 📁 styles/                         # 全域樣式
│  │  ├─ index.less                      # 樣式入口
│  │  └─ theme.less                      # 主題定義
│  │
│  └─ 📁 testing/                        # 測試工具
│      └─ 📁 fixtures/                   # 測試固定資料
│          └─ blueprint-document.fixture.ts
│
├─ 📁 supabase/                          # 🗃️ Supabase 後端配置
│  │
│  ├─ 📄 後端配置
│  │  └─ config.toml                     # Supabase 配置
│  │
│  ├─ 📁 functions/                      # Edge Functions
│  │  └─ 📁 ai/                          # AI 函數
│  │      ├─ deno.json
│  │      └─ index.ts
│  │
│  ├─ 📁 migrations/                     # 資料庫遷移
│  │  └─ [timestamp]_[name].sql          # 遷移腳本
│  │
│  ├─ seed.sql                           # 種子資料
│  └─ roles.sql                          # 角色權限定義
│
├─ 📁 docs/                              # 📚 專案文檔
│  │
│  ├─ 📄 開發指引
│  │  ├─ 00-開發作業指引.md
│  │  ├─ 01-專案結構說明.md
│  │  ├─ 02-專案結構樹.md
│  │  ├─ 03-專案結構流程圖.mermaid.md
│  │  └─ 04-重構後結構樹.md              # 本文檔
│  │
│  ├─ 📄 架構圖（10-26）
│  │  ├─ 10-系統架構思維導圖.mermaid.md
│  │  ├─ 11-Supabase架構流程圖.mermaid.md
│  │  ├─ 12-實體關係圖.mermaid.md
│  │  ├─ 13-帳戶層流程圖.mermaid.md
│  │  ├─ 14-業務流程圖.mermaid.md
│  │  ├─ 15-序列圖.mermaid.md
│  │  ├─ 16-狀態圖.mermaid.md
│  │  ├─ 17-系統上下文圖.mermaid.md
│  │  ├─ 18-容器圖.mermaid.md
│  │  ├─ 19-元件模組視圖.mermaid.md
│  │  ├─ 20-部署基礎設施視圖.mermaid.md
│  │  ├─ 21-安全與-RLS-權限矩陣.md
│  │  ├─ 22-資料生命週期-ETL-流程圖.mermaid.md
│  │  ├─ 23-可觀測性與CI-CD管道圖.mermaid.md
│  │  ├─ 24-領域事件時間軸圖.mermaid.md
│  │  ├─ 25-API-介面映射圖.mermaid.md
│  │  └─ 26-Storage-Bucket結構視圖.mermaid.md
│  │
│  ├─ 📄 資料與API文檔（30-34）
│  │  ├─ 30-資料表清單總覽.md
│  │  ├─ 33-API-接口詳細文檔.md
│  │  └─ 34-資料模型對照表.md
│  │
│  ├─ 📄 開發指南（31-32、35-42）
│  │  ├─ 31-開發前檢查清單.md
│  │  ├─ 32-快速開始指南.md
│  │  ├─ 35-開發工作流程.md
│  │  ├─ 36-常見問題-FAQ.md
│  │  ├─ 37-錯誤處理指南.md
│  │  ├─ 38-測試指南.md
│  │  ├─ 39-部署指南.md
│  │  ├─ 40-效能優化指南.md
│  │  ├─ 41-安全檢查清單.md
│  │  └─ 42-詞彙表.md
│  │
│  └─ 文件編號規劃.md
│
├─ 📁 e2e/                               # 🧭 端對端測試
│  ├─ protractor.conf.js
│  ├─ tsconfig.json
│  └─ 📁 src/
│      ├─ app.e2e-spec.ts
│      └─ app.po.ts
│
├─ 📁 _mock/                             # 🎯 本地開發模擬
│  ├─ index.ts
│  ├─ README.md
│  ├─ _api.ts
│  ├─ _chart.ts
│  ├─ _geo.ts
│  ├─ _pois.ts
│  ├─ _profile.ts
│  ├─ _rule.ts
│  └─ _user.ts
│
├─ 📁 scripts/                           # 🔁 腳本工具
│  └─ 📁 _ci/
│      ├─ README.md
│      ├─ delon.sh
│      ├─ deploy-pipelines.sh
│      ├─ fix-day.js
│      └─ github-comment.js
│
├─ 📁 custom_modes/                      # 🤖 AI Agent 模式
│  ├─ creative_instructions.md
│  ├─ implement_instructions.md
│  ├─ mode_switching_analysis.md
│  ├─ plan_instructions.md
│  └─ van_instructions.md
│
├─ 📁 graph-bank/                        # 🧭 知識圖譜
│  ├─ activeContext.md
│  ├─ productContext.md
│  ├─ progress.md
│  ├─ projectbrief.md
│  ├─ systemPatterns.md
│  └─ techContext.md
│
└─ 📁 public/                            # 🌐 公開靜態資源
    └─ favicon.ico
```

## 架構設計原則

### 1. 分層架構（嚴格依賴方向）

```
routes (UI Layer)
  ↓ 依賴
shared (Shared Layer)
  ↓ 依賴
core (Core Layer)
  ↓ 依賴
supabase (Infrastructure)
```

**禁止事項**：
- ❌ routes 直接依賴 core（除必要服務外）
- ❌ shared 直接依賴 routes
- ❌ routes 直接呼叫 Supabase / Infrastructure

### 2. Standalone Components 架構

- ✅ 所有組件使用 `standalone: true`
- ✅ 使用 `SHARED_IMPORTS` 統一導入
- ✅ 使用 `ChangeDetectionStrategy.OnPush`
- ✅ 使用 `inject()` 進行依賴注入

### 3. Repository → Service → Facade → Component 模式

```
Component (Routes)
  ↓ 使用
Facade (ReadonlySignal)
  ↓ 呼叫
Service (業務邏輯)
  ↓ 呼叫
Repository (資料存取)
  ↓ 使用
SupabaseService (Infrastructure)
```

### 4. 13 維度任務管理結構

任務模組包含以下 13 個維度：
1. **Identity** - 身份識別
2. **Time** - 時間管理
3. **Dependency** - 依賴關係
4. **Location** - 位置/空間
5. **Resource** - 資源管理
6. **Progress** - 進度追蹤
7. **Cost** - 成本管理
8. **Quality** - 品質控制
9. **Risk** - 風險管理
10. **Safety** - 安全管理
11. **Document** - 文件管理
12. **Communication** - 溝通協作
13. **Change** - 變更管理

### 5. Blueprint ↔ Task 分層架構

- **Blueprint 層**：專案聚合、KPI 展示、統計分析
- **Task 層**：資料採集、執行追蹤、狀態管理
- **Aggregation Refresh Pattern**：Task 變更自動觸發 Blueprint 聚合刷新

## 關鍵文件說明

### SHARED_IMPORTS（核心）

`src/app/shared/shared-imports.ts` 是整個專案的核心導入配置，包含：
- Angular 核心模組（CommonModule、FormsModule、HttpClientModule 等）
- ng-zorro-antd 組件
- @delon 工具模組
- 共享組件、指令、管道

**使用方式**：
```typescript
import { SHARED_IMPORTS } from '@shared/shared-imports';

@Component({
  standalone: true,
  imports: [SHARED_IMPORTS] // ✅ 統一導入
})
export class MyComponent {}
```

### Repository 層

位於 `routes/blueprint/tabs/tasks/shared/repository/`，負責：
- 封裝 Supabase 資料存取
- snake_case ↔ camelCase 映射
- 錯誤處理與重試邏輯
- 使用 `@SUPABASE` MCP 工具執行 SQL

### Facade 層

位於 `routes/blueprint/tabs/tasks/shared/state/`，負責：
- 暴露 `ReadonlySignal` 給組件
- 使用 `signal`/`computed`/`effect` 管理狀態
- 訂閱 Repository 資料變更
- 實現 Aggregation Refresh Pattern

### Service 層

位於 `core/`，負責：
- 業務邏輯處理
- 驗證規則
- 工作流程協調
- 活動記錄（Activity Log）

## 測試策略

- **單元測試**：每個 Service 至少 80% 覆蓋率，關鍵邏輯 100%
- **組件測試**：使用 Angular Testing Utilities
- **E2E 測試**：使用 Playwright 覆蓋關鍵用戶流程
- **測試文件位置**：
  - `.spec.ts` 與源文件同目錄
  - `testing/fixtures/` 存放測試固定資料

## 文檔維護

- **README.md**：每個模組需提供說明
- **AGENTS.md**：AI Agent 工作指引
- **架構決策**：記錄在 `docs/` 目錄
- **資料庫變更**：同步更新模型定義與文檔

## 開發規範

詳見 `docs/00-開發作業指引.md`，重點包括：
- 使用 `@SUPABASE` MCP 工具進行資料庫操作
- 禁止「權宜式/懶惰式」修改
- 禁止重複造輪
- 嚴格類型安全（TypeScript strict mode）
- 遵循 Angular 20 最佳實踐

---

> **最後更新**：2025-11  
> **維護原則**：若專案結構調整，請同步更新此文件以維持設計與實作對齊。

