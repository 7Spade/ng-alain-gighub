# éšæ®µ2ã€3å’Œæ•´åˆæ¸¬è©¦å¯¦æ–½è¨ˆåŠƒæŒ‡ä»¤

**ç‰ˆæœ¬**: 1.1  
**æœ€å¾Œæ›´æ–°**: 2025-11-16  
**æè¿°**: éšæ®µ2ï¼ˆä»»å‹™åŸ·è¡Œæµç¨‹èˆ‡æš«å­˜å€ï¼‰ã€éšæ®µ3ï¼ˆPRå¯©æ ¸èˆ‡å”ä½œç³»çµ±ï¼‰å’Œæ•´åˆæ¸¬è©¦çš„å®Œæ•´å¯¦æ–½æŒ‡å¼•ï¼ŒåŒ…å«è©³ç´°ä»»å‹™åˆ†è§£ã€æ¥å£å®šç¾©ã€é©—æ”¶æ¨™æº–å’Œå¯©æŸ¥ä¿®æ­£è¦é»

---

## ğŸ“š æ–‡æª”æ¸…å–®

### æ ¸å¿ƒåƒè€ƒæ–‡æª”

#### `docs/å¯¦æ–½è¨ˆåŠƒè©³ç´°èªªæ˜.md`
- **æè¿°**: å®Œæ•´çš„å¯¦æ–½è¨ˆåŠƒï¼ŒåŒ…å«æ‰€æœ‰ä»»å‹™çš„è©³ç´°èªªæ˜
- **é—œéµç« ç¯€**:
  - éšæ®µ2ï¼šä»»å‹™åŸ·è¡Œæµç¨‹èˆ‡æš«å­˜å€
  - éšæ®µ3ï¼šPRå¯©æ ¸èˆ‡å”ä½œç³»çµ±
  - æ•´åˆæ¸¬è©¦èˆ‡å„ªåŒ–

#### `docs/å¯¦æ–½è¨ˆåŠƒå¯©æŸ¥å ±å‘Š.md`
- **æè¿°**: ä¼æ¥­æ¨™æº–å¯©æŸ¥çµæœå’Œä¿®æ­£è¦é»
- **é—œéµç« ç¯€**:
  - éœ€è¦ä¿®æ­£çš„å•é¡Œ
  - ç¬¦åˆæ¨™æº–çš„éƒ¨åˆ†
  - å»ºè­°è£œå……çš„å…§å®¹

#### `docs/30-0-å®Œæ•´SQLè¡¨çµæ§‹å®šç¾©.md`
- **æè¿°**: è³‡æ–™åº«è¡¨çµæ§‹å®šç¾©ï¼ˆä»»å‹™ç›¸é—œè¡¨ï¼‰
- **é—œéµè¡¨**:
  - `task_staging`
  - `daily_reports`
  - `report_photos`
  - `pull_requests`
  - `notifications`
  - `personal_todos`

### è¼”åŠ©åƒè€ƒæ–‡æª”

- `docs/00-é–‹ç™¼ä½œæ¥­æŒ‡å¼•.md` - é–‹ç™¼è¦ç¯„èˆ‡æµç¨‹
- `docs/45-SHARED_IMPORTS-ä½¿ç”¨æŒ‡å—.md` - SHARED_IMPORTS ä½¿ç”¨è¦ç¯„
- `docs/37-éŒ¯èª¤è™•ç†æŒ‡å—.md` - éŒ¯èª¤è™•ç†è¦ç¯„
- `docs/38-æ¸¬è©¦æŒ‡å—.md` - æ¸¬è©¦è¦ç¯„èˆ‡è¦†è“‹ç‡è¦æ±‚

---

## ğŸ—ï¸ å¯¦æ–½éšæ®µ

### éšæ®µ2ï¼šä»»å‹™åŸ·è¡Œæµç¨‹èˆ‡æš«å­˜å€

**é ä¼°æ™‚é–“**: 9å¤©

#### ä»»å‹™ 2.1ï¼šTaskStagingServiceï¼ˆæš«å­˜å€æ¥­å‹™é‚è¼¯ï¼‰

- **è¤‡é›œåº¦**: 6
- **é ä¼°æ™‚é–“**: 2å¤©
- **æ–‡ä»¶ä½ç½®**:
  - Service: `src/app/shared/services/task/task-staging.service.ts`
  - Types: `src/app/shared/models/task/types.ts`
  - Repository: `src/app/core/infra/repositories/task-staging.repository.ts`

**ä¾è³´**:
- TaskStagingRepository (å·²å­˜åœ¨)
- TaskService (éœ€è¦æ“´å±•)
- AuthStateService
- AnalyticsService (æ³¨æ„ï¼šä¸æ˜¯ ActivityLogService)

**æ ¸å¿ƒæ–¹æ³•**:

##### `submitToStaging`
- **æè¿°**: æäº¤ä»»å‹™åˆ°æš«å­˜å€
- **é—œéµé»**:
  - è¨ˆç®— `expires_at = NOW() + 48 hours`
  - å‰µå»ºæš«å­˜è¨˜éŒ„
  - è§¸ç™¼æ´»å‹•è¨˜éŒ„ï¼ˆä½¿ç”¨ AnalyticsServiceï¼‰

##### `withdrawStaging`
- **æè¿°**: æ’¤å›æš«å­˜ï¼ˆ48å°æ™‚å…§ï¼‰
- **é—œéµé»**:
  - æª¢æŸ¥ `can_withdraw === true`
  - æª¢æŸ¥ `expires_at > NOW()`
  - æª¢æŸ¥ `confirmed_at === null`
  - è¨­ç½® `withdrawn_at = NOW()`

##### `confirmStaging`
- **æè¿°**: ç¢ºèªæš«å­˜ï¼ˆè½‰ç‚ºæ­£å¼è¨˜éŒ„ï¼‰
- **é—œéµé»**:
  - æª¢æŸ¥ `withdrawn_at === null`
  - è¨­ç½® `confirmed_at = NOW()`
  - è¨­ç½® `can_withdraw = false`

##### `loadStagingByTaskId`
- **æè¿°**: æ ¹æ“šä»»å‹™ ID åŠ è¼‰æš«å­˜è¨˜éŒ„

##### `loadWithdrawableStaging`
- **æè¿°**: åŠ è¼‰å¯æ’¤å›çš„æš«å­˜è¨˜éŒ„ï¼ˆç•¶å‰ç”¨æˆ¶ï¼‰

**Signals**:

**ç‹€æ…‹ Signals**:
- `stagingState: signal<TaskStaging[]>`
- `selectedStagingState: signal<TaskStaging | null>`
- `loadingState: signal<boolean>`
- `errorState: signal<string | null>`

**Computed Signals**:
- `withdrawableStaging`: å¯æ’¤å›çš„æš«å­˜è¨˜éŒ„
- `expiredStaging`: å·²éæœŸçš„æš«å­˜è¨˜éŒ„

**é©—æ”¶æ¨™æº–**:
- [ ] å¯ä»¥æäº¤ä»»å‹™åˆ°æš«å­˜å€
- [ ] 48å°æ™‚å…§å¯ä»¥æ’¤å›
- [ ] 48å°æ™‚å¾Œç„¡æ³•æ’¤å›
- [ ] å¯ä»¥ç¢ºèªæš«å­˜
- [ ] å·²æ’¤å›çš„æš«å­˜ç„¡æ³•ç¢ºèª
- [ ] å·²ç¢ºèªçš„æš«å­˜ç„¡æ³•æ’¤å›
- [ ] ç‹€æ…‹ç®¡ç†ä½¿ç”¨ Signals
- [ ] éŒ¯èª¤è™•ç†å®Œæ•´
- [ ] æ´»å‹•è¨˜éŒ„æ­£ç¢ºè§¸ç™¼ï¼ˆä½¿ç”¨ AnalyticsServiceï¼‰
- [ ] é€šé `yarn type-check`ï¼ˆç„¡é¡å‹éŒ¯èª¤ï¼‰
- [ ] é€šé `yarn lint`ï¼ˆç„¡ ESLint éŒ¯èª¤ï¼‰
- [ ] é€šé `yarn build`ï¼ˆç·¨è­¯æˆåŠŸï¼‰
- [ ] å–®å…ƒæ¸¬è©¦è¦†è“‹ç‡ â‰¥ 80%
- [ ] é—œéµæ¥­å‹™é‚è¼¯ 100% è¦†è“‹ï¼ˆ48å°æ™‚æ’¤å›æ©Ÿåˆ¶ï¼‰

**æ³¨æ„äº‹é …**:
- `expires_at` åœ¨æ•¸æ“šåº«å±¤é¢æœ‰é»˜èªå€¼ï¼Œä½†æ‡‰ç”¨å±¤éœ€è¦æ˜ç¢ºè¨­ç½®
- éœ€è¦è™•ç†æ™‚å€å•é¡Œ
- éœ€è¦è™•ç†ä¸¦ç™¼æ’¤å›çš„æƒ…æ³

---

#### ä»»å‹™ 2.2ï¼šæ“´å±• TaskServiceï¼ˆä»»å‹™ç‹€æ…‹æµè½‰ï¼‰

- **è¤‡é›œåº¦**: 5
- **é ä¼°æ™‚é–“**: 1.5å¤©
- **æ–‡ä»¶ä½ç½®**: `src/app/shared/services/task/task.service.ts` (æ“´å±•ç¾æœ‰æ–‡ä»¶)

**ä¾è³´**:
- TaskStagingService (æ–°å¢ä¾è³´)
- AnalyticsService (æ³¨æ„ï¼šä¸æ˜¯ ActivityLogService)
- TaskRepository (å·²å­˜åœ¨)

**æ–°å¢æ–¹æ³•**:

##### `submitTaskToStaging`
- **æè¿°**: æäº¤ä»»å‹™åˆ°æš«å­˜å€ï¼ˆæ•´åˆ TaskStagingServiceï¼‰
- **é—œéµé»**:
  - èª¿ç”¨ `TaskStagingService.submitToStaging`
  - æ›´æ–°ä»»å‹™ç‹€æ…‹ç‚º `TaskStatus.STAGING`
  - è§¸ç™¼æ´»å‹•è¨˜éŒ„

##### `confirmTaskStaging`
- **æè¿°**: ç¢ºèªä»»å‹™æš«å­˜ï¼ˆè½‰ç‚ºæ­£å¼è¨˜éŒ„ï¼‰
- **é—œéµé»**:
  - èª¿ç”¨ `TaskStagingService.confirmStaging`
  - æ›´æ–°ä»»å‹™ç‹€æ…‹ç‚º `TaskStatus.COMPLETED`
  - è§¸ç™¼æ´»å‹•è¨˜éŒ„

##### `withdrawTaskStaging`
- **æè¿°**: æ’¤å›ä»»å‹™æš«å­˜
- **é—œéµé»**:
  - èª¿ç”¨ `TaskStagingService.withdrawStaging`
  - æ›´æ–°ä»»å‹™ç‹€æ…‹ç‚º `TaskStatus.IN_PROGRESS`ï¼ˆæ¢å¾©åˆ°é€²è¡Œä¸­ï¼‰
  - è§¸ç™¼æ´»å‹•è¨˜éŒ„

##### `updateTaskContractorFields`
- **æè¿°**: æ›´æ–°ä»»å‹™æ‰¿æ”¬æ¬„ä½ï¼ˆç”¨æ–¼ PR åˆä½µï¼‰
- **é—œéµé»**:
  - åˆä½µç¾æœ‰çš„ `contractor_fields`
  - æ›´æ–°ä»»å‹™è¨˜éŒ„
  - è§¸ç™¼æ´»å‹•è¨˜éŒ„
- **å‚™è¨»**: æ­¤æ–¹æ³•éœ€è¦åœ¨ 2.2 ä¸­å¯¦ç¾ï¼Œä¾› 3.1 PR åˆä½µä½¿ç”¨

##### `updateTaskStatus` (private)
- **æè¿°**: æ›´æ–°ä»»å‹™ç‹€æ…‹ï¼ˆå…§éƒ¨æ–¹æ³•ï¼Œçµ±ä¸€ç‹€æ…‹è®Šæ›´é‚è¼¯ï¼‰
- **é—œéµé»**:
  - é©—è­‰ç‹€æ…‹è½‰æ›æ˜¯å¦åˆæ³•
  - æ›´æ–°ä»»å‹™ç‹€æ…‹
  - è§¸ç™¼æ´»å‹•è¨˜éŒ„ï¼ˆåŒ…å« reasonï¼‰

**ç‹€æ…‹æµè½‰**:

**æ­£å¸¸æµç¨‹**: `pending â†’ assigned â†’ in_progress â†’ staging â†’ completed`

**æ’¤å›æµç¨‹**: `staging â†’ in_progress` (æ’¤å›)

**å‚™è¨»**: ç‹€æ…‹è½‰æ›éœ€è¦é©—è­‰åˆæ³•æ€§

**é©—æ”¶æ¨™æº–**:
- [ ] ä»»å‹™ç‹€æ…‹å¯ä»¥æ­£ç¢ºæµè½‰
- [ ] ç‹€æ…‹è½‰æ›é©—è­‰æ­£ç¢º
- [ ] èˆ‡ TaskStagingService æ•´åˆç„¡èª¤
- [ ] æ´»å‹•è¨˜éŒ„æ­£ç¢ºè§¸ç™¼ï¼ˆä½¿ç”¨ AnalyticsServiceï¼‰
- [ ] éŒ¯èª¤è™•ç†å®Œæ•´
- [ ] æ·»åŠ  `updateTaskContractorFields` æ–¹æ³•ï¼ˆç”¨æ–¼ PR åˆä½µï¼‰
- [ ] é€šé `yarn type-check`ã€`yarn lint`ã€`yarn build`
- [ ] å–®å…ƒæ¸¬è©¦è¦†è“‹ç‡ â‰¥ 80%

---

#### ä»»å‹™ 2.3ï¼šDailyReportServiceï¼ˆæ–½å·¥æ—¥èªŒï¼‰

- **è¤‡é›œåº¦**: 6
- **é ä¼°æ™‚é–“**: 2å¤©
- **æ–‡ä»¶ä½ç½®**:
  - Service: `src/app/shared/services/task/daily-report.service.ts` (æ–°å»º)
  - Repositories:
    - `src/app/core/infra/repositories/daily-report.repository.ts` (å·²å­˜åœ¨)
    - `src/app/core/infra/repositories/report-photo.repository.ts` (éœ€è¦æª¢æŸ¥)
    - `src/app/core/infra/repositories/weather-cache.repository.ts` (å·²å­˜åœ¨)

**ä¾è³´**:
- DailyReportRepository (å·²å­˜åœ¨)
- ReportPhotoRepository (éœ€è¦æª¢æŸ¥)
- WeatherCacheRepository (å·²å­˜åœ¨)
- SupabaseAdapterService (ä¸Šå‚³ç…§ç‰‡ï¼Œæ³¨æ„ï¼šä¸æ˜¯ DocumentService)
- BranchContextService (ç²å–ç•¶å‰åˆ†æ”¯)
- AnalyticsService (æ³¨æ„ï¼šä¸æ˜¯ ActivityLogService)

**æ ¸å¿ƒæ–¹æ³•**:

##### `createDailyReport`
- **æè¿°**: å‰µå»ºæ¯æ—¥æ–½å·¥æ—¥èªŒ
- **é—œéµé»**:
  - ç²å–ç•¶å‰åˆ†æ”¯ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
  - ç²å–å¤©æ°£è³‡è¨Šï¼ˆå¦‚æœæä¾› locationï¼‰
  - å‰µå»º `daily_report` è¨˜éŒ„
  - å¦‚æœ `branch_id` å­˜åœ¨ï¼ŒåŒæ­¥å‰µå»ºä¸»åˆ†æ”¯è¨˜éŒ„ï¼ˆ`branch_id = null`ï¼‰
  - ä¸Šå‚³ç…§ç‰‡åˆ° Storageï¼ˆä½¿ç”¨ SupabaseAdapterServiceï¼‰
  - å‰µå»º `report_photos` è¨˜éŒ„
  - è§¸ç™¼æ´»å‹•è¨˜éŒ„

**ç…§ç‰‡ä¸Šå‚³**:
- **æœå‹™**: SupabaseAdapterService
- **è·¯å¾‘**: `images/daily-reports/{reportId}/{fileName}`
- **Bucket**: `images`

##### `syncToMainBranch` (private)
- **æè¿°**: åŒæ­¥æ–½å·¥æ—¥èªŒåˆ°ä¸»åˆ†æ”¯ï¼ˆå…§éƒ¨æ–¹æ³•ï¼‰
- **é—œéµé»**:
  - æª¢æŸ¥ `report.branch_id` æ˜¯å¦å­˜åœ¨
  - å‰µå»ºä¸»åˆ†æ”¯è¨˜éŒ„ï¼ˆ`branch_id = null`ï¼Œå…¶ä»–å­—æ®µç›¸åŒï¼‰
  - åŒæ­¥ç…§ç‰‡è¨˜éŒ„
  - è§¸ç™¼æ´»å‹•è¨˜éŒ„

##### `getWeatherInfo` (private)
- **æè¿°**: ç²å–å¤©æ°£è³‡è¨Šï¼ˆå¾å¿«å–æˆ– APIï¼‰
- **é—œéµé»**:
  - æª¢æŸ¥ WeatherCache æ˜¯å¦æœ‰å¿«å–
  - å¦‚æœæœ‰ä¸”æœªéæœŸï¼Œè¿”å›å¿«å–
  - å¦‚æœæ²’æœ‰æˆ–å·²éæœŸï¼Œèª¿ç”¨å¤©æ°£ APIï¼ˆEdge Functionï¼‰
  - ä¿å­˜åˆ° WeatherCache

##### `uploadReportPhotos` (private)
- **æè¿°**: ä¸Šå‚³æ–½å·¥ç…§ç‰‡
- **é—œéµé»**:
  - ä¸Šå‚³ç…§ç‰‡åˆ° Supabase Storage
  - å‰µå»º `documents` è¨˜éŒ„ï¼ˆå¦‚æœéœ€è¦çµ±ä¸€æ–‡ä»¶ç®¡ç†ï¼‰
  - å‰µå»º `report_photos` è¨˜éŒ„

##### `loadReportsByTaskId`
- **æè¿°**: æ ¹æ“šä»»å‹™ ID åŠ è¼‰æ–½å·¥æ—¥èªŒåˆ—è¡¨
- **é—œéµé»**:
  - èª¿ç”¨ `Repository.findByTaskId`
  - åŠ è¼‰é—œè¯çš„ç…§ç‰‡
  - æ›´æ–°æœ¬åœ°ç‹€æ…‹

**é¡å‹å®šç¾©**:

##### `DailyReportDetail`
- **ä½ç½®**: `src/app/shared/models/task/types.ts`
- **æè¿°**: DailyReport è©³æƒ…ï¼ˆåŒ…å«é—œè¯è³‡æ–™ï¼‰
- **å­—æ®µ**:
  - `extends DailyReport`
  - `photos?: ReportPhoto[]`
  - `reporter?: { id, name, email }`
  - `task?: { id, title }`

**é©—æ”¶æ¨™æº–**:
- [ ] å¯ä»¥å‰µå»ºæ–½å·¥æ—¥èªŒ
- [ ] åˆ†æ”¯æ–½å·¥æ—¥èªŒè‡ªå‹•åŒæ­¥åˆ°ä¸»åˆ†æ”¯ï¼ˆ`branch_id = null` çš„è¨˜éŒ„ï¼‰
- [ ] å¤©æ°£è³‡è¨Šæ­£ç¢ºç²å–å’Œå¿«å–ï¼ˆä½¿ç”¨ WeatherCacheï¼‰
- [ ] ç…§ç‰‡æ­£ç¢ºä¸Šå‚³åˆ° Storage ä¸¦å‰µå»º `report_photos` è¨˜éŒ„ï¼ˆä½¿ç”¨ SupabaseAdapterServiceï¼‰
- [ ] æŸ¥è©¢åŠŸèƒ½æ­£å¸¸ï¼ˆæŒ‰ä»»å‹™ã€æ—¥æœŸã€åˆ†æ”¯æŸ¥è©¢ï¼‰
- [ ] ç‹€æ…‹ç®¡ç†ä½¿ç”¨ Signals
- [ ] éŒ¯èª¤è™•ç†å®Œæ•´
- [ ] æ´»å‹•è¨˜éŒ„æ­£ç¢ºè§¸ç™¼ï¼ˆä½¿ç”¨ AnalyticsServiceï¼‰
- [ ] é€šé `yarn type-check`ã€`yarn lint`ã€`yarn build`
- [ ] å–®å…ƒæ¸¬è©¦è¦†è“‹ç‡ â‰¥ 80%

**æ³¨æ„äº‹é …**:
- æ–½å·¥æ—¥èªŒåŒæ­¥åˆ°ä¸»åˆ†æ”¯æ™‚ï¼Œéœ€è¦ä¿æŒæ•¸æ“šä¸€è‡´æ€§
- å¤©æ°£ API èª¿ç”¨éœ€è¦è™•ç†å¤±æ•—æƒ…æ³ï¼ˆä½¿ç”¨å¿«å–ä½œç‚ºå‚™é¸ï¼‰
- ç…§ç‰‡ä¸Šå‚³éœ€è¦è™•ç†å¤§æ–‡ä»¶å’Œä¸Šå‚³å¤±æ•—çš„æƒ…æ³

---

#### ä»»å‹™ 2.4ï¼šæ•´åˆæš«å­˜å€èˆ‡æ–½å·¥æ—¥èªŒ

- **è¤‡é›œåº¦**: 5
- **é ä¼°æ™‚é–“**: 1.5å¤©
- **æ–‡ä»¶ä½ç½®**:
  - `src/app/shared/services/task/task-staging.service.ts` (æ“´å±•)
  - `src/app/shared/services/task/daily-report.service.ts` (æ“´å±•)

**æ•´åˆé‚è¼¯**:

##### `confirmStaging`
- **ä½ç½®**: åœ¨ `TaskStagingService.confirmStaging` ä¸­
- **å‹•ä½œ**: å¦‚æœ `staging_data` åŒ…å«æ–½å·¥æ—¥èªŒè³‡è¨Šï¼Œå‰µå»ºæ–½å·¥æ—¥èªŒ
- **æ–¹æ³•**: `dailyReportService.createDailyReportFromStaging`

##### `withdrawStaging`
- **ä½ç½®**: åœ¨ `TaskStagingService.withdrawStaging` ä¸­
- **å‹•ä½œ**: å¦‚æœå·²å‰µå»ºæ–½å·¥æ—¥èªŒï¼Œéœ€è¦æ¸…ç†ï¼ˆæ¨™è¨˜ç‚ºæ’¤å›ç›¸é—œï¼‰
- **å‚™è¨»**: ä¸ç›´æ¥åˆªé™¤ï¼Œè€Œæ˜¯æ¨™è¨˜é—œè¯é—œä¿‚

**é©—æ”¶æ¨™æº–**:
- [ ] æš«å­˜ç¢ºèªæ™‚è‡ªå‹•å‰µå»ºæ–½å·¥æ—¥èªŒ
- [ ] æš«å­˜æ’¤å›æ™‚æ­£ç¢ºè™•ç†ç›¸é—œæ–½å·¥æ—¥èªŒ
- [ ] æ•¸æ“šä¸€è‡´æ€§æª¢æŸ¥é€šé
- [ ] éŒ¯èª¤è™•ç†å®Œæ•´

---

#### ä»»å‹™ 2.5ï¼šæš«å­˜å€ UI çµ„ä»¶

- **è¤‡é›œåº¦**: 6
- **é ä¼°æ™‚é–“**: 2å¤©
- **æ–‡ä»¶ä½ç½®**:
  - `src/app/routes/tasks/staging/task-staging-list.component.ts`
  - `src/app/routes/tasks/staging/detail/task-staging-detail.component.ts`
  - `src/app/routes/tasks/staging/form/task-staging-form.component.ts`

**çµ„ä»¶**:

##### TaskStagingListComponent
- **åŠŸèƒ½**:
  - é¡¯ç¤ºç•¶å‰ç”¨æˆ¶çš„æš«å­˜è¨˜éŒ„åˆ—è¡¨
  - é¡¯ç¤ºå¯æ’¤å›ç‹€æ…‹ï¼ˆ48å°æ™‚å€’è¨ˆæ™‚ï¼‰
  - é¡¯ç¤ºå·²éæœŸç‹€æ…‹
  - æ”¯æŒç¯©é¸ï¼ˆå¯æ’¤å›ã€å·²ç¢ºèªã€å·²æ’¤å›ã€å·²éæœŸï¼‰
  - æ”¯æŒæ“ä½œï¼ˆæŸ¥çœ‹ã€æ’¤å›ã€ç¢ºèªï¼‰

**è¡¨æ ¼æ¬„ä½**:
- ä»»å‹™åç¨±
- æäº¤æ™‚é–“
- éæœŸæ™‚é–“
- ç‹€æ…‹ï¼ˆå¯æ’¤å›/å·²ç¢ºèª/å·²æ’¤å›/å·²éæœŸï¼‰
- å€’è¨ˆæ™‚ï¼ˆ48å°æ™‚ï¼‰
- æ“ä½œæŒ‰éˆ•

##### TaskStagingDetailComponent
- **åŠŸèƒ½**:
  - é¡¯ç¤ºæš«å­˜è©³æƒ…
  - é¡¯ç¤º `staging_data` å…§å®¹
  - é¡¯ç¤ºç…§ç‰‡
  - é¡¯ç¤º notes
  - æ”¯æŒæ’¤å›ï¼ˆå¦‚æœå¯æ’¤å›ï¼‰
  - æ”¯æŒç¢ºèªï¼ˆå¦‚æœæœªç¢ºèªä¸”æœªæ’¤å›ï¼‰
  - é¡¯ç¤º48å°æ™‚å€’è¨ˆæ™‚

##### TaskStagingFormComponent
- **åŠŸèƒ½**:
  - è¡¨å–®æäº¤ä»»å‹™åˆ°æš«å­˜å€
  - è¼¸å…¥ `staging_data`ï¼ˆJSON ç·¨è¼¯å™¨æˆ–çµæ§‹åŒ–è¡¨å–®ï¼‰
  - ä¸Šå‚³ç…§ç‰‡
  - è¼¸å…¥ notes
  - è¡¨å–®é©—è­‰
  - æäº¤åˆ° TaskStagingService
- **è¡¨å–®é¡å‹**: Typed Forms

**è¦æ±‚**:
- **Imports**: SHARED_IMPORTS (å¿…é ˆä½¿ç”¨ï¼Œç¦æ­¢é›¶ç¢å°å…¥)
- **Change Detection**: ChangeDetectionStrategy.OnPush (å¿…é ˆä½¿ç”¨)
- **Forms**: Typed Forms (è¡¨å–®çµ„ä»¶å¿…é ˆä½¿ç”¨)

**é©—æ”¶æ¨™æº–**:
- [ ] åˆ—è¡¨é¡¯ç¤ºæ­£ç¢º
- [ ] å€’è¨ˆæ™‚åŠŸèƒ½æ­£å¸¸
- [ ] æ’¤å›åŠŸèƒ½æ­£å¸¸
- [ ] ç¢ºèªåŠŸèƒ½æ­£å¸¸
- [ ] è¡¨å–®é©—è­‰æ­£ç¢ºï¼ˆä½¿ç”¨ Typed Formsï¼‰
- [ ] ç…§ç‰‡ä¸Šå‚³æ­£å¸¸
- [ ] éŸ¿æ‡‰å¼è¨­è¨ˆ
- [ ] ä½¿ç”¨ SHARED_IMPORTSï¼ˆç¦æ­¢é›¶ç¢å°å…¥ï¼‰
- [ ] ä½¿ç”¨ OnPush è®Šæ›´æª¢æ¸¬ç­–ç•¥
- [ ] é€šé `yarn type-check`ã€`yarn lint`ã€`yarn build`
- [ ] å–®å…ƒæ¸¬è©¦è¦†è“‹ç‡ â‰¥ 60%ï¼ˆComponentï¼‰

---

### éšæ®µ3ï¼šPRå¯©æ ¸èˆ‡å”ä½œç³»çµ±

**é ä¼°æ™‚é–“**: 8.5å¤©

#### ä»»å‹™ 3.1ï¼šå®Œå–„ PR å¯©æ ¸æµç¨‹

- **è¤‡é›œåº¦**: 7
- **é ä¼°æ™‚é–“**: 2.5å¤©
- **æ–‡ä»¶ä½ç½®**: `src/app/shared/services/blueprint/pull-request.service.ts` (æ“´å±•ç¾æœ‰æ–‡ä»¶)

**ä¾è³´**:
- PullRequestRepository (å·²å­˜åœ¨)
- BranchPermissionService (æ¬Šé™æª¢æŸ¥)
- TaskService (åˆä½µæ™‚æ›´æ–°ä»»å‹™ï¼Œéœ€è¦ `updateTaskContractorFields` æ–¹æ³•)
- AnalyticsService (æ³¨æ„ï¼šä¸æ˜¯ ActivityLogService)
- NotificationService (ç™¼é€é€šçŸ¥ï¼Œéœ€è¦æ–°å»º)

**æ–°å¢æ–¹æ³•**:

##### `reviewPR`
- **æè¿°**: å¯©æ ¸ PRï¼ˆæ‰¹å‡†æˆ–æ‹’çµ•ï¼‰
- **é—œéµé»**:
  - æª¢æŸ¥æ¬Šé™ï¼ˆ`BranchPermissionService.canReviewPR`ï¼‰
  - æª¢æŸ¥ PR ç‹€æ…‹å¿…é ˆç‚º `OPEN` æˆ– `REVIEWING`
  - æ›´æ–° PR ç‹€æ…‹
  - å‰µå»ºå¯©æ ¸è¨˜éŒ„ï¼ˆå¦‚æœæœ‰çš„è©±ï¼‰
  - è§¸ç™¼é€šçŸ¥ï¼ˆé€šçŸ¥æäº¤è€…ï¼‰
  - è§¸ç™¼æ´»å‹•è¨˜éŒ„

##### `mergePR`
- **æè¿°**: åˆä½µ PRï¼ˆå°‡åˆ†æ”¯æ•¸æ“šåˆä½µåˆ°ä¸»åˆ†æ”¯ï¼‰
- **é—œéµé»**:
  - æª¢æŸ¥ PR ç‹€æ…‹å¿…é ˆç‚º `APPROVED`
  - æª¢æŸ¥æ¬Šé™ï¼ˆåªæœ‰ OWNER æˆ– ADMIN å¯ä»¥åˆä½µï¼‰
  - å¾ PR çš„ `changes_summary` JSONB å­—æ®µä¸­æå–è®Šæ›´æ•¸æ“š
  - åˆä½µåˆ°ä¸»åˆ†æ”¯çš„ `tasks` è¡¨ï¼šæ›´æ–° `tasks.contractor_fields`
  - åŒæ­¥ç›¸é—œæ•¸æ“šï¼š`daily_reports`ã€`quality_checks`
  - æ›´æ–° PR ç‹€æ…‹ç‚º `MERGED`
  - è§¸ç™¼é€šçŸ¥å’Œæ´»å‹•è¨˜éŒ„

**åˆä½µé‚è¼¯**:
- **tasks**: æ›´æ–° `tasks.contractor_fields`ï¼ˆä½¿ç”¨ `TaskService.updateTaskContractorFields`ï¼‰
- **dailyReports**: åŒæ­¥ `daily_reports`ï¼ˆå‰µå»ºä¸»åˆ†æ”¯è¨˜éŒ„ï¼‰
- **qualityChecks**: åŒæ­¥ `quality_checks`

**å‚™è¨»**: PR è¡¨ä½¿ç”¨ `changes_summary` å­—æ®µå­˜å„²è®Šæ›´æ‘˜è¦

##### `closePR`
- **æè¿°**: é—œé–‰ PR
- **é—œéµé»**:
  - æª¢æŸ¥æ¬Šé™ï¼ˆOWNERã€ADMIN æˆ–æäº¤è€…å¯ä»¥é—œé–‰ï¼‰
  - æ›´æ–° PR ç‹€æ…‹ç‚º `CLOSED`
  - **é‡è¦**: PR è¡¨æ²’æœ‰ `closed_at` å’Œ `closed_by` å­—æ®µ
  - ä½¿ç”¨ `reviewed_at` å’Œ `reviewed_by` è¨˜éŒ„é—œé–‰ä¿¡æ¯
  - è§¸ç™¼é€šçŸ¥
  - è§¸ç™¼æ´»å‹•è¨˜éŒ„

**é‡è¦å‚™è¨»**: PR è¡¨æ²’æœ‰ `closed_at` å’Œ `closed_by` å­—æ®µï¼Œä½¿ç”¨ `reviewed_at` å’Œ `reviewed_by` è¨˜éŒ„é—œé–‰ä¿¡æ¯

**é©—æ”¶æ¨™æº–**:
- [ ] æ¬Šé™æª¢æŸ¥æ­£ç¢ºï¼ˆä½¿ç”¨ BranchPermissionServiceï¼‰
- [ ] PR å¯©æ ¸æµç¨‹æ­£ç¢º
- [ ] PR åˆä½µé‚è¼¯æ­£ç¢ºï¼ˆæ›´æ–° `tasks.contractor_fields`ï¼‰
- [ ] æ•¸æ“šåˆä½µç„¡èª¤ï¼ˆtasksã€daily_reportsã€quality_checksï¼‰
- [ ] é€šçŸ¥æ­£ç¢ºç™¼é€ï¼ˆä½¿ç”¨ NotificationServiceï¼‰
- [ ] æ´»å‹•è¨˜éŒ„æ­£ç¢ºè§¸ç™¼ï¼ˆä½¿ç”¨ AnalyticsServiceï¼‰
- [ ] PR é—œé–‰é‚è¼¯æ­£ç¢ºï¼ˆæ³¨æ„ï¼šPR è¡¨æ²’æœ‰ `closed_at`/`closed_by` å­—æ®µï¼‰
- [ ] é€šé `yarn type-check`ã€`yarn lint`ã€`yarn build`
- [ ] å–®å…ƒæ¸¬è©¦è¦†è“‹ç‡ â‰¥ 80%
- [ ] é—œéµæ¥­å‹™é‚è¼¯ 100% è¦†è“‹ï¼ˆPR åˆä½µé‚è¼¯ï¼‰

---

#### ä»»å‹™ 3.2ï¼šRealtime é€šçŸ¥ç³»çµ±

- **è¤‡é›œåº¦**: 7
- **é ä¼°æ™‚é–“**: 2.5å¤©
- **æ–‡ä»¶ä½ç½®**:
  - Service: `src/app/shared/services/notification/notification.service.ts` (æ–°å»º)
  - Component: `src/app/shared/components/notification-center/notification-center.component.ts` (æ–°å»º)
  - Repository: `src/app/core/infra/repositories/notification.repository.ts` (å·²å­˜åœ¨)

**ä¾è³´**:
- NotificationRepository (å·²å­˜åœ¨)
- SupabaseAdapterService (Realtime è¨‚é–±ï¼Œæ³¨æ„ï¼šä¸æ˜¯ SupabaseService)
- AuthStateService (ç²å–ç•¶å‰ç”¨æˆ¶)

**æ ¸å¿ƒæ–¹æ³•**:

##### `createNotification`
- **æè¿°**: å‰µå»ºé€šçŸ¥
- **é€šçŸ¥é¡å‹**:
  - `task_assigned`
  - `task_submitted`
  - `task_approved`
  - `task_rejected`
  - `issue_created`
  - `issue_assigned`
  - `issue_resolved`
  - `pr_created`
  - `pr_reviewed`
  - `pr_merged`
  - `pr_closed`
  - `comment_mention`
  - `qa_required`
  - `inspection_required`
  - `deadline_reminder`
  - `staging_expiring`

##### `subscribeToNotifications`
- **æè¿°**: è¨‚é–± Realtime é€šçŸ¥
- **é—œéµé»**:
  - ä½¿ç”¨ `SupabaseAdapterService.client.channel`
  - è¨‚é–± `notifications` è¡¨çš„ INSERT äº‹ä»¶
  - éæ¿¾ `recipient_id = ç•¶å‰ç”¨æˆ¶ ID`
  - è™•ç†æ–°é€šçŸ¥ä¸¦æ›´æ–°æœ¬åœ°ç‹€æ…‹

##### `unsubscribeFromNotifications`
- **æè¿°**: å–æ¶ˆè¨‚é–± Realtime é€šçŸ¥
- **é—œéµé»**:
  - å¿…é ˆåœ¨çµ„ä»¶éŠ·æ¯€æ™‚èª¿ç”¨
  - é¿å…å…§å­˜æ´©æ¼
  - ä½¿ç”¨ effect çš„æ¸…ç†æ©Ÿåˆ¶
- **é‡è¦**: å¿…é ˆå¯¦ç¾æ¸…ç†æ©Ÿåˆ¶ï¼Œé¿å…å…§å­˜æ´©æ¼

##### `markAsRead`
- **æè¿°**: æ¨™è¨˜é€šçŸ¥ç‚ºå·²è®€

##### `markAllAsRead`
- **æè¿°**: æ¨™è¨˜æ‰€æœ‰é€šçŸ¥ç‚ºå·²è®€

##### `showDesktopNotification`
- **æè¿°**: é¡¯ç¤ºæ¡Œé¢é€šçŸ¥
- **é‡è¦å‚™è¨»**: ä½¿ç”¨ `notification.content` è€Œé `message`

##### `requestNotificationPermission`
- **æè¿°**: è«‹æ±‚æ¡Œé¢é€šçŸ¥æ¬Šé™

**Signals**:

**ç‹€æ…‹ Signals**:
- `notificationsState: signal<Notification[]>`
- `unreadCountState: signal<number>`
- `loadingState: signal<boolean>`

**Realtime è¨‚é–±**:
- **Channel**: `notifications:{accountId}`
- **Event**: `postgres_changes`
- **Table**: `notifications`
- **Filter**: `recipient_id=eq.{accountId}`
- **æ¸…ç†**: å¿…é ˆå¯¦ç¾ `unsubscribeFromNotifications` æ–¹æ³•

**é©—æ”¶æ¨™æº–**:
- [ ] Realtime è¨‚é–±æ­£å¸¸ï¼ˆä½¿ç”¨ SupabaseAdapterServiceï¼‰
- [ ] æ–°é€šçŸ¥å³æ™‚é¡¯ç¤º
- [ ] æ¡Œé¢é€šçŸ¥æ­£å¸¸ï¼ˆä½¿ç”¨ `notification.content` è€Œé `message`ï¼‰
- [ ] æœªè®€è¨ˆæ•¸æ­£ç¢º
- [ ] é€šçŸ¥åˆ—è¡¨æ­£ç¢º
- [ ] æ¨™è¨˜å·²è®€åŠŸèƒ½æ­£å¸¸
- [ ] è¨‚é–±æ¸…ç†æ©Ÿåˆ¶æ­£å¸¸ï¼ˆé¿å…å…§å­˜æ´©æ¼ï¼‰
- [ ] é€šé `yarn type-check`ã€`yarn lint`ã€`yarn build`
- [ ] å–®å…ƒæ¸¬è©¦è¦†è“‹ç‡ â‰¥ 80%

---

#### ä»»å‹™ 3.3ï¼šå¾…è¾¦ä¸­å¿ƒï¼ˆPersonalTodoServiceï¼‰

- **è¤‡é›œåº¦**: 5
- **é ä¼°æ™‚é–“**: 1.5å¤©
- **æ–‡ä»¶ä½ç½®**:
  - Service: `src/app/shared/services/todo/personal-todo.service.ts` (æ–°å»º)
  - Component: `src/app/routes/todos/todo-center.component.ts` (æ–°å»º)
  - Repository: `src/app/core/infra/repositories/personal-todo.repository.ts` (å·²å­˜åœ¨)

**ä¾è³´**:
- PersonalTodoRepository (å·²å­˜åœ¨)
- TodoStatusTrackingRepository (ç‹€æ…‹è¿½è¹¤)
- AuthStateService (ç²å–ç•¶å‰ç”¨æˆ¶)

**ç‹€æ…‹åˆ†é¡**:

| ç‹€æ…‹ | åç¨± | ä¾†æº | å‚™è¨» |
|------|------|------|------|
| `pending` | å¾…åŸ·è¡Œ | `task_lists` | - |
| `staging` | æš«å­˜ä¸­ | `task_staging` | 48 å°æ™‚å¯æ’¤å› |
| `in_qa` | å“ç®¡ä¸­ | `quality_checks` | - |
| `in_inspection` | é©—æ”¶ä¸­ | `inspections` | - |
| `open/in_progress` | å•é¡Œè¿½è¹¤ | `issues` | - |

**Signals**:

**Computed Signals**:
- `pendingTodos`: å¾…åŸ·è¡Œå¾…è¾¦
- `inProgressTodos`: é€²è¡Œä¸­å¾…è¾¦
- `completedTodos`: å·²å®Œæˆå¾…è¾¦

**é©—æ”¶æ¨™æº–**:
- [ ] å¯ä»¥å‰µå»ºå¾…è¾¦äº‹é …
- [ ] ç‹€æ…‹æµè½‰æ­£ç¢º
- [ ] ç‹€æ…‹è¿½è¹¤æ­£ç¢ºï¼ˆä½¿ç”¨ TodoStatusTrackingRepositoryï¼‰
- [ ] æŸ¥è©¢åŠŸèƒ½æ­£å¸¸
- [ ] UI çµ„ä»¶æ­£å¸¸ï¼ˆä½¿ç”¨ SHARED_IMPORTS å’Œ OnPushï¼‰
- [ ] é€šé `yarn type-check`ã€`yarn lint`ã€`yarn build`
- [ ] å–®å…ƒæ¸¬è©¦è¦†è“‹ç‡ â‰¥ 80%

---

#### ä»»å‹™ 3.4ï¼šPR å¯©æ ¸ UI çµ„ä»¶

- **è¤‡é›œåº¦**: 6
- **é ä¼°æ™‚é–“**: 2å¤©
- **æ–‡ä»¶ä½ç½®**:
  - `src/app/routes/blueprints/pull-requests/detail/pull-request-detail.component.ts`
  - `src/app/routes/blueprints/pull-requests/review/pull-request-review.component.ts`
  - `src/app/routes/blueprints/pull-requests/merge/pull-request-merge.component.ts`

**çµ„ä»¶**:

##### PullRequestDetailComponent
- **åŠŸèƒ½**:
  - é¡¯ç¤º PR è©³æƒ…
  - é¡¯ç¤ºè®Šæ›´å…§å®¹ï¼ˆdiff viewï¼‰
  - é¡¯ç¤ºå¯©æ ¸æ­·å²
  - é¡¯ç¤ºè©•è«–
  - æ”¯æŒæ“ä½œï¼ˆå¯©æ ¸ã€åˆä½µã€é—œé–‰ï¼‰

##### PullRequestReviewComponent
- **åŠŸèƒ½**:
  - å¯©æ ¸è¡¨å–®ï¼ˆæ‰¹å‡†/æ‹’çµ•ï¼‰
  - å¯©æ ¸æ„è¦‹è¼¸å…¥
  - æäº¤å¯©æ ¸
- **è¡¨å–®é¡å‹**: Typed Forms

##### PullRequestMergeComponent
- **åŠŸèƒ½**:
  - åˆä½µç¢ºèªå°è©±æ¡†
  - é¡¯ç¤ºåˆä½µé è¦½
  - ç¢ºèªåˆä½µ

**è¦æ±‚**:
- **Imports**: SHARED_IMPORTS (å¿…é ˆä½¿ç”¨ï¼Œç¦æ­¢é›¶ç¢å°å…¥)
- **Change Detection**: ChangeDetectionStrategy.OnPush (å¿…é ˆä½¿ç”¨)
- **Forms**: Typed Forms (è¡¨å–®çµ„ä»¶å¿…é ˆä½¿ç”¨)

**é©—æ”¶æ¨™æº–**:
- [ ] PR è©³æƒ…é¡¯ç¤ºæ­£ç¢º
- [ ] è®Šæ›´å…§å®¹é¡¯ç¤ºæ­£ç¢º
- [ ] å¯©æ ¸åŠŸèƒ½æ­£å¸¸
- [ ] åˆä½µåŠŸèƒ½æ­£å¸¸
- [ ] æ¬Šé™æª¢æŸ¥æ­£ç¢º
- [ ] ä½¿ç”¨ SHARED_IMPORTSï¼ˆç¦æ­¢é›¶ç¢å°å…¥ï¼‰
- [ ] ä½¿ç”¨ OnPush è®Šæ›´æª¢æ¸¬ç­–ç•¥
- [ ] ä½¿ç”¨ Typed Formsï¼ˆè¡¨å–®çµ„ä»¶ï¼‰
- [ ] é€šé `yarn type-check`ã€`yarn lint`ã€`yarn build`
- [ ] å–®å…ƒæ¸¬è©¦è¦†è“‹ç‡ â‰¥ 60%ï¼ˆComponentï¼‰

---

### æ•´åˆæ¸¬è©¦èˆ‡å„ªåŒ–

**é ä¼°æ™‚é–“**: 3å¤©

#### ä»»å‹™ 4.1ï¼šç«¯åˆ°ç«¯æµç¨‹æ¸¬è©¦

- **è¤‡é›œåº¦**: 6
- **é ä¼°æ™‚é–“**: 1å¤©
- **æ–‡ä»¶ä½ç½®**:
  - `e2e/tasks/task-staging-flow.spec.ts`
  - `e2e/pr/pr-review-flow.spec.ts`

**æ¸¬è©¦å ´æ™¯**:

##### ä»»å‹™æš«å­˜æµç¨‹æ¸¬è©¦
- å‰µå»ºä»»å‹™
- æäº¤åˆ°æš«å­˜å€
- 48å°æ™‚å…§æ’¤å›
- é‡æ–°æäº¤åˆ°æš«å­˜å€
- ç¢ºèªæš«å­˜
- é©—è­‰æ–½å·¥æ—¥èªŒå‰µå»º
- é©—è­‰æ´»å‹•è¨˜éŒ„

##### PR å¯©æ ¸æµç¨‹æ¸¬è©¦
- å‰µå»ºåˆ†æ”¯
- æäº¤ PR
- å¯©æ ¸ PRï¼ˆæ‰¹å‡†ï¼‰
- åˆä½µ PR
- é©—è­‰æ•¸æ“šåˆä½µ
- é©—è­‰é€šçŸ¥ç™¼é€

**é©—æ”¶æ¨™æº–**:
- [ ] æ‰€æœ‰æ¸¬è©¦é€šé
- [ ] è¦†è“‹ä¸»è¦æ¥­å‹™æµç¨‹
- [ ] æ¸¬è©¦æ•¸æ“šéš”é›¢
- [ ] æ¸¬è©¦æ¬Šé™æ§åˆ¶

---

#### ä»»å‹™ 4.2ï¼šæ€§èƒ½å„ªåŒ–èˆ‡ç›£æ§

- **è¤‡é›œåº¦**: 5
- **é ä¼°æ™‚é–“**: 1å¤©

**å„ªåŒ–é ˜åŸŸ**:
- æ•¸æ“šåº«æŸ¥è©¢å„ªåŒ–
- Realtime è¨‚é–±å„ªåŒ–
- åœ–ç‰‡ä¸Šå‚³å„ªåŒ–
- å‰ç«¯æ€§èƒ½å„ªåŒ–

**é©—æ”¶æ¨™æº–**:
- [ ] æŸ¥è©¢æ€§èƒ½é”æ¨™
- [ ] Realtime è¨‚é–±ç©©å®š
- [ ] åœ–ç‰‡ä¸Šå‚³é€Ÿåº¦é”æ¨™
- [ ] å‰ç«¯æ€§èƒ½æŒ‡æ¨™é”æ¨™

---

#### ä»»å‹™ 4.3ï¼šæ–‡æª”æ›´æ–°èˆ‡éƒ¨ç½²æº–å‚™

- **è¤‡é›œåº¦**: 3
- **é ä¼°æ™‚é–“**: 1å¤©

**æ–‡æª”æ›´æ–°**:
- API æ–‡æª”
- ç”¨æˆ¶æ‰‹å†Š
- é–‹ç™¼æ–‡æª”
- æ¶æ§‹æ±ºç­–è¨˜éŒ„

**éƒ¨ç½²æº–å‚™**:
- éƒ¨ç½²è…³æœ¬æº–å‚™
- æ•¸æ“šé·ç§»è…³æœ¬æº–å‚™
- å›æ»¾è¨ˆåŠƒæº–å‚™

**é©—æ”¶æ¨™æº–**:
- [ ] æ‰€æœ‰æ–‡æª”æ›´æ–°å®Œæˆ
- [ ] éƒ¨ç½²è…³æœ¬æº–å‚™å®Œæˆ
- [ ] æ•¸æ“šé·ç§»è…³æœ¬æº–å‚™å®Œæˆ
- [ ] å›æ»¾è¨ˆåŠƒæº–å‚™å®Œæˆ

---

## ğŸ” å¯©æŸ¥ç™¼ç¾

### ç¬¦åˆæ¨™æº–çš„éƒ¨åˆ†

#### Angular 20 æœ€ä½³å¯¦è¸
- âœ… ä½¿ç”¨ `inject()` é€²è¡Œä¾è³´æ³¨å…¥
- âœ… ä½¿ç”¨ Signals ç®¡ç†ç‹€æ…‹
- âœ… æš´éœ² ReadonlySignal çµ¦çµ„ä»¶
- âœ… ä½¿ç”¨ `computed()` å‰µå»ºæ´¾ç”Ÿç‹€æ…‹
- âœ… ä½¿ç”¨ `firstValueFrom` è™•ç† Observable

#### åˆ†å±¤æ¶æ§‹
- âœ… Service æ”¾åœ¨ `shared/services/`
- âœ… Repository æ”¾åœ¨ `core/infra/repositories/`
- âœ… é¡å‹å®šç¾©æ”¾åœ¨ `shared/models/`
- âœ… ä¾è³´æ–¹å‘æ­£ç¢ºï¼ˆshared â†’ coreï¼‰

#### ç‹€æ…‹ç®¡ç†
- âœ… ä½¿ç”¨ Signals ç®¡ç†ç‹€æ…‹
- âœ… ä½¿ç”¨ `computed()` å‰µå»ºæ´¾ç”Ÿç‹€æ…‹
- âœ… æš´éœ² ReadonlySignal

---

### éœ€è¦ä¿®æ­£çš„å•é¡Œ

#### å•é¡Œ 1ï¼šæœå‹™åç¨±ä¸ä¸€è‡´
- **å•é¡Œ**: è¨ˆåŠƒä¸­å¼•ç”¨ `ActivityLogService`ï¼Œä½†å¯¦éš›å°ˆæ¡ˆä¸­æ˜¯ `AnalyticsService`
- **å½±éŸ¿ä»»å‹™**:
  - 2.1 TaskStagingService
  - 2.2 æ“´å±• TaskService
  - 2.3 DailyReportService
  - 3.1 PR å¯©æ ¸æµç¨‹
- **ä¿®æ­£**: ä½¿ç”¨ `AnalyticsService` è€Œé `ActivityLogService`

**éŒ¯èª¤ç¤ºä¾‹**:
```typescript
// âŒ éŒ¯èª¤
import { ActivityLogService } from '@shared';

// âœ… æ­£ç¢º
import { AnalyticsService } from '@shared';
```

---

#### å•é¡Œ 2ï¼šDocumentService ä¸å­˜åœ¨
- **å•é¡Œ**: è¨ˆåŠƒä¸­æåˆ° `DocumentService`ï¼Œä½†å°ˆæ¡ˆä¸­æ²’æœ‰é€™å€‹æœå‹™
- **å½±éŸ¿ä»»å‹™**: 2.3 DailyReportServiceï¼ˆä¸Šå‚³ç…§ç‰‡ï¼‰
- **ä¿®æ­£**: ä½¿ç”¨ `SupabaseAdapterService` ç›´æ¥ä¸Šå‚³æ–‡ä»¶

**æ­£ç¢ºç¤ºä¾‹**:
```typescript
// âœ… æ­£ç¢º
import { SupabaseAdapterService } from '@shared';

const { data, error } = await this.supabaseAdapter.storage
  .from('images')
  .upload(filePath, file);
```

---

#### å•é¡Œ 3ï¼šUI çµ„ä»¶ç¼ºå°‘ SHARED_IMPORTS è¦ç¯„
- **å•é¡Œ**: UI çµ„ä»¶è¨­è¨ˆä¸­æ²’æœ‰æ˜ç¢ºæåˆ°ä½¿ç”¨ SHARED_IMPORTS
- **å½±éŸ¿ä»»å‹™**:
  - 2.5 æš«å­˜å€ UI çµ„ä»¶
  - 3.4 PR å¯©æ ¸ UI çµ„ä»¶
- **ä¿®æ­£**: å¿…é ˆä½¿ç”¨ SHARED_IMPORTSï¼Œç¦æ­¢é›¶ç¢å°å…¥

**æ­£ç¢ºç¤ºä¾‹**:
```typescript
// âœ… æ­£ç¢º
import { SHARED_IMPORTS } from '@shared';

@Component({
  imports: [SHARED_IMPORTS],
  // ...
})
```

---

#### å•é¡Œ 4ï¼šUI çµ„ä»¶ç¼ºå°‘ OnPush å’Œ Typed Forms è¦ç¯„
- **å•é¡Œ**: UI çµ„ä»¶è¨­è¨ˆä¸­æ²’æœ‰æ˜ç¢ºæåˆ°ä½¿ç”¨ OnPush å’Œ Typed Forms
- **å½±éŸ¿ä»»å‹™**:
  - 2.5 æš«å­˜å€ UI çµ„ä»¶
  - 3.4 PR å¯©æ ¸ UI çµ„ä»¶
- **ä¿®æ­£**: å¿…é ˆä½¿ç”¨ OnPush å’Œ Typed Forms

**æ­£ç¢ºç¤ºä¾‹**:
```typescript
// âœ… æ­£ç¢º
@Component({
  changeDetection: ChangeDetectionStrategy.OnPush,
  // ...
})
export class Component {
  form!: FormGroup<{
    field: FormControl<string | null>;
  }>;
}
```

---

#### å•é¡Œ 5ï¼šPR è¡¨çµæ§‹å•é¡Œ
- **å•é¡Œ**: è¨ˆåŠƒä¸­ä½¿ç”¨ `closedAt` å’Œ `closedBy` å­—æ®µï¼Œä½† PR è¡¨ä¸­æ²’æœ‰é€™äº›å­—æ®µ
- **å½±éŸ¿ä»»å‹™**: 3.1 PR å¯©æ ¸æµç¨‹ï¼ˆ`closePR` æ–¹æ³•ï¼‰
- **ä¿®æ­£**: ä½¿ç”¨ `status = 'closed'` æ¨™è¨˜é—œé–‰ç‹€æ…‹ï¼Œä½¿ç”¨ `reviewed_at` å’Œ `reviewed_by` è¨˜éŒ„é—œé–‰ä¿¡æ¯

**æ­£ç¢ºç¤ºä¾‹**:
```typescript
// âœ… æ­£ç¢º
await this.updatePullRequest(prId, {
  status: PRStatus.CLOSED,
  reviewedAt: new Date().toISOString(),
  reviewedBy: currentUser.id,
  description: reason ? `${pr.description}\n\né—œé–‰åŸå› ï¼š${reason}` : pr.description
} as any);
```

---

#### å•é¡Œ 6ï¼šNotification é¡å‹å•é¡Œ
- **å•é¡Œ**: è¨ˆåŠƒä¸­ä½¿ç”¨ `notification.message`ï¼Œä½†å¯¦éš›æ‡‰è©²æ˜¯ `notification.content`
- **å½±éŸ¿ä»»å‹™**: 3.2 Realtime é€šçŸ¥ç³»çµ±ï¼ˆ`showDesktopNotification` æ–¹æ³•ï¼‰
- **ä¿®æ­£**: ä½¿ç”¨ `notification.content` è€Œé `message`

**éŒ¯èª¤ç¤ºä¾‹**:
```typescript
// âŒ éŒ¯èª¤
body: notification.message

// âœ… æ­£ç¢º
body: notification.content || ''
```

---

#### å•é¡Œ 7ï¼šç¼ºå°‘å–®å…ƒæ¸¬è©¦è¦æ±‚
- **å•é¡Œ**: è¨ˆåŠƒä¸­åªæœ‰ E2E æ¸¬è©¦ï¼Œæ²’æœ‰æ˜ç¢ºæåˆ°å–®å…ƒæ¸¬è©¦ï¼ˆKarma/Jasmineï¼‰
- **å½±éŸ¿ä»»å‹™**: æ‰€æœ‰ Service å’Œ Component
- **ä¿®æ­£**: è£œå……å–®å…ƒæ¸¬è©¦è¦æ±‚ï¼šè¦†è“‹ç‡ â‰¥ 80%ï¼ˆServiceï¼‰æˆ– â‰¥ 60%ï¼ˆComponentï¼‰

---

#### å•é¡Œ 8ï¼šç¼ºå°‘éŒ¯èª¤è™•ç†çµ±ä¸€æ¨™æº–
- **å•é¡Œ**: è¨ˆåŠƒä¸­æœ‰éŒ¯èª¤è™•ç†ï¼Œä½†æ²’æœ‰æ˜ç¢ºæåˆ°ä½¿ç”¨çµ±ä¸€çš„éŒ¯èª¤è™•ç†æ©Ÿåˆ¶
- **å½±éŸ¿ä»»å‹™**: æ‰€æœ‰ Service
- **ä¿®æ­£**: å¯¦ç¾çµ±ä¸€çš„éŒ¯èª¤è™•ç†æ¨¡å¼ï¼ŒåŒ…å« loading å’Œ error ç‹€æ…‹ç®¡ç†

---

#### å•é¡Œ 9ï¼šç¼ºå°‘é¡å‹å®‰å…¨èªªæ˜
- **å•é¡Œ**: è¨ˆåŠƒä¸­æœ‰ä½¿ç”¨ `as any` çš„åœ°æ–¹ï¼Œéœ€è¦æ˜ç¢ºèªªæ˜åŸå› 
- **å½±éŸ¿ä»»å‹™**: æ‰€æœ‰ä½¿ç”¨é¡å‹æ–·è¨€çš„åœ°æ–¹
- **ä¿®æ­£**: åœ¨ä½¿ç”¨ `as any` çš„åœ°æ–¹æ·»åŠ è¨»é‡‹èªªæ˜åŸå› 

---

#### å•é¡Œ 10ï¼šç¼ºå°‘ TaskService.updateTaskContractorFields æ–¹æ³•
- **å•é¡Œ**: è¨ˆåŠƒä¸­èª¿ç”¨ `taskService.updateTaskContractorFields`ï¼Œä½†éœ€è¦ç¢ºèªé€™å€‹æ–¹æ³•æ˜¯å¦å­˜åœ¨
- **å½±éŸ¿ä»»å‹™**:
  - 3.1 PR å¯©æ ¸æµç¨‹ï¼ˆ`mergePR` æ–¹æ³•ï¼‰
  - 2.2 æ“´å±• TaskServiceï¼ˆéœ€è¦æ·»åŠ æ­¤æ–¹æ³•ï¼‰
- **ä¿®æ­£**: åœ¨ 2.2 æ“´å±• TaskService ä¸­æ·»åŠ  `updateTaskContractorFields` æ–¹æ³•

---

#### å•é¡Œ 11ï¼šç¼ºå°‘ DailyReportDetail é¡å‹å®šç¾©
- **å•é¡Œ**: è¨ˆåŠƒä¸­ä½¿ç”¨ `DailyReportDetail`ï¼Œä½†éœ€è¦ç¢ºèªé€™å€‹é¡å‹æ˜¯å¦å­˜åœ¨
- **å½±éŸ¿ä»»å‹™**: 2.3 DailyReportService
- **ä¿®æ­£**: åœ¨ `src/app/shared/models/task/types.ts` ä¸­å®šç¾© `DailyReportDetail` é¡å‹

---

#### å•é¡Œ 12ï¼šç¼ºå°‘ Realtime è¨‚é–±æ¸…ç†æ©Ÿåˆ¶
- **å•é¡Œ**: è¨ˆåŠƒä¸­çš„ Realtime è¨‚é–±æ²’æœ‰æ˜ç¢ºçš„æ¸…ç†æ©Ÿåˆ¶
- **å½±éŸ¿ä»»å‹™**: 3.2 Realtime é€šçŸ¥ç³»çµ±
- **ä¿®æ­£**: æ·»åŠ  `unsubscribeFromNotifications` æ–¹æ³•å’Œæ¸…ç†æ©Ÿåˆ¶ï¼Œé¿å…å…§å­˜æ´©æ¼

---

#### å•é¡Œ 13ï¼šç¼ºå°‘é©—æ”¶å¾Œçš„æ§‹å»ºæª¢æŸ¥
- **å•é¡Œ**: é©—æ”¶æ¨™æº–ä¸­æ²’æœ‰æ˜ç¢ºæåˆ°æ§‹å»ºæª¢æŸ¥
- **å½±éŸ¿ä»»å‹™**: æ‰€æœ‰ä»»å‹™
- **ä¿®æ­£**: åœ¨æ¯å€‹ä»»å‹™çš„é©—æ”¶æ¨™æº–ä¸­è£œå……æ§‹å»ºæª¢æŸ¥è¦æ±‚

---

## ğŸ“‹ é–‹ç™¼æ¨™æº–

### Angular 20 æœ€ä½³å¯¦è¸

**è¦æ±‚**:
- âœ… ä½¿ç”¨ `inject()` é€²è¡Œä¾è³´æ³¨å…¥
- âœ… ä½¿ç”¨ Signals ç®¡ç†ç‹€æ…‹
- âœ… æš´éœ² ReadonlySignal çµ¦çµ„ä»¶
- âœ… ä½¿ç”¨ `computed()` å‰µå»ºæ´¾ç”Ÿç‹€æ…‹
- âœ… ä½¿ç”¨ `firstValueFrom` è™•ç† Observable
- âœ… ä½¿ç”¨ Standalone Components
- âœ… ä½¿ç”¨ OnPush è®Šæ›´æª¢æ¸¬ç­–ç•¥
- âœ… ä½¿ç”¨ Typed Forms

---

### åˆ†å±¤æ¶æ§‹æ¨™æº–

**è¦æ±‚**:
- âœ… Service æ”¾åœ¨ `shared/services/`
- âœ… Repository æ”¾åœ¨ `core/infra/repositories/`
- âœ… é¡å‹å®šç¾©æ”¾åœ¨ `shared/models/`
- âœ… ä¾è³´æ–¹å‘ï¼šroutes â†’ shared â†’ core
- âŒ ç¦æ­¢ routes ç›´æ¥ä¾è³´ coreï¼ˆé™¤å¿…è¦æœå‹™ï¼‰
- âŒ ç¦æ­¢ shared ç›´æ¥ä¾è³´ routes

---

### ä»£ç¢¼è³ªé‡æ¨™æº–

**è¦æ±‚**:
- âœ… ä½¿ç”¨ SHARED_IMPORTSï¼ˆUI å±¤å¿…é ˆä½¿ç”¨ï¼Œç¦æ­¢é›¶ç¢å°å…¥ï¼‰
- âœ… ä½¿ç”¨ OnPush è®Šæ›´æª¢æ¸¬ç­–ç•¥
- âœ… ä½¿ç”¨ Typed Formsï¼ˆè¡¨å–®çµ„ä»¶ï¼‰
- âœ… ä½¿ç”¨ Signals é€²è¡Œç‹€æ…‹ç®¡ç†
- âœ… éŒ¯èª¤è™•ç†å®Œæ•´
- âœ… é¡å‹å®‰å…¨ï¼ˆé¿å…ä½¿ç”¨ anyï¼Œå¿…è¦æ™‚æ·»åŠ è¨»é‡‹ï¼‰

---

### æ¸¬è©¦æ¨™æº–

**è¦æ±‚**:
- âœ… å–®å…ƒæ¸¬è©¦è¦†è“‹ç‡ â‰¥ 80%ï¼ˆServiceï¼‰
- âœ… å–®å…ƒæ¸¬è©¦è¦†è“‹ç‡ â‰¥ 60%ï¼ˆComponentï¼‰
- âœ… é—œéµæ¥­å‹™é‚è¼¯ 100% è¦†è“‹
- âœ… ä½¿ç”¨ Karma + Jasmine ç·¨å¯«æ¸¬è©¦
- âœ… æ¸¬è©¦æ–‡ä»¶å‘½åï¼š`*.spec.ts`
- âœ… æ¸¬è©¦é‚Šç•Œæ¢ä»¶å’ŒéŒ¯èª¤æƒ…æ³

---

## âœ… é©—è­‰æ¸…å–®

### å¯¦æ–½å‰æª¢æŸ¥æ¸…å–®

- [ ] ç›¸é—œ Repository æ˜¯å¦å·²å­˜åœ¨
- [ ] ç›¸é—œé¡å‹å®šç¾©æ˜¯å¦å·²å­˜åœ¨
- [ ] ä¾è³´çš„ Service æ˜¯å¦å·²å¯¦ç¾
- [ ] æ•¸æ“šåº«è¡¨çµæ§‹æ˜¯å¦å·²å‰µå»º

---

### å¯¦æ–½å¾Œæª¢æŸ¥æ¸…å–®

| æª¢æŸ¥é … | æè¿° | æ˜¯å¦å¿…éœ€ |
|--------|------|----------|
| `yarn type-check` | é¡å‹æª¢æŸ¥é€šéï¼ˆç„¡é¡å‹éŒ¯èª¤ï¼‰ | âœ… æ˜¯ |
| `yarn lint` | ä»£ç¢¼æª¢æŸ¥é€šéï¼ˆç„¡ ESLint éŒ¯èª¤ï¼‰ | âœ… æ˜¯ |
| `yarn lint:style` | æ¨£å¼æª¢æŸ¥é€šéï¼ˆç„¡ Stylelint éŒ¯èª¤ï¼‰ | âœ… æ˜¯ |
| `yarn build` | æ§‹å»ºæˆåŠŸ | âœ… æ˜¯ |
| `yarn test` | å–®å…ƒæ¸¬è©¦é€šé | âœ… æ˜¯ |
| é‹è¡Œæ™‚åŠŸèƒ½æ­£å¸¸ | ç€è¦½å™¨ Console ç„¡éŒ¯èª¤ï¼ŒåŠŸèƒ½æ­£å¸¸ | âœ… æ˜¯ |
| æ–‡æª”å·²æ›´æ–° | ç›¸é—œæ–‡æª”å·²æ›´æ–° | âšª å¦ |

---

### é—œéµæª¢æŸ¥é …

| æª¢æŸ¥é … | æè¿° | æ˜¯å¦å¿…éœ€ |
|--------|------|----------|
| SHARED_IMPORTS | ä½¿ç”¨ SHARED_IMPORTSï¼ˆUIå±¤ï¼‰ | âœ… æ˜¯ |
| åˆ†å±¤æ¶æ§‹ | éµå¾ªåˆ†å±¤æ¶æ§‹ï¼ˆroutes â†’ shared â†’ coreï¼‰ | âœ… æ˜¯ |
| Signals | ä½¿ç”¨ Signals ç®¡ç†ç‹€æ…‹ | âœ… æ˜¯ |
| OnPush | ä½¿ç”¨ OnPush è®Šæ›´æª¢æ¸¬ç­–ç•¥ | âœ… æ˜¯ |
| Typed Forms | è¡¨å–®çµ„ä»¶ä½¿ç”¨ Typed Forms | âœ… æ˜¯ |
| AnalyticsService | ä½¿ç”¨ AnalyticsService è€Œé ActivityLogService | âœ… æ˜¯ |
| SupabaseAdapterService | ä½¿ç”¨ SupabaseAdapterService è€Œé DocumentService | âœ… æ˜¯ |

---

## ğŸ”§ æœå‹™å‘½åè¦ç¯„

### æ­£ç¢ºçš„æœå‹™åç¨±

| ç”¨é€” | æ­£ç¢ºæœå‹™ | éŒ¯èª¤æœå‹™ |
|------|----------|----------|
| æ´»å‹•è¨˜éŒ„ | `AnalyticsService` | âŒ `ActivityLogService` |
| æ–‡ä»¶ä¸Šå‚³ | `SupabaseAdapterService` | âŒ `DocumentService` |
| Realtime è¨‚é–± | `SupabaseAdapterService` | âŒ `SupabaseService` |

**å‚™è¨»**:
- æ‰€æœ‰æ´»å‹•è¨˜éŒ„ç›¸é—œæ“ä½œä½¿ç”¨ `AnalyticsService`
- æ‰€æœ‰æ–‡ä»¶ä¸Šå‚³æ“ä½œä½¿ç”¨ `SupabaseAdapterService`
- Realtime è¨‚é–±ä½¿ç”¨ `SupabaseAdapterService.client`

---

## ğŸ—„ï¸ è³‡æ–™åº«çµæ§‹

### PR è¡¨çµæ§‹

**é‡è¦å‚™è¨»**: PR è¡¨æ²’æœ‰ `closed_at` å’Œ `closed_by` å­—æ®µ

**å­—æ®µ**:
- `id`
- `blueprint_id`
- `branch_id`
- `title`
- `description`
- `status`
- `submitted_by`
- `reviewed_by`
- `merged_by`
- `changes_summary` (JSONB)
- `submitted_at`
- `reviewed_at`
- `merged_at`

**é—œé–‰ PR çš„è§£æ±ºæ–¹æ¡ˆ**: ä½¿ç”¨ `status = 'closed'` å’Œ `reviewed_at`/`reviewed_by` è¨˜éŒ„é—œé–‰ä¿¡æ¯

---

### Notification è¡¨çµæ§‹

**é‡è¦å‚™è¨»**: Notification è¡¨ä½¿ç”¨ `content` å­—æ®µè€Œé `message` å­—æ®µ

**å­—æ®µ**:
- `id`
- `recipient_id`
- `sender_id`
- `notification_type`
- `title`
- `content` (ä¸æ˜¯ `message`)
- `related_type`
- `related_id`
- `read_at`
- `created_at`

---

## â±ï¸ æ™‚é–“ä¼°ç®—

| éšæ®µ | é ä¼°æ™‚é–“ |
|------|----------|
| éšæ®µ2 | 9å¤© |
| éšæ®µ3 | 8.5å¤© |
| æ•´åˆæ¸¬è©¦ | 3å¤© |
| **ç¸½è¨ˆ** | **ç´„ 3.5 é€±ï¼ˆ17.5 å€‹å·¥ä½œæ—¥ï¼‰** |

---

## ğŸ”— ä¾è³´é—œä¿‚åœ–

### éšæ®µ2 ä¾è³´é—œä¿‚

```
éšæ®µ2.1 (TaskStagingService)
  â†“
éšæ®µ2.2 (æ“´å±• TaskService) â† ä¾è³´ 2.1
  â†“
éšæ®µ2.3 (DailyReportService)
  â†“
éšæ®µ2.4 (æ•´åˆ) â† ä¾è³´ 2.1, 2.3
  â†“
éšæ®µ2.5 (UI) â† ä¾è³´ 2.1, 2.2, 2.4
```

### éšæ®µ3 ä¾è³´é—œä¿‚

```
éšæ®µ3.1 (PR å¯©æ ¸) â† ä¾è³´ éšæ®µ2
  â†“
éšæ®µ3.2 (é€šçŸ¥ç³»çµ±)
  â†“
éšæ®µ3.3 (å¾…è¾¦ä¸­å¿ƒ)
  â†“
éšæ®µ3.4 (PR UI) â† ä¾è³´ 3.1
```

### æ•´åˆæ¸¬è©¦ä¾è³´é—œä¿‚

```
æ•´åˆæ¸¬è©¦ â† ä¾è³´ éšæ®µ2, éšæ®µ3
```

---

## ğŸ“ é‡è¦æ³¨æ„äº‹é …

### å¿…é ˆéµå¾ª

- âœ… æ‰€æœ‰è³‡æ–™åº«æ“ä½œå¿…é ˆé€é `@SUPABASE` MCP å·¥å…·
- âœ… UI å±¤å¿…é ˆä½¿ç”¨ SHARED_IMPORTSï¼ˆç¦æ­¢é›¶ç¢å°å…¥ï¼‰
- âœ… éµå¾ªåˆ†å±¤æ¶æ§‹ï¼šroutes â†’ shared â†’ core
- âœ… ä½¿ç”¨ Signals é€²è¡Œç‹€æ…‹ç®¡ç†
- âœ… ä½¿ç”¨ OnPush è®Šæ›´æª¢æ¸¬ç­–ç•¥
- âœ… ä½¿ç”¨ Typed Formsï¼ˆè¡¨å–®çµ„ä»¶ï¼‰
- âœ… ä½¿ç”¨ `AnalyticsService` è€Œé `ActivityLogService`
- âœ… ä½¿ç”¨ `SupabaseAdapterService` è€Œé `DocumentService`
- âœ… PR è¡¨æ²’æœ‰ `closed_at` å’Œ `closed_by` å­—æ®µ
- âœ… Notification è¡¨ä½¿ç”¨ `content` å­—æ®µè€Œé `message` å­—æ®µ
- âœ… Realtime è¨‚é–±å¿…é ˆå¯¦ç¾æ¸…ç†æ©Ÿåˆ¶ï¼Œé¿å…å…§å­˜æ´©æ¼

---

### ç¦æ­¢äº‹é …

- âŒ ç¦æ­¢ä½¿ç”¨ workaround æˆ–è‡¨æ™‚è§£æ±ºæ–¹æ¡ˆ
- âŒ ç¦æ­¢ç¹é PR æ©Ÿåˆ¶ç›´æ¥æ›´æ–°ä¸»åˆ†æ”¯æ•¸æ“š
- âŒ ç¦æ­¢å”ä½œçµ„ç¹”ä¿®æ”¹ä»»å‹™çµæ§‹ï¼ˆåªèƒ½å¡«å¯«æ‰¿æ”¬æ¬„ä½ï¼‰
- âŒ ç¦æ­¢ UI çµ„ä»¶é›¶ç¢å°å…¥ Angular/ng-zorro/@delon æ¨¡çµ„
- âŒ ç¦æ­¢ä½¿ç”¨ `ActivityLogService`ï¼ˆæ‡‰ä½¿ç”¨ `AnalyticsService`ï¼‰
- âŒ ç¦æ­¢ä½¿ç”¨ `DocumentService`ï¼ˆæ‡‰ä½¿ç”¨ `SupabaseAdapterService`ï¼‰

---

**æœ€å¾Œæ›´æ–°**: 2025-11-16  
**ç‰ˆæœ¬**: 1.1

