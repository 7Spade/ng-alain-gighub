# 開發前檢查清單

> 📋 **目的**：確保所有必要的檔案和配置都已就緒，可以開始開發工作

## ✅ 已完成的文檔

### 項目結構與開發規範（00-09）
- ✅ `00-開發作業指引.md` - 開發規範
- ✅ `01-專案結構說明.md` - 專案結構說明
- ✅ `02-專案結構樹.md` - 專案結構樹
- ✅ `03-專案結構流程圖.mermaid.md` - 專案結構流程圖
- ✅ `04-重構後結構樹.md` - 重構後結構樹

### 架構設計圖（10-19）
- ✅ `10-系統架構思維導圖.mermaid.md` - 系統架構
- ✅ `11-Supabase架構流程圖.mermaid.md` - Supabase 架構
- ✅ `12-實體關係圖.mermaid.md` - 資料庫 ER 圖
- ✅ `13-帳戶層流程圖.mermaid.md` - 帳戶流程
- ✅ `14-業務流程圖.mermaid.md` - 業務流程
- ✅ `15-序列圖.mermaid.md` - 序列圖
- ✅ `16-狀態圖.mermaid.md` - 狀態圖
- ✅ `17-系統上下文圖.mermaid.md` - 系統上下文
- ✅ `18-容器圖.mermaid.md` - 容器圖
- ✅ `19-元件模組視圖.mermaid.md` - 元件模組

### 部署與安全（20-29）
- ✅ `20-部署基礎設施視圖.mermaid.md` - 部署基礎設施
- ✅ `21-安全與-RLS-權限矩陣.md` - 安全與權限
- ✅ `22-資料生命週期-ETL-流程圖.mermaid.md` - ETL 流程
- ✅ `23-可觀測性與CI-CD管道圖.mermaid.md` - CI/CD
- ✅ `24-領域事件時間軸圖.mermaid.md` - 領域事件
- ✅ `25-API-介面映射圖.mermaid.md` - API 映射
- ✅ `26-Storage-Bucket結構視圖.mermaid.md` - Storage 結構

### 數據與開發（30-39）
- ✅ `30-資料表清單總覽.md` - 資料表清單
- ✅ `31-開發前檢查清單.md` - 開發前檢查清單（本文檔）
- ✅ `32-快速開始指南.md` - 快速開始指南
- ✅ `33-API-接口詳細文檔.md` - API 接口詳細文檔
- ✅ `34-資料模型對照表.md` - 資料模型對照表
- ✅ `35-開發工作流程.md` - 開發工作流程
- ✅ `36-常見問題-FAQ.md` - 常見問題 FAQ
- ✅ `37-錯誤處理指南.md` - 錯誤處理指南
- ✅ `38-測試指南.md` - 測試指南
- ✅ `39-部署指南.md` - 部署指南

### 優化與安全（40-42）
- ✅ `40-效能優化指南.md` - 效能優化指南
- ✅ `41-安全檢查清單.md` - 安全檢查清單
- ✅ `42-詞彙表.md` - 詞彙表

---

## ❌ 缺少的關鍵檔案

### 🔴 高優先級（必須完成才能開始開發）

#### 1. 資料庫遷移腳本
**狀態**：⚠️ **不完整** - 只有 1 個優化遷移，缺少基礎表結構

**需要建立**：
- [ ] `supabase/migrations/00000000000000_initial_schema.sql` - 初始資料庫結構（51 張表）
  - 包含所有 51 張表的 CREATE TABLE 語句
  - 包含外鍵約束
  - 包含索引定義
  - 參考：`docs/30-0-完整SQL表結構定義.md`（完整 SQL 表結構定義）和 `docs/30-資料表清單總覽.md`

- [ ] `supabase/migrations/00000000000001_rls_policies.sql` - RLS 權限策略
  - 所有表的 RLS 啟用
  - 所有權限策略定義
  - 參考：`docs/21-安全與-RLS-權限矩陣.md`

- [ ] `supabase/migrations/00000000000002_seed_data.sql` - 初始種子資料（可選）
  - 測試用帳戶
  - 預設角色和權限
  - 系統設定

**檢查方式**：
```bash
# 使用 Supabase MCP 檢查表是否存在
@SUPABASE 列出所有資料庫表
```

---

#### 2. TypeScript 模型定義完整性
**狀態**：⚠️ **部分完成** - 部分模型已定義，但可能不完整

**需要檢查/建立**：
- [ ] `src/app/shared/models/account.model.ts` - 帳戶模型
- [ ] `src/app/shared/models/team.model.ts` - 團隊模型
- [ ] `src/app/shared/models/role.model.ts` - 角色模型
- [ ] `src/app/shared/models/permission.model.ts` - 權限模型
- [ ] `src/app/shared/models/issue.model.ts` - 問題模型
- [ ] `src/app/shared/models/quality-check.model.ts` - 品質檢查模型
- [ ] `src/app/shared/models/daily-report.model.ts` - 每日報表模型
- [ ] `src/app/shared/models/comment.model.ts` - 留言模型
- [ ] `src/app/shared/models/notification.model.ts` - 通知模型
- [ ] `src/app/shared/models/todo.model.ts` - 待辦事項模型
- [ ] `src/app/shared/models/document.model.ts` - 文件模型
- [ ] `src/app/shared/models/progress-tracking.model.ts` - 進度追蹤模型
- [ ] `src/app/shared/models/activity-log.model.ts` - 活動記錄模型
- [ ] `src/app/shared/models/setting.model.ts` - 系統設定模型

**檢查方式**：
```bash
# 檢查現有模型
grep -r "export interface" src/app/shared/models/
# 對比 docs/30-資料表清單總覽.md 確認完整性
```

---

#### 3. 環境配置檔案
**狀態**：⚠️ **缺少範例檔案**

**需要建立**：
- [ ] `.env.example` - 環境變數範例
  ```env
  # Supabase
  SUPABASE_URL=https://your-project.supabase.co
  SUPABASE_ANON_KEY=your-anon-key
  SUPABASE_SERVICE_ROLE_KEY=your-service-role-key

  # CWA (中央氣象署 API)
  CWA_API_KEY=your-cwa-api-key

  # 其他配置
  NODE_ENV=development
  ```

- [ ] `.env.local` - 本地開發環境變數（應在 .gitignore 中）
- [ ] `docs/環境配置說明.md` - 環境變數配置說明

**檢查方式**：
```bash
# 檢查 environment.ts 中使用的變數
cat src/environments/environment.ts
```

---

#### 4. 開發快速開始指南
**狀態**：❌ **缺少**

**需要建立**：
- [ ] `docs/快速開始.md` 或 `QUICK_START.md`
  - 環境準備（Node.js, Yarn, Supabase CLI）
  - 安裝依賴
  - 資料庫設定
  - 環境變數配置
  - 啟動開發伺服器
  - 常見問題

---

### 🟡 中優先級（建議在開發初期完成）

#### 5. API 接口詳細文檔
**狀態**：⚠️ **只有映射圖，缺少詳細文檔**

**需要建立**：
- [ ] `docs/API接口文檔.md` 或 `docs/33-API-接口詳細文檔.md`
  - 所有 API 端點的詳細說明
  - 請求/回應格式
  - 錯誤碼定義
  - 認證方式
  - 參考：`docs/25-API-介面映射圖.mermaid.md`

---

#### 6. 測試配置和指南
**狀態**：⚠️ **有測試腳本，缺少指南**

**需要建立**：
- [ ] `docs/測試指南.md` 或 `TESTING.md`
  - 單元測試寫法
  - E2E 測試寫法
  - 測試覆蓋率要求
  - Mock 資料使用
  - 測試最佳實踐

**檢查方式**：
```bash
# 檢查測試配置
cat karma.conf.js
cat e2e/protractor.conf.js
```

---

#### 7. 部署文檔
**狀態**：⚠️ **有部署視圖，缺少詳細步驟**

**需要建立**：
- [ ] `docs/部署指南.md` 或 `DEPLOYMENT.md`
  - 生產環境配置
  - 建置流程
  - 部署步驟
  - 環境變數設定
  - 資料庫遷移
  - 回滾流程
  - 參考：`docs/20-部署基礎設施視圖.mermaid.md`

---

#### 8. Repository 層實現
**狀態**：⚠️ **部分完成** - 部分 Repository 已實現

**需要檢查/建立**：
- [ ] `src/app/core/repositories/account.repository.ts`
- [ ] `src/app/core/repositories/team.repository.ts`
- [ ] `src/app/core/repositories/role.repository.ts`
- [ ] `src/app/core/repositories/permission.repository.ts`
- [ ] `src/app/core/repositories/issue.repository.ts`
- [ ] `src/app/core/repositories/quality-check.repository.ts`
- [ ] `src/app/core/repositories/daily-report.repository.ts`
- [ ] `src/app/core/repositories/comment.repository.ts`
- [ ] `src/app/core/repositories/notification.repository.ts`
- [ ] `src/app/core/repositories/todo.repository.ts`
- [ ] `src/app/core/repositories/document.repository.ts`
- [ ] `src/app/core/repositories/progress-tracking.repository.ts`
- [ ] `src/app/core/repositories/activity-log.repository.ts`
- [ ] `src/app/core/repositories/setting.repository.ts`

**檢查方式**：
```bash
# 檢查現有 Repository
find src/app -name "*.repository.ts" -type f
```

---

### 🟢 低優先級（可在開發過程中補充）

#### 9. 開發檢查清單
**狀態**：✅ **本文檔**

---

#### 10. 錯誤處理文檔
**狀態**：⚠️ **部分完成** - 有錯誤處理指南，但可能需要更新

**需要檢查**：
- [ ] `src/app/core/net/error/ERROR_HANDLING_GUIDE.md` 是否完整
- [ ] 是否需要補充錯誤碼對照表

---

#### 11. 效能優化指南
**狀態**：❌ **缺少**

**建議建立**：
- [ ] `docs/效能優化指南.md`
  - 前端效能優化
  - 資料庫查詢優化
  - 快取策略
  - 懶加載策略

---

#### 12. 安全檢查清單
**狀態**：⚠️ **有 RLS 文檔，缺少完整檢查清單**

**建議建立**：
- [ ] `docs/安全檢查清單.md`
  - RLS 策略檢查
  - API 認證檢查
  - 敏感資料處理
  - XSS/CSRF 防護

---

## 📋 開發前必做檢查

### 環境準備
- [ ] Node.js 版本符合要求（檢查 `package.json` 的 `engines`）
- [ ] Yarn 已安裝（版本 4.9.2+）
- [ ] Supabase CLI 已安裝
- [ ] Git 已配置

### 專案設定
- [ ] 執行 `yarn install` 安裝依賴
- [ ] 複製 `.env.example` 為 `.env.local` 並填入正確值
- [ ] 執行 `yarn lint` 檢查程式碼風格
- [ ] 執行 `yarn type-check` 檢查類型（如果有的話）
- [ ] 執行 `yarn build` 確認可以建置

### 資料庫設定
- [ ] Supabase 專案已建立
- [ ] 執行資料庫遷移腳本
- [ ] 驗證所有表已建立（使用 `@SUPABASE 列出所有資料庫表`）
- [ ] 驗證 RLS 策略已啟用
- [ ] 測試連線（使用 `@SUPABASE` 工具）

### 開發環境
- [ ] 執行 `yarn start` 啟動開發伺服器
- [ ] 瀏覽器可以正常開啟應用
- [ ] 登入功能正常（如果已實現）
- [ ] 基本路由導航正常

---

## 🎯 優先順序建議

### 第一階段（必須完成）
1. ✅ 建立資料庫遷移腳本（51 張表，分為 11 個模組）
2. ✅ 建立 RLS 策略遷移
3. ✅ 補齊 TypeScript 模型定義（對齊 51 張資料表）
4. ✅ 建立 `.env.example`
5. ✅ 建立快速開始指南

### 第二階段（建議完成）
6. ✅ 補齊 Repository 層實現
7. ✅ 建立 API 接口詳細文檔
8. ✅ 建立測試指南
9. ✅ 建立部署指南

### 第三階段（可選）
10. ✅ 建立效能優化指南
11. ✅ 建立安全檢查清單
12. ✅ 補充其他文檔

---

## 🔍 驗證方式

### 使用 Supabase MCP 工具驗證
```bash
# 列出所有表
@SUPABASE 列出所有資料庫表

# 檢查 RLS 策略
@SUPABASE 獲取安全建議

# 檢查遷移
@SUPABASE 列出所有遷移
```

### 使用專案工具驗證
```bash
# 建置檢查
yarn build

# 測試檢查
yarn test

# 程式碼品質檢查
yarn lint
yarn type-check  # 如果有
```

---

## 📝 備註

- 本文檔應在每次重大開發前更新
- 完成項目後應勾選對應的檢查框
- 如有新增需求，應更新本文檔
- 建議定期檢查本文檔的完整性

---

## 🔗 相關文檔

- [開發作業指引](./00-開發作業指引.md)
- [專案結構樹](./02-專案結構樹.md)
- [資料表清單總覽](./30-資料表清單總覽.md)
- [安全與RLS權限矩陣](./21-安全與-RLS-權限矩陣.md)
- [API介面映射圖](./25-API-介面映射圖.mermaid.md)

