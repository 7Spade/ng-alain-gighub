{"type":"entity","name":"ng-alain-gighub","label":"Project","observations":["企業級資源中心專案","使用 Git-like 分支模型管理藍圖與組織協作","包含 51 張資料表的完整架構","支援多組織協作與任務分派"]}
{"type":"entity","name":"Angular 20","label":"Technology","observations":["專案使用 Angular 20.3.x 版本","強制使用 Standalone Components","必須採用 Signals 進行狀態管理","所有元件必須使用 OnPush 變更檢測策略","使用新版控制流語法 @if @for @switch @defer","禁止使用舊語法 *ngIf *ngFor *ngSwitch"]}
{"type":"entity","name":"NG-ZORRO","label":"UI Framework","observations":["使用 NG-ZORRO ^20.3.1 作為主要 UI 元件庫","所有 UI 需求優先從 NG-ZORRO 選擇元件","NG-ZORRO 元件已採用 OnPush 策略","禁止使用原生 HTML 元件如 <input> <select> <button>","必須使用 nz-input nz-select nz-button 等 NG-ZORRO 元件"]}
{"type":"entity","name":"@delon","label":"Framework","observations":["使用 @delon/* ^20.1.0 企業級套件","@delon/abc 提供業務元件（st、se、sv、sg）","@delon/auth 管理認證與 Token","@delon/acl 處理權限控制","@delon/cache 提供快取服務","@delon/theme 管理主題與佈局","當 NG-ZORRO 無法滿足需求時才使用 @delon/abc"]}
{"type":"entity","name":"TypeScript","label":"Language","observations":["使用 TypeScript ~5.9.2","強制開啟 strict mode","禁止使用 any 類型，必要時使用 unknown","所有函數必須明確定義返回類型","介面定義必須與資料庫 Schema 一致"]}
{"type":"entity","name":"Supabase","label":"Backend","observations":["使用 supabase-js ^2.81.1","Supabase Auth 負責身份認證","所有資料庫操作必須遵守 RLS（Row Level Security）策略","使用 PostgreSQL 15+ 資料庫","認證流程：Supabase Auth → access_token → @delon/auth TokenService","登出時必須同時呼叫 supabase.auth.signOut() 和 TokenService.clear()"]}
{"type":"entity","name":"RxJS","label":"Library","observations":["使用 RxJS ~7.8.0 處理非同步操作","避免嵌套訂閱，使用 switchMap/mergeMap","銷毀時使用 takeUntilDestroyed() 取消訂閱","簡單狀態使用 Signals，複雜非同步使用 RxJS"]}
{"type":"entity","name":"Git-like Branch Model","label":"Architecture","observations":["系統採用 Git-like 分支模型管理藍圖","主分支（Main Branch）由擁有者組織控制","組織分支（Organization Branch）透過 Fork 建立 1:1 承攬關係","分支只能填寫執行數據，不可修改任務結構","Pull Request 機制用於提交執行數據回主分支","合併後更新主分支的承攬欄位數據"]}
{"type":"entity","name":"Database Schema","label":"Architecture","observations":["系統包含 51 張資料表，分為 11 個業務模組","帳戶與身份系統：4 張表（accounts, teams, team_members, organization_schedules）","組織協作系統：3 張表（organization_collaborations 等）","權限系統：5 張表","藍圖/專案系統：5 張表（blueprints, blueprint_branches 等）","任務執行系統：9 張表","品質驗收系統：4 張表","問題追蹤系統：4 張表","協作溝通系統：6 張表","資料分析系統：6 張表","機器人系統：3 張表","系統管理：2 張表"]}
{"type":"entity","name":"OnPush Strategy","label":"Principle","observations":["所有元件必須使用 ChangeDetectionStrategy.OnPush","NG-ZORRO 全採用 OnPush，自訂元件必須跟隨","使用 Signals 或建立新物件/陣列觸發檢測","需要時使用 ChangeDetectorRef.markForCheck() 手動標記"]}
{"type":"entity","name":"SHARED_IMPORTS","label":"Pattern","observations":["使用 SHARED_IMPORTS 統一管理共用模組","避免重複 import 相同模組","詳細使用規範參考 docs/10-SHARED_IMPORTS使用指南.md","提高程式碼一致性與可維護性"]}
{"type":"entity","name":"Authentication Flow","label":"Security","observations":["認證流程：Supabase Auth 登入 → 取得 access_token → 存入 @delon/auth TokenService","前端由 @delon/auth 主導認證管理","權限檢查：前端 @delon/acl + 後端 Supabase RLS 雙重驗證","Token 刷新：Supabase 自動刷新 → 同步更新 TokenService","Interceptor 自動附加 token 到 API 請求"]}
{"type":"entity","name":"SOLID Principles","label":"Principle","observations":["SRP 單一職責：每個類別/函數只做一件事","OCP 開閉原則：對擴展開放，對修改封閉","LSP 里氏替換：子類型必須能替換父類型","ISP 介面隔離：不應強迫實作不需要的介面","DIP 依賴反轉：依賴抽象而非具體實作"]}
{"type":"entity","name":"Code Quality","label":"Principle","observations":["DRY 不重複：避免重複程式碼","KISS 保持簡潔：避免過度複雜的設計","YAGNI 不需要就不做：不要過度設計未來功能","Defensive Programming：防禦式程式設計","Fail Fast：快速失敗原則","優先使用標準工具，避免臨時腳本"]}
{"type":"entity","name":"Testing Strategy","label":"Principle","observations":["新增功能必須包含單元測試（Jasmine/Karma）","關鍵流程需要 E2E 測試（Playwright）","測試必須遵循 TDD/BDD 原則","測試必須獨立且可重複執行","使用 Angular Testing Utilities 進行元件測試"]}
{"type":"entity","name":"Security Principles","label":"Security","observations":["所有敏感資料必須通過 RLS 策略保護","不得在程式碼中寫入 secrets 或 API keys","使用 DomSanitizer 防止 XSS 攻擊","Token 管理統一使用 @delon/auth","資料庫 Schema 變更必須附 migration 和 rollback 腳本","未授權操作必須被拒絕並記錄"]}
{"type":"entity","name":"Commit Convention","label":"Standard","observations":["遵循 Conventional Commits 規範","格式：<type>(<scope>): <subject>","類型：feat/fix/docs/style/refactor/test/chore","PR 必須包含：變更摘要、測試策略、回滾步驟","Commit message 必須清晰描述變更內容"]}
{"type":"entity","name":"Layered Architecture","label":"Architecture","observations":["專案採用分層架構：routes → shared → core","routes 層：路由模組與功能模組","shared 層：共用元件、服務、工具","core 層：核心服務、Guards、Interceptors","依賴方向：routes → shared → core，不可反向依賴"]}
{"type":"entity","name":"Repository Pattern","label":"Pattern","observations":["使用 Repository Pattern 處理資料存取","Repository 負責 API 呼叫與資料轉換","Service 負責業務邏輯處理","Interceptor 統一處理錯誤與認證"]}
{"type":"entity","name":"Performance Optimization","label":"Principle","observations":["使用 Lazy Loading 按需載入模組","實作 Caching 快取策略","強制使用 OnPush 變更檢測","大列表使用 Virtual Scrolling","列表渲染使用 TrackBy 函數優化","避免在模板中使用複雜運算"]}
{"type":"entity","name":"Accessibility","label":"Standard","observations":["遵循 WCAG 2.1 AA 標準","所有互動元件必須有 ARIA labels","支援完整鍵盤導航","顏色對比度必須符合標準","表單必須有明確的錯誤提示"]}
{"type":"entity","name":"Documentation","label":"Standard","observations":["所有公開 API 必須有 TSDoc 註解","複雜邏輯必須有清晰的註解說明","架構變更必須更新相關文件","參考文件位於 docs/ 目錄","AGENTS.md 是 AI 助手的入口文檔"]}
{"type":"entity","name":"Forbidden Practices","label":"Constraint","observations":["❌ 禁止使用原生 HTML 元件","❌ 禁止跳過 OnPush 策略","❌ 禁止繞過 @delon/auth 認證","❌ 禁止在程式碼中寫入機密資訊","❌ 禁止使用 any 類型","❌ 禁止使用舊版 Angular 語法","❌ 禁止未經審核修改 Schema","❌ 禁止副作用外洩","❌ 禁止過度耦合"]}
{"type":"relation","from":"ng-alain-gighub","to":"Angular 20","relationType":"uses"}
{"type":"relation","from":"ng-alain-gighub","to":"NG-ZORRO","relationType":"uses"}
{"type":"relation","from":"ng-alain-gighub","to":"@delon","relationType":"uses"}
{"type":"relation","from":"ng-alain-gighub","to":"Supabase","relationType":"uses"}
{"type":"relation","from":"ng-alain-gighub","to":"TypeScript","relationType":"uses"}
{"type":"relation","from":"ng-alain-gighub","to":"Git-like Branch Model","relationType":"implements"}
{"type":"relation","from":"ng-alain-gighub","to":"Database Schema","relationType":"implements"}
{"type":"relation","from":"Angular 20","to":"NG-ZORRO","relationType":"integrates_with"}
{"type":"relation","from":"Angular 20","to":"RxJS","relationType":"integrates_with"}
{"type":"relation","from":"Angular 20","to":"OnPush Strategy","relationType":"requires"}
{"type":"relation","from":"NG-ZORRO","to":"OnPush Strategy","relationType":"uses"}
{"type":"relation","from":"@delon","to":"NG-ZORRO","relationType":"extends"}
{"type":"relation","from":"@delon","to":"Supabase","relationType":"integrates_with"}
{"type":"relation","from":"Supabase","to":"Authentication Flow","relationType":"implements"}
{"type":"relation","from":"Authentication Flow","to":"Security Principles","relationType":"enforces"}
{"type":"relation","from":"SHARED_IMPORTS","to":"Code Quality","relationType":"improves"}
{"type":"relation","from":"Repository Pattern","to":"Layered Architecture","relationType":"implements"}
{"type":"relation","from":"SOLID Principles","to":"Code Quality","relationType":"defines"}
{"type":"relation","from":"Testing Strategy","to":"Code Quality","relationType":"ensures"}
{"type":"relation","from":"Performance Optimization","to":"OnPush Strategy","relationType":"requires"}
{"type":"relation","from":"Git-like Branch Model","to":"Database Schema","relationType":"requires"}
{"type":"relation","from":"Documentation","to":"Code Quality","relationType":"improves"}
{"type":"relation","from":"Accessibility","to":"NG-ZORRO","relationType":"follows"}
{"type":"relation","from":"Commit Convention","to":"Documentation","relationType":"standardizes"}
{"type":"entity","name":"MCP Server Configuration","entityType":"Infrastructure","observations":["14 MCP servers configured and verified on 2025-11-20","Redis MCP: Connected to Redis Cloud with 576+ knowledge keys","Supabase MCP: Connected to project pfxxjtvnqptdvjfakotc with 51 tables","GitHub MCP: Successfully verified repository search","Memory MCP: Knowledge graph with entities and relations","All critical MCP servers operational and responding"]}
{"type":"entity","name":"Redis Knowledge Base","entityType":"Data Store","observations":["Redis Cloud instance: redis-13923.c299.asia-northeast1-1.gce.cloud.redislabs.com:13923","Contains 576+ project knowledge keys","Categories: principles, patterns, anti-patterns, workflow-principles, architecture-principles","Verified operational via MCP redis-list command","Stores project-specific development guidelines"]}
{"type":"entity","name":"Supabase Database","entityType":"Backend Service","observations":["Project reference: pfxxjtvnqptdvjfakotc","51 tables implementing Git-like branch model","Key tables: accounts (7), teams (8), blueprints (1), tasks (1), permissions (14), roles (6)","All tables have RLS enabled for security","Verified via MCP supabase-list_tables command"]}
{"type":"entity","name":"ng-alain-gighub Project","entityType":"Project","observations":["Enterprise resource center built on Angular 20 + ng-alain + NG-ZORRO","Technology stack: Angular 20.3.x, ng-alain 20.1.0, NG-ZORRO 20.3.1, Supabase 2.81.1","Architecture: Git-like branch model with 51 database tables","MCP integration: 14 servers for enhanced development workflow","Verified operational on 2025-11-20"]}
{"type":"relation","from":"MCP Server Configuration","to":"Redis Knowledge Base","relationType":"connects_to"}
{"type":"relation","from":"MCP Server Configuration","to":"Supabase Database","relationType":"connects_to"}
{"type":"relation","from":"MCP Server Configuration","to":"ng-alain-gighub Project","relationType":"supports"}
{"type":"relation","from":"ng-alain-gighub Project","to":"Supabase Database","relationType":"uses"}
{"type":"relation","from":"ng-alain-gighub Project","to":"Redis Knowledge Base","relationType":"stores_knowledge_in"}
{"type":"entity","name":"MCP Verification 2025-11-20","entityType":"Verification","observations":["All 14 MCP servers successfully tested","Redis: 576+ keys accessible","Supabase: 51 tables accessible","GitHub, Memory, Everything servers operational"]}
