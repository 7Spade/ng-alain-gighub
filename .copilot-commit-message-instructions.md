# GitHub Copilot Commit 訊息規範

> 本檔案定義專案的 Git Commit 訊息規範，遵循 Conventional Commits 1.0.0 標準。

## 📋 Commit 訊息格式

### 基本結構
```
<type>(<scope>): <subject>

[optional body]

[optional footer]
```

### 範例
```
feat(auth): 新增 Google OAuth 登入功能

- 整合 Supabase Auth Google Provider
- 新增登入按鈕和樣式
- 更新認證流程文件

Closes #123
```

## 🏷️ Type 類型

### 主要類型

| Type | 說明 | 範例 |
|------|------|------|
| `feat` | 新功能 | `feat(task): 新增任務批次匯出功能` |
| `fix` | 錯誤修復 | `fix(auth): 修正登入 token 過期問題` |
| `docs` | 文件變更 | `docs(readme): 更新環境設定說明` |
| `style` | 格式調整（不影響程式邏輯） | `style(button): 調整主按鈕間距` |
| `refactor` | 重構（不新增功能也不修錯誤） | `refactor(user): 簡化使用者資料處理邏輯` |
| `perf` | 效能改善 | `perf(list): 優化大型列表渲染效能` |
| `test` | 測試相關 | `test(auth): 新增登入流程測試案例` |
| `chore` | 建置或工具變更 | `chore(deps): 升級 Angular 至 20.1.0` |

### 次要類型

| Type | 說明 | 範例 |
|------|------|------|
| `build` | 建置系統變更 | `build(webpack): 優化 production 建置設定` |
| `ci` | CI/CD 設定變更 | `ci(github): 新增自動部署工作流程` |
| `revert` | 回退先前的 commit | `revert: 回退 feat(task): 新增任務批次匯出功能` |

## 🎯 Scope 範圍

### 功能模組
- `auth` - 認證相關
- `user` - 使用者管理
- `task` - 任務管理
- `blueprint` - 藍圖管理
- `issue` - 問題追蹤
- `review` - 審查功能
- `comment` - 評論系統
- `notification` - 通知功能
- `bot` - Bot 功能

### 技術層面
- `core` - 核心模組
- `shared` - 共享模組
- `layout` - 版面配置
- `api` - API 整合
- `db` - 資料庫相關
- `rls` - Row Level Security

### 基礎設施
- `deps` - 相依套件
- `config` - 設定檔
- `build` - 建置相關
- `test` - 測試設定

## ✍️ Subject 主旨

### 撰寫原則
1. **使用正體中文**
2. **動詞開頭**：新增、修正、更新、移除、優化等
3. **簡潔明瞭**：不超過 50 字
4. **不加句號**
5. **描述「做什麼」而非「怎麼做」**

### ✅ 好的範例
```
feat(auth): 新增忘記密碼功能
fix(task): 修正任務狀態更新失敗問題
docs(api): 更新 API 端點文件
refactor(user): 簡化使用者資料驗證邏輯
perf(list): 優化虛擬滾動效能
```

### ❌ 不好的範例
```
feat: 新增功能  # scope 不明確
fix: bug修復    # 沒說明什麼 bug
更新文件。      # 缺少 type 和 scope，且有句號
feat(auth): 實作了一個新的使用者認證系統，包含登入、註冊和忘記密碼功能  # 太長
```

## 📝 Body 內容

### 何時需要 Body
- 需要說明「為什麼」做這個變更
- 變更複雜，需要更多說明
- 有多個相關的變更項目

### 撰寫格式
- 與 subject 空一行
- 每行不超過 72 字
- 使用條列式說明
- 可以包含多個段落

### 範例
```
feat(task): 新增任務批次操作功能

- 支援批次選取任務
- 提供批次狀態更新
- 新增批次刪除功能
- 加入操作記錄

此功能回應使用者需求 #123，讓管理大量任務更有效率。
實作時考慮了效能和使用者體驗，使用虛擬滾動和樂觀更新策略。
```

## 🔗 Footer 頁尾

### Breaking Changes（重大變更）
```
BREAKING CHANGE: 移除舊版 API 端點

舊的 /api/v1/users 端點已移除，請改用 /api/v2/users
遷移指南請參考 docs/migration-guide.md
```

### 關聯 Issue
```
Closes #123
Fixes #456
Refs #789
```

### 完整範例
```
feat(auth): 重構認證系統

- 採用新的 Supabase Auth API
- 支援多種 OAuth 供應商
- 改善錯誤處理和使用者回饋
- 新增認證狀態持久化

BREAKING CHANGE: 移除 AuthGuard，改用 @delon/auth 的 JWTGuard

原本的 AuthGuard 已被移除，請更新路由設定：
- 移除：canActivate: [AuthGuard]
- 新增：canActivate: [JWTGuard]

Closes #123, #124
Refs #125
```

## 🎨 特殊情況

### 多個變更
如果一個 commit 包含多個不相關的變更，考慮拆分成多個 commit。

```bash
# ❌ 不建議
feat(auth,task): 新增登入功能和任務列表

# ✅ 建議拆分
feat(auth): 新增登入功能
feat(task): 新增任務列表
```

### 回退 Commit
```
revert: feat(auth): 新增 Google OAuth 登入功能

This reverts commit abc123def456.

原因：發現與現有認證系統有衝突，需要重新設計整合方式。
```

### WIP (Work In Progress)
開發中的臨時 commit，在 PR 前應該 squash。

```
wip(task): 實作中 - 任務編輯功能

⚠️ 注意：此 commit 為開發中狀態，在合併前會被 squash
```

## ✅ 提交前檢查清單

- [ ] Type 正確選擇
- [ ] Scope 明確且存在
- [ ] Subject 使用正體中文
- [ ] Subject 簡潔明瞭（≤ 50 字）
- [ ] Subject 不以句號結尾
- [ ] Body 說明充分（如需要）
- [ ] 關聯相關 Issue
- [ ] 重大變更有 BREAKING CHANGE 說明
- [ ] 通過 commit-lint 檢查

## 🛠️ 工具支援

### Husky + Commitlint
專案已設定 Husky 和 Commitlint，會自動驗證 commit 訊息格式。

```bash
# 如果格式錯誤，會看到類似錯誤
✖   subject may not be empty
✖   type may not be empty
```

### VSCode 整合
安裝 "Conventional Commits" 擴充套件，可以透過 GUI 協助產生符合規範的 commit 訊息。

## 📚 參考資源

- [Conventional Commits 1.0.0](https://www.conventionalcommits.org/)
- [Angular Commit Guidelines](https://github.com/angular/angular/blob/master/CONTRIBUTING.md#commit)
- 專案 `.husky/commit-msg` - Commit 訊息驗證腳本

---

**版本**：v2.0  
**最後更新**：2025-11-18  
**維護者**：開發團隊
