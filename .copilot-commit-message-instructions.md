# GitHub Copilot Commit Message 指示

> **目的**：為 VS Code 的 Copilot Chat 提供統一的 Commit Message 產生規範。  
> 遵循 Conventional Commits 1.0.0 規範，使用正體中文撰寫。

## 📋 基本原則

### 語言要求
- **Commit Message 一律使用正體中文**
- Type 與 Scope 保持英文
- 描述內容使用正體中文

### Conventional Commits 格式
```
<type>(<scope>): <subject>

[optional body]

[optional footer]
```

## 🏷️ Type 類型定義

### 主要類型（常用）
| Type | 中文說明 | 使用時機 | 範例 |
|------|---------|---------|------|
| `feat` | 新功能 | 新增使用者可見的功能 | `feat(auth): 新增使用者登入功能` |
| `fix` | 修復錯誤 | 修正程式錯誤或問題 | `fix(user-list): 修正分頁計算錯誤` |
| `docs` | 文件 | 更新文檔或註解 | `docs(readme): 更新安裝步驟說明` |
| `style` | 格式調整 | 程式碼格式化、空白、分號等（不影響功能） | `style(app): 套用 Prettier 格式化` |
| `refactor` | 重構 | 重構程式碼（不改變功能） | `refactor(service): 重構使用者服務結構` |
| `perf` | 效能優化 | 提升效能的變更 | `perf(table): 優化表格渲染效能` |
| `test` | 測試 | 新增或修正測試 | `test(auth): 新增登入流程測試` |
| `build` | 建構系統 | 影響建構系統或外部依賴 | `build(deps): 升級 Angular 至 20.3.0` |
| `ci` | CI/CD | 修改 CI 設定檔或腳本 | `ci(github): 新增自動化部署流程` |
| `chore` | 維護任務 | 其他不影響 src 或測試的變更 | `chore(config): 更新 ESLint 設定` |

### 進階類型（較少使用）
| Type | 中文說明 | 使用時機 |
|------|---------|---------|
| `revert` | 還原 | 還原先前的 commit | 
| `wip` | 進行中 | 進行中的工作（不建議提交至主分支） |
| `merge` | 合併 | 合併分支（通常由 Git 自動產生） |

## 🎯 Scope 範圍定義

### 模組層級
- `auth`：身份驗證與授權
- `user`：使用者管理
- `org`：組織管理
- `branch`：分支管理
- `blueprint`：藍圖管理
- `task`：任務管理
- `issue`：問題管理
- `pr`：Pull Request 管理
- `comment`：評論與討論
- `notification`：通知系統
- `activity`：活動記錄
- `file`：檔案管理

### 技術層級
- `core`：核心服務與工具
- `shared`：共享元件與服務
- `layout`：佈局元件
- `api`：API 整合
- `db`：資料庫相關
- `rls`：RLS 策略
- `ui`：UI 元件
- `form`：表單處理
- `table`：表格元件

### 基礎建設
- `deps`：依賴管理
- `config`：設定檔
- `scripts`：腳本與工具
- `docker`：Docker 相關
- `deploy`：部署相關

### 特殊 Scope
- `*` 或省略：影響多個模組或全域變更

## ✍️ Subject 主旨撰寫規範

### 基本原則
1. **使用正體中文**
2. **使用現在式動詞**：「新增」而非「新增了」
3. **不超過 50 個字元**（中文約 25 字）
4. **首字不大寫**（Type 後直接接描述）
5. **結尾不加句號**
6. **清楚描述「做了什麼」**

### 動詞建議
- **新增**：feat 類型常用（新增功能、新增元件、新增欄位）
- **修正**：fix 類型常用（修正錯誤、修正邏輯、修正顯示）
- **更新**：通用（更新文件、更新設定、更新依賴）
- **重構**：refactor 類型（重構結構、重構邏輯）
- **優化**：perf 類型（優化效能、優化查詢）
- **調整**：style 或 chore 類型（調整格式、調整設定）
- **移除**：通用（移除未使用的程式碼、移除過時功能）
- **升級**：build 類型（升級套件、升級框架）

### ✅ 好的範例
```
feat(auth): 新增 Google OAuth 登入功能
fix(user-list): 修正分頁在篩選後無法正確顯示的問題
docs(api): 更新 Supabase RLS 策略說明文件
style(shared): 套用 Prettier 格式化共享元件
refactor(task-service): 重構任務服務使用 Signals API
perf(table): 優化大量資料的表格渲染效能
test(auth): 新增登入流程的單元測試
build(deps): 升級 Angular 至 20.3.0
ci(github): 新增 PR 自動審查工作流程
chore(eslint): 更新 ESLint 規則設定
```

### ❌ 不好的範例
```
修正bug                           # Type 遺失、描述不具體
feat: add login                  # 使用英文而非中文
feat(auth): 新增了登入功能。      # 使用過去式且加句號
fix: 修正一些問題                 # 過於籠統
feat(user): 新增使用者管理功能，包含列表、新增、編輯、刪除等完整 CRUD 操作
                                # 太長、應拆分多個 commit
```

## 📝 Body 內文撰寫規範

### 何時需要 Body
- 變更原因與背景
- 實作細節或決策說明
- 影響範圍或副作用
- 重大變更說明

### Body 格式
- 與 Subject 空一行
- 每行不超過 72 個字元（中文約 36 字）
- 使用正體中文
- 使用條列式說明

### Body 範例
```
feat(task): 新增任務批次操作功能

新增批次選取與操作功能，包含：
- 全選 / 反選功能
- 批次指派負責人
- 批次更新狀態
- 批次刪除

實作重點：
- 使用 Signal 管理選取狀態
- 透過 Repository Pattern 統一處理批次 API
- 加入樂觀更新提升使用者體驗
```

## 🔖 Footer 註腳撰寫規範

### 何時需要 Footer
- **Breaking Changes**：重大變更（必須標註）
- **Issue References**：關聯 Issue 或 PR
- **其他資訊**：審查者、協作者等

### Breaking Changes 格式
```
BREAKING CHANGE: <說明>
```

### Issue References 格式
```
Closes #123
Fixes #456
Refs #789
```

### Footer 範例
```
fix(api): 修改使用者 API 回應格式

BREAKING CHANGE: User API 的回應格式已變更
- `user_id` 改為 `id`
- `full_name` 改為 `name`
- 移除 `deprecated_field` 欄位

Closes #123
```

## 📋 完整範例

### 範例 1：簡單功能新增
```
feat(auth): 新增記住我功能
```

### 範例 2：Bug 修正（含 Body）
```
fix(table): 修正排序功能在中文欄位失效的問題

問題原因：
- 原本使用 JavaScript 預設字串比較
- 中文字元排序不符合預期

解決方案：
- 使用 `localeCompare` 進行中文排序
- 支援多層級排序
- 加入排序方向指示器

Fixes #234
```

### 範例 3：重大變更
```
refactor(auth): 重構認證系統改用 Supabase Auth

將自建認證系統遷移至 Supabase Auth：
- 改用 @delon/auth 整合 Supabase
- 移除舊的 JWT 處理邏輯
- 更新所有 API 請求攔截器

BREAKING CHANGE: 認證 Token 格式已變更
- 需重新登入以取得新 Token
- 舊的 localStorage 資料將自動清除
- API 端點已更新為 /auth/v1/*

Migration Guide: 參考 docs/migration-supabase-auth.md

Closes #345
```

### 範例 4：效能優化
```
perf(blueprint-list): 優化藍圖列表載入效能

實作虛擬捲動與資料分頁：
- 使用 CDK Virtual Scroll 處理大量資料
- 實作 Server-side Pagination
- 加入資料預載入機制
- 快取已載入的資料

效能提升：
- 初始載入時間從 3.2s 降至 0.8s
- 記憶體使用量減少 65%
- 支援 10,000+ 筆資料流暢滾動
```

### 範例 5：文件更新
```
docs(rls): 更新 RLS 策略開發指南

新增內容：
- RLS Policy 測試方法
- 常見權限矩陣範例
- 除錯技巧與工具
- 效能優化建議
```

### 範例 6：依賴升級
```
build(deps): 升級 Angular 至 20.3.0

升級內容：
- Angular 框架從 20.1.0 升至 20.3.0
- NG-ZORRO 升至 20.3.1
- @delon 套件群組升至 20.1.0

測試範圍：
- 所有單元測試通過
- E2E 測試通過
- 建構與部署驗證完成
```

## 🚫 常見錯誤

### 1. 語言混用
```
❌ feat(auth): 新增 login feature
✅ feat(auth): 新增登入功能
```

### 2. Type 錯誤
```
❌ update(deps): 升級套件          # 應使用 build
✅ build(deps): 升級套件

❌ add(component): 新增元件        # 應使用 feat
✅ feat(ui): 新增使用者卡片元件
```

### 3. 描述過於簡略
```
❌ fix(bug): 修正錯誤
✅ fix(user-form): 修正姓名欄位驗證錯誤

❌ feat: 新功能
✅ feat(task): 新增任務優先順序設定
```

### 4. 描述過於冗長
```
❌ feat(auth): 新增使用者登入功能包含帳號密碼驗證與記住我選項以及忘記密碼連結
✅ feat(auth): 新增登入功能（含記住我與忘記密碼）
```

### 5. 使用過去式
```
❌ fix(api): 修正了 API 錯誤
✅ fix(api): 修正 API 錯誤

❌ feat(task): 新增了任務功能
✅ feat(task): 新增任務功能
```

## 🔄 特殊情況處理

### WIP Commit（開發中）
```
wip(feature): 實作使用者管理功能（進行中）

注意：此為開發中提交，尚未完成
```

### Revert Commit
```
revert: 還原 "feat(auth): 新增 Google OAuth 登入"

此功能導致生產環境錯誤，暫時還原
```

### Merge Commit
```
merge: 合併 feature/user-management 至 develop

Merge branch 'feature/user-management' into develop
```

## ✅ 檢查清單

提交前確認：
- [ ] Type 選擇正確
- [ ] Scope 適當且存在
- [ ] Subject 使用正體中文
- [ ] Subject 不超過 50 字元（中文約 25 字）
- [ ] Subject 使用現在式動詞
- [ ] Subject 結尾無句號
- [ ] 有需要時加入 Body 說明
- [ ] 重大變更標註 BREAKING CHANGE
- [ ] 關聯相關 Issue 或 PR

## 🔗 相關資源

- [Conventional Commits 1.0.0](https://www.conventionalcommits.org/)
- `.github/agents/copilot-instructions.md`：完整開發指示
- `docs/00-開發作業指引.md`：開發流程規範

---

**版本**：v2.0（2025-11-18）  
**維護者**：開發團隊  
**最後更新**：2025-01-15
